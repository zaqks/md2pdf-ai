!function(){"use strict";const t={WEB:"web"},e={PU:"PAGE_UNKNOWN",PI:"PAGE_INIT",PC:"PAGE_CART",PCH:"PAGE_CHECKOUT",PF:"PAGE_FINALIZATION",PH:"PAGE_HOME",PL:"PAGE_LANDING",PP:"PAGE_PAYMENT",PPR:"PAGE_PRODUCT",PS:"PAGE_SHIPPING"},{WEB:n}=t,o={getBeaconUrl:(t=n)=>`https://gateway.captiv8.io/api/v2/attribution/${t}`},{getBeaconUrl:r}=o,c=(t,e)=>{const n=e.split(".");try{return n.reduce(((t,e)=>t?.[e]||t?.[e.replace(/\B([A-Z])/g,"_$1").toLowerCase()]),t)}catch(t){return}},i=(t,e)=>{const n=new Blob([JSON.stringify(t)]),o=r(e);navigator.sendBeacon(o,n)},a=(t,e)=>{const n=(t=>{const e=new Date,n=t/60||24;return e.setTime(e.getTime()+60*n*60*1e3),`expires=${e.toUTCString()}`})(t);((t,e,n)=>{const o=`${t}=${e}; ${n}; path=/`,r=window.location.host.split(".");r.shift();const c=`.${r.join(".")}`;if(document.cookie=`${o}; domain=${c}`,!u(t)){const e=`.${window.location.host}`;if(document.cookie=`${o}; domain=${e}`,!u(t)){const e=`${window.location.host}`;document.cookie=`${o}; domain=${e}`,u(t)||(document.cookie=`${o}`)}}})("c8cid",e,n)},u=t=>{const e=`${t}=`,n=decodeURIComponent(document.cookie).split(";");for(let t=0;t<n.length;t+=1){let o=n[t];for(;" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(e))return o.substring(e.length,o.length)}return""};var s="1.2.0";const{WEB:d}=t,{PI:m}=e,p=t=>{const{pageType:n,page:o,...r}=t,i=n||o;if(!i)return console.warn("[C8 Pixel] No page type provided, event skipped"),!1;const{PU:a,PF:u}=e;if(i===a)return console.warn("[C8 Pixel] Unknown page type, event skipped"),!1;if(i===u){const e=["id","currency","subTotal"],n=["sku","currency","price","name","quantity"],o=c(r,"transaction");if(void 0===o)return console.warn('[C8 Pixel] Missing required field "transaction", event skipped',{data:t}),!1;let i=!1;if(e.forEach((t=>{void 0===c(o,t)&&(console.warn(`[C8 Pixel] Missing required transaction field "${t}", event skipped`,{transaction:o}),i=!0)})),i)return!1;const a=c(r,"products");void 0!==a&&a.forEach((t=>{n.forEach((e=>{void 0===c(t,e)&&console.warn(`[C8 Pixel] Missing required product field "${e}"`,{product:t})}))}))}return!0},{WEB:g}=t,{WEB:l}=t,{PF:P}=e;try{const t=(()=>{const t=new URLSearchParams(window.location.search),e={now:new Date,utmSource:t.get("utm_source"),utmMedium:t.get("utm_medium"),utmCampaign:t.get("utm_campaign"),utmTerm:t.get("utm_term"),utmContent:t.get("utm_content")};return Object.keys(e).filter((t=>e[t])).reduce(((t,n)=>({...t,[n]:e[n]})),{})})();(({now:t,utmSource:e,utmMedium:n,utmCampaign:o,utmTerm:r,utmContent:c})=>{try{const p=new URLSearchParams(window.location.search).get("c8cid");if(p){if(u("c8cid")===p)return;const{c8aid:g,is_debug:l}=window.c8data,P=p.split("-");if(2===P.length){const[u,f]=P;a(f,p);const w={version:s,c8cid:p,c8aid:g||"",is_debug:l,date:t.toISOString(),page:m,utmSource:e,utmMedium:n,utmCampaign:o,utmTerm:r,utmContent:c,pageInfo:{referrer:document.referrer,url:document.URL}};i(w,d)}}}catch(t){console.error(t)}})(t),(({now:t,utmSource:e,utmMedium:n,utmCampaign:o,utmTerm:r,utmContent:c})=>{try{const a=u("c8cid");if(a){const{c8data:u}=window,{pageType:d,page:m,products:l,transaction:P,c8aid:f,is_debug:w}=u;if(p(u)){const u={version:s,c8aid:f||"",c8cid:a,is_debug:w,date:t.toISOString(),page:d||m,products:l,transaction:P,utmSource:e,utmMedium:n,utmCampaign:o,utmTerm:r,utmContent:c,pageInfo:{referrer:document.referrer,url:document.URL}};i(u,g)}}}catch(t){console.error(t)}})(t),(({now:t,utmSource:e,utmMedium:n,utmCampaign:o,utmTerm:r,utmContent:c})=>{try{const a=u("c8cid"),{c8data:d}=window,{c8aid:m,transaction:g,pageType:f,page:w,products:C,is_debug:h}=d;if(!a&&m&&(f||w)===P&&g?.coupons?.length>0){p(d);const a={version:s,c8aid:m,c8cid:"",is_debug:h,date:t.toISOString(),page:P,products:C,transaction:g,utmSource:e,utmMedium:n,utmCampaign:o,utmTerm:r,utmContent:c,pageInfo:{referrer:document.referrer,url:document.URL}};i(a,l)}}catch(t){console.error(t)}})(t)}catch(t){console.error(t)}}();
