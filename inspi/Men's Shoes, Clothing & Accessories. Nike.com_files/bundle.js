/*! For license information please see bundle.js.LICENSE.txt */
/* Nike -- marketing-automation.optimization-client -- 2.16.0 */
(()=>{var e={35(e,t){function n(e,r,o,i,a,s){var c=Math.floor((r-e)/2)+e,l=a(o,i[c],!0);return 0===l?c:l>0?r-c>1?n(c,r,o,i,a,s):s==t.LEAST_UPPER_BOUND?r<i.length?r:-1:c:c-e>1?n(e,c,o,i,a,s):s==t.LEAST_UPPER_BOUND?c:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,r,o,i){if(0===r.length)return-1;var a=n(-1,r.length,e,r,o,i||t.GREATEST_LOWER_BOUND);if(a<0)return-1;for(;a-1>=0&&0===o(r[a],r[a-1],!0);)--a;return a}},65(e,t,n){t.SourceMapGenerator=n(945).SourceMapGenerator,t.SourceMapConsumer=n(606).SourceMapConsumer,t.SourceNode=n(171).SourceNode},68(e){"use strict";e.exports={parse:function(e){return function(e){var t={};if(!e||"string"!=typeof e)return t;var n=e.trim().replace(/^[?#&]/,""),r=new URLSearchParams(n),o=r.keys();do{var i=o.next(),a=i.value;if(a){var s=r.getAll(a);1===s.length?t[a]=s[0]:t[a]=s}}while(!1===i.done);return t}(e)},stringify:function(e){return function(e){var t="{{space}}",n=new URLSearchParams;return Object.keys(e).forEach(function(r){var o=e[r];"string"==typeof e[r]?o=o.replace(/ /g,t):["object","undefined"].includes(typeof o)&&!Array.isArray(o)&&(o=""),Array.isArray(o)?o.forEach(function(e){n.append(r,e)}):n.append(r,o)}),n.toString().replace(new RegExp(encodeURIComponent(t),"g"),"%20")}(e)}}},139(e,t,n){var r,o,i;!function(){"use strict";o=[n(263),n(887),n(885)],r=function(e,t,n){var r={filter:function(e){return-1===(e.functionName||"").indexOf("StackTrace$$")&&-1===(e.functionName||"").indexOf("ErrorStackParser$$")&&-1===(e.functionName||"").indexOf("StackTraceGPS$$")&&-1===(e.functionName||"").indexOf("StackGenerator$$")},sourceCache:{}},o=function(){try{throw new Error}catch(e){return e}};function i(e,t){var n={};return[e,t].forEach(function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n}),n}function a(e){return e.stack||e["opera#sourceloc"]}function s(e,t){return"function"==typeof t?e.filter(t):e}return{get:function(e){var t=o();return a(t)?this.fromError(t,e):this.generateArtificially(e)},getSync:function(n){n=i(r,n);var c=o();return s(a(c)?e.parse(c):t.backtrace(n),n.filter)},fromError:function(t,o){o=i(r,o);var a=new n(o);return new Promise(function(n){var r=s(e.parse(t),o.filter);n(Promise.all(r.map(function(e){return new Promise(function(t){function n(){t(e)}a.pinpoint(e).then(t,n).catch(n)})})))}.bind(this))},generateArtificially:function(e){e=i(r,e);var n=t.backtrace(e);return"function"==typeof e.filter&&(n=n.filter(e.filter)),Promise.resolve(n)},instrument:function(e,t,n,r){if("function"!=typeof e)throw new Error("Cannot instrument non-function object");if("function"==typeof e.__stacktraceOriginalFn)return e;var o=function(){try{return this.get().then(t,n).catch(n),e.apply(r||this,arguments)}catch(e){throw a(e)&&this.fromError(e).then(t,n).catch(n),e}}.bind(this);return o.__stacktraceOriginalFn=e,o},deinstrument:function(e){if("function"!=typeof e)throw new Error("Cannot de-instrument non-function object");return"function"==typeof e.__stacktraceOriginalFn?e.__stacktraceOriginalFn:e},report:function(e,t,n,r){return new Promise(function(o,i){var a=new XMLHttpRequest;if(a.onerror=i,a.onreadystatechange=function(){4===a.readyState&&(a.status>=200&&a.status<400?o(a.responseText):i(new Error("POST to "+t+" failed with status: "+a.status)))},a.open("post",t),a.setRequestHeader("Content-Type","application/json"),r&&"object"==typeof r.headers){var s=r.headers;for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&a.setRequestHeader(c,s[c])}var l={stack:e};null!=n&&(l.message=n),a.send(JSON.stringify(l))})}}},void 0===(i="function"==typeof r?r.apply(t,o):r)||(e.exports=i)}()},171(e,t,n){var r=n(945).SourceMapGenerator,o=n(835),i=/(\r?\n)/,a="$$$isSourceNode$$$";function s(e,t,n,r,o){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==n?null:n,this.name=null==o?null:o,this[a]=!0,null!=r&&this.add(r)}s.fromStringWithSourceMap=function(e,t,n){var r=new s,a=e.split(i),c=function(){return a.shift()+(a.shift()||"")},l=1,d=0,u=null;return t.eachMapping(function(e){if(null!==u){if(!(l<e.generatedLine)){var t=(n=a[0]).substr(0,e.generatedColumn-d);return a[0]=n.substr(e.generatedColumn-d),d=e.generatedColumn,p(u,t),void(u=e)}p(u,c()),l++,d=0}for(;l<e.generatedLine;)r.add(c()),l++;if(d<e.generatedColumn){var n=a[0];r.add(n.substr(0,e.generatedColumn)),a[0]=n.substr(e.generatedColumn),d=e.generatedColumn}u=e},this),a.length>0&&(u&&p(u,c()),r.add(a.join(""))),t.sources.forEach(function(e){var i=t.sourceContentFor(e);null!=i&&(null!=n&&(e=o.join(n,e)),r.setSourceContent(e,i))}),r;function p(e,t){if(null===e||void 0===e.source)r.add(t);else{var i=n?o.join(n,e.source):e.source;r.add(new s(e.originalLine,e.originalColumn,i,t,e.name))}}},s.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(e){this.add(e)},this);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this},s.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this},s.prototype.walk=function(e){for(var t,n=0,r=this.children.length;n<r;n++)(t=this.children[n])[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})},s.prototype.join=function(e){var t,n,r=this.children.length;if(r>0){for(t=[],n=0;n<r-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this},s.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[a]?n.replaceRight(e,t):"string"==typeof n?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this},s.prototype.setSourceContent=function(e,t){this.sourceContents[o.toSetString(e)]=t},s.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);var r=Object.keys(this.sourceContents);for(t=0,n=r.length;t<n;t++)e(o.fromSetString(r[t]),this.sourceContents[r[t]])},s.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e},s.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new r(e),o=!1,i=null,a=null,s=null,c=null;return this.walk(function(e,r){t.code+=e,null!==r.source&&null!==r.line&&null!==r.column?(i===r.source&&a===r.line&&s===r.column&&c===r.name||n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:t.line,column:t.column},name:r.name}),i=r.source,a=r.line,s=r.column,c=r.name,o=!0):o&&(n.addMapping({generated:{line:t.line,column:t.column}}),i=null,o=!1);for(var l=0,d=e.length;l<d;l++)10===e.charCodeAt(l)?(t.line++,t.column=0,l+1===d?(i=null,o=!1):o&&n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:t.line,column:t.column},name:r.name})):t.column++}),this.walkSourceContents(function(e,t){n.setSourceContent(e,t)}),{code:t.code,map:n}},t.SourceNode=s},187(e,t){!function(){"use strict";var n={version:"3.0.1",x86:{},x64:{}};function r(e,t){return(65535&e)*t+(((e>>>16)*t&65535)<<16)}function o(e,t){return e<<t|e>>>32-t}function i(e){return e=r(e^=e>>>16,2246822507),e=r(e^=e>>>13,3266489909),e^=e>>>16}function a(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function s(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function c(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])}function l(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]}function d(e,t){return[e[0]^t[0],e[1]^t[1]]}function u(e){return e=d(e,[0,e[0]>>>1]),e=d(e=s(e,[4283543511,3981806797]),[0,e[0]>>>1]),e=d(e=s(e,[3301882366,444984403]),[0,e[0]>>>1])}n.x86.hash32=function(e,t){t=t||0;for(var n=(e=e||"").length%4,a=e.length-n,s=t,c=0,l=3432918353,d=461845907,u=0;u<a;u+=4)c=r(c=255&e.charCodeAt(u)|(255&e.charCodeAt(u+1))<<8|(255&e.charCodeAt(u+2))<<16|(255&e.charCodeAt(u+3))<<24,l),c=r(c=o(c,15),d),s=r(s=o(s^=c,13),5)+3864292196;switch(c=0,n){case 3:c^=(255&e.charCodeAt(u+2))<<16;case 2:c^=(255&e.charCodeAt(u+1))<<8;case 1:c=r(c^=255&e.charCodeAt(u),l),s^=c=r(c=o(c,15),d)}return(s=i(s^=e.length))>>>0},n.x86.hash128=function(e,t){t=t||0;for(var n=(e=e||"").length%16,a=e.length-n,s=t,c=t,l=t,d=t,u=0,p=0,f=0,g=0,m=597399067,h=2869860233,y=951274213,v=2716044179,w=0;w<a;w+=16)u=255&e.charCodeAt(w)|(255&e.charCodeAt(w+1))<<8|(255&e.charCodeAt(w+2))<<16|(255&e.charCodeAt(w+3))<<24,p=255&e.charCodeAt(w+4)|(255&e.charCodeAt(w+5))<<8|(255&e.charCodeAt(w+6))<<16|(255&e.charCodeAt(w+7))<<24,f=255&e.charCodeAt(w+8)|(255&e.charCodeAt(w+9))<<8|(255&e.charCodeAt(w+10))<<16|(255&e.charCodeAt(w+11))<<24,g=255&e.charCodeAt(w+12)|(255&e.charCodeAt(w+13))<<8|(255&e.charCodeAt(w+14))<<16|(255&e.charCodeAt(w+15))<<24,u=o(u=r(u,m),15),s=o(s^=u=r(u,h),19),s=r(s+=c,5)+1444728091,p=o(p=r(p,h),16),c=o(c^=p=r(p,y),17),c=r(c+=l,5)+197830471,f=o(f=r(f,y),17),l=o(l^=f=r(f,v),15),l=r(l+=d,5)+2530024501,g=o(g=r(g,v),18),d=o(d^=g=r(g,m),13),d=r(d+=s,5)+850148119;switch(u=0,p=0,f=0,g=0,n){case 15:g^=e.charCodeAt(w+14)<<16;case 14:g^=e.charCodeAt(w+13)<<8;case 13:g=r(g^=e.charCodeAt(w+12),v),d^=g=r(g=o(g,18),m);case 12:f^=e.charCodeAt(w+11)<<24;case 11:f^=e.charCodeAt(w+10)<<16;case 10:f^=e.charCodeAt(w+9)<<8;case 9:f=r(f^=e.charCodeAt(w+8),y),l^=f=r(f=o(f,17),v);case 8:p^=e.charCodeAt(w+7)<<24;case 7:p^=e.charCodeAt(w+6)<<16;case 6:p^=e.charCodeAt(w+5)<<8;case 5:p=r(p^=e.charCodeAt(w+4),h),c^=p=r(p=o(p,16),y);case 4:u^=e.charCodeAt(w+3)<<24;case 3:u^=e.charCodeAt(w+2)<<16;case 2:u^=e.charCodeAt(w+1)<<8;case 1:u=r(u^=e.charCodeAt(w),m),s^=u=r(u=o(u,15),h)}return s^=e.length,s+=c^=e.length,s+=l^=e.length,c+=s+=d^=e.length,l+=s,d+=s,s=i(s),s+=c=i(c),s+=l=i(l),c+=s+=d=i(d),l+=s,d+=s,("00000000"+(s>>>0).toString(16)).slice(-8)+("00000000"+(c>>>0).toString(16)).slice(-8)+("00000000"+(l>>>0).toString(16)).slice(-8)+("00000000"+(d>>>0).toString(16)).slice(-8)},n.x64.hash128=function(e,t){t=t||0;for(var n=(e=e||"").length%16,r=e.length-n,o=[0,t],i=[0,t],p=[0,0],f=[0,0],g=[2277735313,289559509],m=[1291169091,658871167],h=0;h<r;h+=16)p=[255&e.charCodeAt(h+4)|(255&e.charCodeAt(h+5))<<8|(255&e.charCodeAt(h+6))<<16|(255&e.charCodeAt(h+7))<<24,255&e.charCodeAt(h)|(255&e.charCodeAt(h+1))<<8|(255&e.charCodeAt(h+2))<<16|(255&e.charCodeAt(h+3))<<24],f=[255&e.charCodeAt(h+12)|(255&e.charCodeAt(h+13))<<8|(255&e.charCodeAt(h+14))<<16|(255&e.charCodeAt(h+15))<<24,255&e.charCodeAt(h+8)|(255&e.charCodeAt(h+9))<<8|(255&e.charCodeAt(h+10))<<16|(255&e.charCodeAt(h+11))<<24],p=c(p=s(p,g),31),o=a(o=c(o=d(o,p=s(p,m)),27),i),o=a(s(o,[0,5]),[0,1390208809]),f=c(f=s(f,m),33),i=a(i=c(i=d(i,f=s(f,g)),31),o),i=a(s(i,[0,5]),[0,944331445]);switch(p=[0,0],f=[0,0],n){case 15:f=d(f,l([0,e.charCodeAt(h+14)],48));case 14:f=d(f,l([0,e.charCodeAt(h+13)],40));case 13:f=d(f,l([0,e.charCodeAt(h+12)],32));case 12:f=d(f,l([0,e.charCodeAt(h+11)],24));case 11:f=d(f,l([0,e.charCodeAt(h+10)],16));case 10:f=d(f,l([0,e.charCodeAt(h+9)],8));case 9:f=s(f=d(f,[0,e.charCodeAt(h+8)]),m),i=d(i,f=s(f=c(f,33),g));case 8:p=d(p,l([0,e.charCodeAt(h+7)],56));case 7:p=d(p,l([0,e.charCodeAt(h+6)],48));case 6:p=d(p,l([0,e.charCodeAt(h+5)],40));case 5:p=d(p,l([0,e.charCodeAt(h+4)],32));case 4:p=d(p,l([0,e.charCodeAt(h+3)],24));case 3:p=d(p,l([0,e.charCodeAt(h+2)],16));case 2:p=d(p,l([0,e.charCodeAt(h+1)],8));case 1:p=s(p=d(p,[0,e.charCodeAt(h)]),g),o=d(o,p=s(p=c(p,31),m))}return o=a(o=d(o,[0,e.length]),i=d(i,[0,e.length])),i=a(i,o),o=a(o=u(o),i=u(i)),i=a(i,o),("00000000"+(o[0]>>>0).toString(16)).slice(-8)+("00000000"+(o[1]>>>0).toString(16)).slice(-8)+("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=n),t.murmurHash3=n}()},238(e,t,n){var r=n(835);function o(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}o.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)},o.prototype.add=function(e){var t,n,o,i,a,s;t=this._last,n=e,o=t.generatedLine,i=n.generatedLine,a=t.generatedColumn,s=n.generatedColumn,i>o||i==o&&s>=a||r.compareByGeneratedPositionsInflated(t,n)<=0?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))},o.prototype.toArray=function(){return this._sorted||(this._array.sort(r.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},t.P=o},263(e,t,n){var r,o,i;!function(){"use strict";o=[n(343)],void 0===(i="function"==typeof(r=function(e){var t=/(^|@)\S+:\d+/,n=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(n))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var t=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,""));return[t[1],t[2]||void 0,t[3]||void 0]},parseV8OrIE:function(t){return t.stack.split("\n").filter(function(e){return!!e.match(n)},this).map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var n=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),r=n.match(/ (\(.+\)$)/);n=r?n.replace(r[0],""):n;var o=this.extractLocation(r?r[1]:n),i=r&&n||void 0,a=["eval","<anonymous>"].indexOf(o[0])>-1?void 0:o[0];return new e({functionName:i,fileName:a,lineNumber:o[1],columnNumber:o[2],source:t})},this)},parseFFOrSafari:function(t){return t.stack.split("\n").filter(function(e){return!e.match(r)},this).map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),-1===t.indexOf("@")&&-1===t.indexOf(":"))return new e({functionName:t});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,r=t.match(n),o=r&&r[1]?r[1]:void 0,i=this.extractLocation(t.replace(n,""));return new e({functionName:o,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,r=t.message.split("\n"),o=[],i=2,a=r.length;i<a;i+=2){var s=n.exec(r[i]);s&&o.push(new e({fileName:s[2],lineNumber:s[1],source:r[i]}))}return o},parseOpera10:function(t){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=t.stacktrace.split("\n"),o=[],i=0,a=r.length;i<a;i+=2){var s=n.exec(r[i]);s&&o.push(new e({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:r[i]}))}return o},parseOpera11:function(n){return n.stack.split("\n").filter(function(e){return!!e.match(t)&&!e.match(/^Error created at/)},this).map(function(t){var n,r=t.split("@"),o=this.extractLocation(r.pop()),i=r.shift()||"",a=i.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0;i.match(/\(([^)]*)\)/)&&(n=i.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var s=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new e({functionName:a,args:s,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:t})},this)}}})?r.apply(t,o):r)||(e.exports=i)}()},343(e,t){var n,r,o;!function(){"use strict";r=[],void 0===(o="function"==typeof(n=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function t(e){return e.charAt(0).toUpperCase()+e.substring(1)}function n(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],o=["columnNumber","lineNumber"],i=["fileName","functionName","source"],a=["args"],s=["evalOrigin"],c=r.concat(o,i,a,s);function l(e){if(e)for(var n=0;n<c.length;n++)void 0!==e[c[n]]&&this["set"+t(c[n])](e[c[n]])}l.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof l)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new l(e)}},toString:function(){var e=this.getFileName()||"",t=this.getLineNumber()||"",n=this.getColumnNumber()||"",r=this.getFunctionName()||"";return this.getIsEval()?e?"[eval] ("+e+":"+t+":"+n+")":"[eval]:"+t+":"+n:r?r+" ("+e+":"+t+":"+n+")":e+":"+t+":"+n}},l.fromString=function(e){var t=e.indexOf("("),n=e.lastIndexOf(")"),r=e.substring(0,t),o=e.substring(t+1,n).split(","),i=e.substring(n+1);if(0===i.indexOf("@"))var a=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(i,""),s=a[1],c=a[2],d=a[3];return new l({functionName:r,args:o||void 0,fileName:s,lineNumber:c||void 0,columnNumber:d||void 0})};for(var d=0;d<r.length;d++)l.prototype["get"+t(r[d])]=n(r[d]),l.prototype["set"+t(r[d])]=function(e){return function(t){this[e]=Boolean(t)}}(r[d]);for(var u=0;u<o.length;u++)l.prototype["get"+t(o[u])]=n(o[u]),l.prototype["set"+t(o[u])]=function(t){return function(n){if(!e(n))throw new TypeError(t+" must be a Number");this[t]=Number(n)}}(o[u]);for(var p=0;p<i.length;p++)l.prototype["get"+t(i[p])]=n(i[p]),l.prototype["set"+t(i[p])]=function(e){return function(t){this[e]=String(t)}}(i[p]);return l})?n.apply(t,r):n)||(e.exports=o)}()},606(e,t,n){var r=n(835),o=n(35),i=n(671).C,a=n(860),s=n(737).g;function c(e){var t=e;return"string"==typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,""))),null!=t.sections?new u(t):new l(t)}function l(e){var t=e;"string"==typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var n=r.getArg(t,"version"),o=r.getArg(t,"sources"),a=r.getArg(t,"names",[]),s=r.getArg(t,"sourceRoot",null),c=r.getArg(t,"sourcesContent",null),l=r.getArg(t,"mappings"),d=r.getArg(t,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);o=o.map(String).map(r.normalize).map(function(e){return s&&r.isAbsolute(s)&&r.isAbsolute(e)?r.relative(s,e):e}),this._names=i.fromArray(a.map(String),!0),this._sources=i.fromArray(o,!0),this.sourceRoot=s,this.sourcesContent=c,this._mappings=l,this.file=d}function d(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function u(e){var t=e;"string"==typeof e&&(t=JSON.parse(e.replace(/^\)\]\}'/,"")));var n=r.getArg(t,"version"),o=r.getArg(t,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new i,this._names=new i;var a={line:-1,column:0};this._sections=o.map(function(e){if(e.url)throw new Error("Support for url field in sections not implemented.");var t=r.getArg(e,"offset"),n=r.getArg(t,"line"),o=r.getArg(t,"column");if(n<a.line||n===a.line&&o<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=t,{generatedOffset:{generatedLine:n+1,generatedColumn:o+1},consumer:new c(r.getArg(e,"map"))}})}c.fromSourceMap=function(e){return l.fromSourceMap(e)},c.prototype._version=3,c.prototype.__generatedMappings=null,Object.defineProperty(c.prototype,"_generatedMappings",{get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),c.prototype.__originalMappings=null,Object.defineProperty(c.prototype,"_originalMappings",{get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),c.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return";"===n||","===n},c.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")},c.GENERATED_ORDER=1,c.ORIGINAL_ORDER=2,c.GREATEST_LOWER_BOUND=1,c.LEAST_UPPER_BOUND=2,c.prototype.eachMapping=function(e,t,n){var o,i=t||null;switch(n||c.GENERATED_ORDER){case c.GENERATED_ORDER:o=this._generatedMappings;break;case c.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;o.map(function(e){var t=null===e.source?null:this._sources.at(e.source);return null!=t&&null!=a&&(t=r.join(a,t)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}},this).forEach(e,i)},c.prototype.allGeneratedPositionsFor=function(e){var t=r.getArg(e,"line"),n={source:r.getArg(e,"source"),originalLine:t,originalColumn:r.getArg(e,"column",0)};if(null!=this.sourceRoot&&(n.source=r.relative(this.sourceRoot,n.source)),!this._sources.has(n.source))return[];n.source=this._sources.indexOf(n.source);var i=[],a=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,o.LEAST_UPPER_BOUND);if(a>=0){var s=this._originalMappings[a];if(void 0===e.column)for(var c=s.originalLine;s&&s.originalLine===c;)i.push({line:r.getArg(s,"generatedLine",null),column:r.getArg(s,"generatedColumn",null),lastColumn:r.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++a];else for(var l=s.originalColumn;s&&s.originalLine===t&&s.originalColumn==l;)i.push({line:r.getArg(s,"generatedLine",null),column:r.getArg(s,"generatedColumn",null),lastColumn:r.getArg(s,"lastGeneratedColumn",null)}),s=this._originalMappings[++a]}return i},t.SourceMapConsumer=c,l.prototype=Object.create(c.prototype),l.prototype.consumer=c,l.fromSourceMap=function(e){var t=Object.create(l.prototype),n=t._names=i.fromArray(e._names.toArray(),!0),o=t._sources=i.fromArray(e._sources.toArray(),!0);t.sourceRoot=e._sourceRoot,t.sourcesContent=e._generateSourcesContent(t._sources.toArray(),t.sourceRoot),t.file=e._file;for(var a=e._mappings.toArray().slice(),c=t.__generatedMappings=[],u=t.__originalMappings=[],p=0,f=a.length;p<f;p++){var g=a[p],m=new d;m.generatedLine=g.generatedLine,m.generatedColumn=g.generatedColumn,g.source&&(m.source=o.indexOf(g.source),m.originalLine=g.originalLine,m.originalColumn=g.originalColumn,g.name&&(m.name=n.indexOf(g.name)),u.push(m)),c.push(m)}return s(t.__originalMappings,r.compareByOriginalPositions),t},l.prototype._version=3,Object.defineProperty(l.prototype,"sources",{get:function(){return this._sources.toArray().map(function(e){return null!=this.sourceRoot?r.join(this.sourceRoot,e):e},this)}}),l.prototype._parseMappings=function(e,t){for(var n,o,i,c,l,u=1,p=0,f=0,g=0,m=0,h=0,y=e.length,v=0,w={},b={},E=[],I=[];v<y;)if(";"===e.charAt(v))u++,v++,p=0;else if(","===e.charAt(v))v++;else{for((n=new d).generatedLine=u,c=v;c<y&&!this._charIsMappingSeparator(e,c);c++);if(i=w[o=e.slice(v,c)])v+=o.length;else{for(i=[];v<c;)a.decode(e,v,b),l=b.value,v=b.rest,i.push(l);if(2===i.length)throw new Error("Found a source, but no line and column");if(3===i.length)throw new Error("Found a source and line, but no column");w[o]=i}n.generatedColumn=p+i[0],p=n.generatedColumn,i.length>1&&(n.source=m+i[1],m+=i[1],n.originalLine=f+i[2],f=n.originalLine,n.originalLine+=1,n.originalColumn=g+i[3],g=n.originalColumn,i.length>4&&(n.name=h+i[4],h+=i[4])),I.push(n),"number"==typeof n.originalLine&&E.push(n)}s(I,r.compareByGeneratedPositionsDeflated),this.__generatedMappings=I,s(E,r.compareByOriginalPositions),this.__originalMappings=E},l.prototype._findMapping=function(e,t,n,r,i,a){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return o.search(e,t,i,a)},l.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}},l.prototype.originalPositionFor=function(e){var t={generatedLine:r.getArg(e,"line"),generatedColumn:r.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",r.compareByGeneratedPositionsDeflated,r.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(n>=0){var o=this._generatedMappings[n];if(o.generatedLine===t.generatedLine){var i=r.getArg(o,"source",null);null!==i&&(i=this._sources.at(i),null!=this.sourceRoot&&(i=r.join(this.sourceRoot,i)));var a=r.getArg(o,"name",null);return null!==a&&(a=this._names.at(a)),{source:i,line:r.getArg(o,"originalLine",null),column:r.getArg(o,"originalColumn",null),name:a}}}return{source:null,line:null,column:null,name:null}},l.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return null==e}))},l.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;if(null!=this.sourceRoot&&(e=r.relative(this.sourceRoot,e)),this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];var n;if(null!=this.sourceRoot&&(n=r.urlParse(this.sourceRoot))){var o=e.replace(/^file:\/\//,"");if("file"==n.scheme&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!n.path||"/"==n.path)&&this._sources.has("/"+e))return this.sourcesContent[this._sources.indexOf("/"+e)]}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},l.prototype.generatedPositionFor=function(e){var t=r.getArg(e,"source");if(null!=this.sourceRoot&&(t=r.relative(this.sourceRoot,t)),!this._sources.has(t))return{line:null,column:null,lastColumn:null};var n={source:t=this._sources.indexOf(t),originalLine:r.getArg(e,"line"),originalColumn:r.getArg(e,"column")},o=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,r.getArg(e,"bias",c.GREATEST_LOWER_BOUND));if(o>=0){var i=this._originalMappings[o];if(i.source===n.source)return{line:r.getArg(i,"generatedLine",null),column:r.getArg(i,"generatedColumn",null),lastColumn:r.getArg(i,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},u.prototype=Object.create(c.prototype),u.prototype.constructor=c,u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){for(var e=[],t=0;t<this._sections.length;t++)for(var n=0;n<this._sections[t].consumer.sources.length;n++)e.push(this._sections[t].consumer.sources[n]);return e}}),u.prototype.originalPositionFor=function(e){var t={generatedLine:r.getArg(e,"line"),generatedColumn:r.getArg(e,"column")},n=o.search(t,this._sections,function(e,t){var n=e.generatedLine-t.generatedOffset.generatedLine;return n||e.generatedColumn-t.generatedOffset.generatedColumn}),i=this._sections[n];return i?i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})},u.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var r=this._sections[n].consumer.sourceContentFor(e,!0);if(r)return r}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(-1!==n.consumer.sources.indexOf(r.getArg(e,"source"))){var o=n.consumer.generatedPositionFor(e);if(o)return{line:o.line+(n.generatedOffset.generatedLine-1),column:o.column+(n.generatedOffset.generatedLine===o.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},u.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var o=this._sections[n],i=o.consumer._generatedMappings,a=0;a<i.length;a++){var c=i[a],l=o.consumer._sources.at(c.source);null!==o.consumer.sourceRoot&&(l=r.join(o.consumer.sourceRoot,l)),this._sources.add(l),l=this._sources.indexOf(l);var d=o.consumer._names.at(c.name);this._names.add(d),d=this._names.indexOf(d);var u={source:l,generatedLine:c.generatedLine+(o.generatedOffset.generatedLine-1),generatedColumn:c.generatedColumn+(o.generatedOffset.generatedLine===c.generatedLine?o.generatedOffset.generatedColumn-1:0),originalLine:c.originalLine,originalColumn:c.originalColumn,name:d};this.__generatedMappings.push(u),"number"==typeof u.originalLine&&this.__originalMappings.push(u)}s(this.__generatedMappings,r.compareByGeneratedPositionsDeflated),s(this.__originalMappings,r.compareByOriginalPositions)}},671(e,t,n){var r=n(835),o=Object.prototype.hasOwnProperty;function i(){this._array=[],this._set=Object.create(null)}i.fromArray=function(e,t){for(var n=new i,r=0,o=e.length;r<o;r++)n.add(e[r],t);return n},i.prototype.size=function(){return Object.getOwnPropertyNames(this._set).length},i.prototype.add=function(e,t){var n=r.toSetString(e),i=o.call(this._set,n),a=this._array.length;i&&!t||this._array.push(e),i||(this._set[n]=a)},i.prototype.has=function(e){var t=r.toSetString(e);return o.call(this._set,t)},i.prototype.indexOf=function(e){var t=r.toSetString(e);if(o.call(this._set,t))return this._set[t];throw new Error('"'+e+'" is not in the set.')},i.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)},i.prototype.toArray=function(){return this._array.slice()},t.C=i},737(e,t){function n(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function r(e,t,o,i){if(o<i){var a=o-1;n(e,(d=o,u=i,Math.round(d+Math.random()*(u-d))),i);for(var s=e[i],c=o;c<i;c++)t(e[c],s)<=0&&n(e,a+=1,c);n(e,a+1,c);var l=a+1;r(e,t,o,l-1),r(e,t,l+1,i)}var d,u}t.g=function(e,t){r(e,t,0,e.length-1)}},769(e,t,n){e.exports=n(187)},835(e,t){t.getArg=function(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.]*)(?::(\d+))?(\S*)$/,r=/^data:.+\,.+$/;function o(e){var t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function i(e){var t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}function a(e){var n=e,r=o(e);if(r){if(!r.path)return e;n=r.path}for(var a,s=t.isAbsolute(n),c=n.split(/\/+/),l=0,d=c.length-1;d>=0;d--)"."===(a=c[d])?c.splice(d,1):".."===a?l++:l>0&&(""===a?(c.splice(d+1,l),l=0):(c.splice(d,2),l--));return""===(n=c.join("/"))&&(n=s?"/":"."),r?(r.path=n,i(r)):n}t.urlParse=o,t.urlGenerate=i,t.normalize=a,t.join=function(e,t){""===e&&(e="."),""===t&&(t=".");var n=o(t),s=o(e);if(s&&(e=s.path||"/"),n&&!n.scheme)return s&&(n.scheme=s.scheme),i(n);if(n||t.match(r))return t;if(s&&!s.host&&!s.path)return s.host=t,i(s);var c="/"===t.charAt(0)?t:a(e.replace(/\/+$/,"")+"/"+t);return s?(s.path=c,i(s)):c},t.isAbsolute=function(e){return"/"===e.charAt(0)||!!e.match(n)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");for(var n=0;0!==t.indexOf(e+"/");){var r=e.lastIndexOf("/");if(r<0)return t;if((e=e.slice(0,r)).match(/^([^\/]+:\/)?\/*$/))return t;++n}return Array(n+1).join("../")+t.substr(e.length+1)};var s=!("__proto__"in Object.create(null));function c(e){return e}function l(e){if(!e)return!1;var t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(var n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function d(e,t){return e===t?0:e>t?1:-1}t.toSetString=s?c:function(e){return l(e)?"$"+e:e},t.fromSetString=s?c:function(e){return l(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,n){var r=e.source-t.source;return 0!==r||0!==(r=e.originalLine-t.originalLine)||0!==(r=e.originalColumn-t.originalColumn)||n||0!==(r=e.generatedColumn-t.generatedColumn)||0!==(r=e.generatedLine-t.generatedLine)?r:e.name-t.name},t.compareByGeneratedPositionsDeflated=function(e,t,n){var r=e.generatedLine-t.generatedLine;return 0!==r||0!==(r=e.generatedColumn-t.generatedColumn)||n||0!==(r=e.source-t.source)||0!==(r=e.originalLine-t.originalLine)||0!==(r=e.originalColumn-t.originalColumn)?r:e.name-t.name},t.compareByGeneratedPositionsInflated=function(e,t){var n=e.generatedLine-t.generatedLine;return 0!==n||0!==(n=e.generatedColumn-t.generatedColumn)||0!==(n=d(e.source,t.source))||0!==(n=e.originalLine-t.originalLine)||0!==(n=e.originalColumn-t.originalColumn)?n:d(e.name,t.name)}},860(e,t,n){var r=n(900);t.encode=function(e){var t,n="",o=function(e){return e<0?1+(-e<<1):0+(e<<1)}(e);do{t=31&o,(o>>>=5)>0&&(t|=32),n+=r.encode(t)}while(o>0);return n},t.decode=function(e,t,n){var o,i,a,s,c=e.length,l=0,d=0;do{if(t>=c)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(i=r.decode(e.charCodeAt(t++))))throw new Error("Invalid base64 digit: "+e.charAt(t-1));o=!!(32&i),l+=(i&=31)<<d,d+=5}while(o);n.value=(s=(a=l)>>1,1&~a?s:-s),n.rest=t}},885(e,t,n){var r,o,i;!function(){"use strict";o=[n(65),n(343)],void 0===(i="function"==typeof(r=function(e,t){function n(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("get",e),r.onerror=n,r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300||"file://"===e.substr(0,7)&&r.responseText?t(r.responseText):n(new Error("HTTP status: "+r.status+" retrieving "+e)))},r.send()})}function r(e){if("undefined"!=typeof window&&window.atob)return window.atob(e);throw new Error("You must supply a polyfill for window.atob in this environment")}function o(e){if("undefined"!=typeof JSON&&JSON.parse)return JSON.parse(e);throw new Error("You must supply a polyfill for JSON.parse in this environment")}function i(e,t){for(var n=[/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,/function\s+([^('"`]*?)\s*\(([^)]*)\)/,/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,/\b(?!(?:if|for|switch|while|with|catch)\b)(?:(?:static)\s+)?(\S+)\s*\(.*?\)\s*\{/,/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*\(.*?\)\s*=>/],r=e.split("\n"),o="",i=Math.min(t,20),a=0;a<i;++a){var s=r[t-a-1],c=s.indexOf("//");if(c>=0&&(s=s.substr(0,c)),s){o=s+o;for(var l=n.length,d=0;d<l;d++){var u=n[d].exec(o);if(u&&u[1])return u[1]}}}}function a(){if("function"!=typeof Object.defineProperty||"function"!=typeof Object.create)throw new Error("Unable to consume source maps in older browsers")}function s(e){if("object"!=typeof e)throw new TypeError("Given StackFrame is not an object");if("string"!=typeof e.fileName)throw new TypeError("Given file name is not a String");if("number"!=typeof e.lineNumber||e.lineNumber%1!=0||e.lineNumber<1)throw new TypeError("Given line number must be a positive integer");if("number"!=typeof e.columnNumber||e.columnNumber%1!=0||e.columnNumber<0)throw new TypeError("Given column number must be a non-negative integer");return!0}function c(e){for(var t,n,r=/\/\/[#@] ?sourceMappingURL=([^\s'"]+)\s*$/gm;n=r.exec(e);)t=n[1];if(t)return t;throw new Error("sourceMappingURL not found")}function l(e,n,r){return new Promise(function(o,i){var a=n.originalPositionFor({line:e.lineNumber,column:e.columnNumber});if(a.source){var s=n.sourceContentFor(a.source);s&&(r[a.source]=s),o(new t({functionName:a.name||e.functionName,args:e.args,fileName:a.source,lineNumber:a.line,columnNumber:a.column}))}else i(new Error("Could not get original source for given stackframe and source map"))})}return function d(u){if(!(this instanceof d))return new d(u);u=u||{},this.sourceCache=u.sourceCache||{},this.sourceMapConsumerCache=u.sourceMapConsumerCache||{},this.ajax=u.ajax||n,this._atob=u.atob||r,this._get=function(e){return new Promise(function(t,n){var r="data:"===e.substr(0,5);if(this.sourceCache[e])t(this.sourceCache[e]);else if(u.offline&&!r)n(new Error("Cannot make network requests in offline mode"));else if(r){var o=/^data:application\/json;([\w=:"-]+;)*base64,/,i=e.match(o);if(i){var a=i[0].length,s=e.substr(a),c=this._atob(s);this.sourceCache[e]=c,t(c)}else n(new Error("The encoding of the inline sourcemap is not supported"))}else{var l=this.ajax(e,{method:"get"});this.sourceCache[e]=l,l.then(t,n)}}.bind(this))},this._getSourceMapConsumer=function(t,n){return new Promise(function(r){if(this.sourceMapConsumerCache[t])r(this.sourceMapConsumerCache[t]);else{var i=new Promise(function(r,i){return this._get(t).then(function(t){"string"==typeof t&&(t=o(t.replace(/^\)\]\}'/,""))),void 0===t.sourceRoot&&(t.sourceRoot=n),r(new e.SourceMapConsumer(t))}).catch(i)}.bind(this));this.sourceMapConsumerCache[t]=i,r(i)}}.bind(this))},this.pinpoint=function(e){return new Promise(function(t,n){this.getMappedLocation(e).then(function(e){function n(){t(e)}this.findFunctionName(e).then(t,n).catch(n)}.bind(this),n)}.bind(this))},this.findFunctionName=function(e){return new Promise(function(n,r){s(e),this._get(e.fileName).then(function(r){var o=e.lineNumber,a=e.columnNumber,s=i(r,o,a);n(s?new t({functionName:s,args:e.args,fileName:e.fileName,lineNumber:o,columnNumber:a}):e)},r).catch(r)}.bind(this))},this.getMappedLocation=function(e){return new Promise(function(t,n){a(),s(e);var r=this.sourceCache,o=e.fileName;this._get(o).then(function(n){var i=c(n),a="data:"===i.substr(0,5),s=o.substring(0,o.lastIndexOf("/")+1);return"/"===i[0]||a||/^https?:\/\/|^\/\//i.test(i)||(i=s+i),this._getSourceMapConsumer(i,s).then(function(n){return l(e,n,r).then(t).catch(function(){t(e)})})}.bind(this),n).catch(n)}.bind(this))}}})?r.apply(t,o):r)||(e.exports=i)}()},887(e,t,n){var r,o,i;!function(){"use strict";o=[n(343)],r=function(e){return{backtrace:function(t){var n=[],r=10;"object"==typeof t&&"number"==typeof t.maxStackSize&&(r=t.maxStackSize);for(var o=arguments.callee;o&&n.length<r&&o.arguments;){for(var i=new Array(o.arguments.length),a=0;a<i.length;++a)i[a]=o.arguments[a];/function(?:\s+([\w$]+))+\s*\(/.test(o.toString())?n.push(new e({functionName:RegExp.$1||void 0,args:i})):n.push(new e({args:i}));try{o=o.caller}catch(e){break}}return n}}},void 0===(i="function"==typeof r?r.apply(t,o):r)||(e.exports=i)}()},900(e,t){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},t.decode=function(e){return 65<=e&&e<=90?e-65:97<=e&&e<=122?e-97+26:48<=e&&e<=57?e-48+52:43==e?62:47==e?63:-1}},945(e,t,n){var r=n(860),o=n(835),i=n(671).C,a=n(238).P;function s(e){e||(e={}),this._file=o.getArg(e,"file",null),this._sourceRoot=o.getArg(e,"sourceRoot",null),this._skipValidation=o.getArg(e,"skipValidation",!1),this._sources=new i,this._names=new i,this._mappings=new a,this._sourcesContents=null}s.prototype._version=3,s.fromSourceMap=function(e){var t=e.sourceRoot,n=new s({file:e.file,sourceRoot:t});return e.eachMapping(function(e){var r={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(r.source=e.source,null!=t&&(r.source=o.relative(t,r.source)),r.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(r.name=e.name)),n.addMapping(r)}),e.sources.forEach(function(t){var r=e.sourceContentFor(t);null!=r&&n.setSourceContent(t,r)}),n},s.prototype.addMapping=function(e){var t=o.getArg(e,"generated"),n=o.getArg(e,"original",null),r=o.getArg(e,"source",null),i=o.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,r,i),null!=r&&(r=String(r),this._sources.has(r)||this._sources.add(r)),null!=i&&(i=String(i),this._names.has(i)||this._names.add(i)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:null!=n&&n.line,originalColumn:null!=n&&n.column,source:r,name:i})},s.prototype.setSourceContent=function(e,t){var n=e;null!=this._sourceRoot&&(n=o.relative(this._sourceRoot,n)),null!=t?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[o.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[o.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},s.prototype.applySourceMap=function(e,t,n){var r=t;if(null==t){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');r=e.file}var a=this._sourceRoot;null!=a&&(r=o.relative(a,r));var s=new i,c=new i;this._mappings.unsortedForEach(function(t){if(t.source===r&&null!=t.originalLine){var i=e.originalPositionFor({line:t.originalLine,column:t.originalColumn});null!=i.source&&(t.source=i.source,null!=n&&(t.source=o.join(n,t.source)),null!=a&&(t.source=o.relative(a,t.source)),t.originalLine=i.line,t.originalColumn=i.column,null!=i.name&&(t.name=i.name))}var l=t.source;null==l||s.has(l)||s.add(l);var d=t.name;null==d||c.has(d)||c.add(d)},this),this._sources=s,this._names=c,e.sources.forEach(function(t){var r=e.sourceContentFor(t);null!=r&&(null!=n&&(t=o.join(n,t)),null!=a&&(t=o.relative(a,t)),this.setSourceContent(t,r))},this)},s.prototype._validateMapping=function(e,t,n,r){if((!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0)||t||n||r)&&!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:r}))},s.prototype._serializeMappings=function(){for(var e,t,n,i,a=0,s=1,c=0,l=0,d=0,u=0,p="",f=this._mappings.toArray(),g=0,m=f.length;g<m;g++){if(e="",(t=f[g]).generatedLine!==s)for(a=0;t.generatedLine!==s;)e+=";",s++;else if(g>0){if(!o.compareByGeneratedPositionsInflated(t,f[g-1]))continue;e+=","}e+=r.encode(t.generatedColumn-a),a=t.generatedColumn,null!=t.source&&(i=this._sources.indexOf(t.source),e+=r.encode(i-u),u=i,e+=r.encode(t.originalLine-1-l),l=t.originalLine-1,e+=r.encode(t.originalColumn-c),c=t.originalColumn,null!=t.name&&(n=this._names.indexOf(t.name),e+=r.encode(n-d),d=n)),p+=e}return p},s.prototype._generateSourcesContent=function(e,t){return e.map(function(e){if(!this._sourcesContents)return null;null!=t&&(e=o.relative(t,e));var n=o.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null},this)},s.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e},s.prototype.toString=function(){return JSON.stringify(this.toJSON())},t.SourceMapGenerator=s}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";var e;!function(e){e[e.CONTINUE=0]="CONTINUE",e[e.STOP=1]="STOP"}(e||(e={}));class t{constructor(){this.maxAttempts=10,this.interval=50,this.exponentRate=1.5}static run(n){const r=Object.assign(new t,n),{onTick:o,onError:i,onTimeout:a,interval:s,exponentRate:c,maxAttempts:l}=r,d=(t=0)=>{if((t=>{try{return o(t)}catch(t){return i(t instanceof Error?t:new Error("Unknown error occurred")),e.STOP}})(t)===e.STOP)return;if(t+1>=l)return void a();const n=s*Math.pow(t+1,c);setTimeout(()=>{d(t+1)},n)};return d(),r}static runAsync(n,r={}){return new Promise((o,i)=>{t.run({...r,onTick:()=>{const t=n();return t?(o(t),e.STOP):e.CONTINUE},onError:i,onTimeout:()=>{o(null)}})})}}function r(e,t){const n=e instanceof Error?e:new Error(String(e));if(t)for(const[e,r]of Object.entries(t))Object.defineProperty(n,e,{value:r,enumerable:!0,writable:!0,configurable:!0});return n}function o(){try{return window.location.search.includes("at_cjs_version")||window.location.search.includes("exp_debug")||window.location.search.includes("previewExperience")}catch(e){return console.error("Error determining if logs should be displayed:",e),!1}}const i={info:(...e)=>{o()&&console.info(...e)},debug:(...e)=>{o()&&console.debug(...e)},warn:(...e)=>{o()&&console.warn(...e)},error:(...e)=>{o()&&console.error(...e)},log:(...e)=>{o()&&console.log(...e)}};var a=n(769);const s=Math.pow(2,32);var c;!function(e){e.DB_NOT_AVAILABLE="DB_NOT_AVAILABLE",e.CONNECTION_FAILED="CONNECTION_FAILED",e.DB_BLOCKED="DB_BLOCKED",e.DB_UPGRADE_NEEDED="DB_UPGRADE_NEEDED",e.DB_VERSION_ERROR="DB_VERSION_ERROR",e.DB_NAME_REQUIRED="DB_NAME_REQUIRED",e.DB_VERSION_REQUIRED="DB_VERSION_REQUIRED",e.DB_TIMEOUT="DB_TIMEOUT",e.STORE_NAME_REQUIRED="STORE_NAME_REQUIRED",e.STORE_NOT_FOUND="STORE_NOT_FOUND",e.STORE_ALREADY_EXISTS="STORE_ALREADY_EXISTS",e.TRANSACTION_FAILED="TRANSACTION_FAILED",e.TRANSACTION_ABORTED="TRANSACTION_ABORTED",e.READ_ONLY_TRANSACTION_WRITE_ATTEMPT="READ_ONLY_TRANSACTION_WRITE_ATTEMPT",e.INVALID_KEY="INVALID_KEY",e.KEY_ALREADY_EXISTS="KEY_ALREADY_EXISTS",e.DATA_REQUIRED="DATA_REQUIRED",e.INVALID_DATA_TYPE="INVALID_DATA_TYPE",e.DATA_CLONE_ERROR="DATA_CLONE_ERROR",e.DATA_ERROR="DATA_ERROR",e.INSERT_FAILED="INSERT_FAILED",e.UPDATE_FAILED="UPDATE_FAILED",e.GET_FAILED="GET_FAILED",e.DELETE_FAILED="DELETE_FAILED",e.CURSOR_FAILED="CURSOR_FAILED",e.TTL_CLEANUP_FAILED="TTL_CLEANUP_FAILED",e.EXPIRED_DATA_STORE_CLEANUP_FAILED="EXPIRED_DATA_STORE_CLEANUP_FAILED",e.EXPIRED_DATA="EXPIRED_DATA",e.INVALID_DB_INSTANCE="INVALID_DB_INSTANCE",e.DB_REQUIRED="DB_REQUIRED",e.QUOTA_EXCEEDED="QUOTA_EXCEEDED",e.UNKNOWN_ERROR="UNKNOWN_ERROR",e.INVALID_CURSOR_ITERATOR="INVALID_CURSOR_ITERATOR",e.INVALID_CURSOR_QUERY="INVALID_CURSOR_QUERY",e.INVALID_CURSOR_DIRECTION="INVALID_CURSOR_DIRECTION"}(c||(c={}));class l extends n.g.Error{constructor(e){super(`ManagedIndexDB failed: ${e}`),this.reason=e}}class d{constructor(e,t){if(this._db=e,this.options=t,!this._db)throw new l(c.DB_REQUIRED);if("undefined"!=typeof IDBDatabase&&!(this._db instanceof IDBDatabase))throw new l(c.INVALID_DB_INSTANCE);if("undefined"==typeof IDBDatabase&&(!this._db||"function"!=typeof this._db.transaction))throw new l(c.INVALID_DB_INSTANCE)}get db(){return this._db}async insert(e,t,n){return new Promise((r,o)=>{if(e)if("object"==typeof t)try{const i=this._db.transaction(e,"readwrite").objectStore(e),a={...t};this.options.storeTTL?.[e]&&(a.timestamp=Date.now());const s=i.add(a,n);s.onsuccess=()=>{r(a)},s.onerror=()=>{o(new l(c.INSERT_FAILED))}}catch(e){o(new l(e instanceof Error?e.message:c.INSERT_FAILED))}else o(new l(c.INVALID_DATA_TYPE));else o(new l(c.STORE_NAME_REQUIRED))})}async update(e,t,n){if(!e)throw new l(c.STORE_NAME_REQUIRED);if("object"!=typeof t)throw new l(c.INVALID_DATA_TYPE);return new Promise((r,o)=>{try{const i=this._db.transaction(e,"readwrite"),a=i.objectStore(e).put(t,n);a.onsuccess=()=>{r()},a.onerror=()=>{o(new l(c.UPDATE_FAILED))}}catch(e){o(new l(e instanceof Error?e.message:c.UPDATE_FAILED))}})}async delete(e,t){if(!e)throw new l(c.STORE_NAME_REQUIRED);if(null==t)throw new l(c.INVALID_KEY);return new Promise((n,r)=>{try{const o=this._db.transaction(e,"readwrite"),i=o.objectStore(e).delete(t);i.onsuccess=()=>{n(i.result)},i.onerror=()=>{r(new l(c.DELETE_FAILED))}}catch(e){r(new l(e.message))}})}async get(e,t){if(!e)throw new l(c.STORE_NAME_REQUIRED);if(null==t)throw new l(c.INVALID_KEY);return new Promise((n,r)=>{try{const o=this._db.transaction(e,"readonly"),i=o.objectStore(e).get(t);i.onsuccess=()=>{n(i.result)},i.onerror=()=>{r(new l(c.GET_FAILED))}}catch(e){r(new l(e instanceof Error?e.message:c.DATA_ERROR))}})}async cursor(e,t,n,r){if(!e)throw new l(c.STORE_NAME_REQUIRED);if(!t||"function"!=typeof t)throw new l(c.INVALID_CURSOR_ITERATOR);return new Promise((o,i)=>{try{const a=this._db.transaction(e,"readonly"),s=a.objectStore(e).openCursor(n,r);a.oncomplete=()=>{o()},a.onerror=()=>{i(new l(c.CURSOR_FAILED))},s.onsuccess=async e=>{const n=e.target.result;if(n)try{await t(n),n.continue()}catch(e){i(new l(e instanceof Error?e.message:c.CURSOR_FAILED))}},s.onerror=()=>{i(new l(c.CURSOR_FAILED))}}catch(e){i(new l(e instanceof Error?e.message:c.CURSOR_FAILED))}})}}async function u(e,t,n){if(!t)throw new l(c.STORE_NAME_REQUIRED);if("number"!=typeof n||n<=0)throw new l(c.EXPIRED_DATA);return new Promise((r,o)=>{try{const i=e.transaction(t,"readwrite"),a=i.objectStore(t),s=a.openCursor(),d=[];s.onsuccess=e=>{const t=e.target.result;if(t){const e=t.value;if(e&&"object"==typeof e&&"timestamp"in e){const r=e.timestamp;Date.now()-r>n&&d.push(t.key)}t.continue()}else Promise.all(d.map(e=>new Promise((t,n)=>{const r=a.delete(e);r.onsuccess=()=>{t()},r.onerror=()=>{n()}}))).then(()=>r()).catch(()=>o(new l(c.TTL_CLEANUP_FAILED)))},s.onerror=()=>{o(new l(c.TTL_CLEANUP_FAILED))},i.oncomplete=()=>{0===d.length&&r()},i.onerror=()=>{o(new l(c.TRANSACTION_FAILED))}}catch(e){o(new l(e instanceof Error?e.message:c.TRANSACTION_FAILED))}})}const p=["/ae/en/","/ar/es/","/at/de/","/at/en/","/au/en/","/be/nl/","/be/de/","/be/en/","/be/fr/","/bg/en/","/ca/en/","/ca/fr/","/ch/de/","/ch/en/","/ch/fr/","/ch/it/","/cl/es/","/cn/zh/","/cz/cs/","/cz/en/","/de/de/","/dk/da/","/dk/en/","/eg/en/","/es/es/","/es/ca/","/fi/en/","/fr/fr/","/gb/en/","/gr/el/","/hr/en/","/hu/hu/","/hu/en/","/id/en/","/ie/en/","/il/en/","/in/en/","/it/it/","/jp/ja/","/jp/en/","/kr/ko/","/kr/en/","/lu/fr/","/lu/de/","/lu/en/","/ma/fr/","/ma/en/","/mx/es/","/my/en/","/nl/nl/","/nl/en/","/no/no/","/no/en/","/nz/en/","/ph/en/","/pl/pl/","/pr/es/","/pt/pt/","/pt/en/","/ro/en/","/ru/ru/","/sa/en/","/se/sv/","/se/en/","/sg/en/","/si/en/","/sk/en/","/th/th/","/tr/tr/","/tw/zh/","/us/en/","/us/es/","/uy/es/","/vn/en/","/za/en/","/xl/es/"];function f(){if(function(){const e=window.location.pathname,t=e.endsWith("/")?e:`${e}/`;return"/"===t||/^\/[a-z]{2}\/?$/.test(t)||p.includes(t)}())return"homepage";if(window.location.origin.includes("gs-checkout.nike.com"))return"gs-checkout";const e=function(e){const t=new Set(p.map(e=>e.split("/")[1])),n=p.map(e=>e.replace(/^\/|\/$/g,"").replace("/","\\/")).join("|"),r=Array.from(t).join("|"),o=new RegExp(`^/(?:${n}|(${r}))(?=/|$)`,"i");return e.replace(o,"")||"/"}(window.location.href.replace(window.location.origin,"")),t=Object.entries({"/t/":"pdp","/t-dark/":"pdp","/u-dark/":"pdp","/u/":"pdp","/w/":"pw","/w-dark/":"pw","/w?q=":"onsite search","/w-dark?q=":"onsite search","/cart":"cart","/checkout":"checkout","/member":"member","/help":"help","/inbox":"inbox","/favorites":"favorites","/size-fit":"sizechart","/retail":"retail","/jordan":"landingpage","/men":"landingpage","/women":"landingpage","/kids":"landingpage"}).find(([t])=>e.includes(t));if(t&&"retail"===t[1]){const e=document.querySelector("article");return e?.id?e.id.replace("-"," "):t[1]}return t?t[1]:null}var g=n(139);function m(e,t){return{[`${e.toLowerCase()}_version`]:t}}function h(e,t){const n=m(e,t);return window.experimentation?.platformsVersions&&Array.isArray(window.experimentation.platformsVersions)?window.experimentation.platformsVersions.reduce((e,{platform:t,version:n})=>({...e,...m(t,n)}),n):n}class y{constructor(e,t){this.config=e,this.logSink=t,this.getStackTrace=e=>0===e.length?"Stack trace unavailable":`FILE: ${String(e[0].fileName)} LINE: ${String(e[0].lineNumber)} Column: ${String(e[0].columnNumber)} FUNCTION: ${String(e[0].functionName)}`}getReporterParams(){return[this.config,this.logSink]}extractErrorMetadata(e,t){const n=Object.getOwnPropertyNames(e).filter(e=>"name"!==e&&"message"!==e&&"stack"!==e).reduce((t,n)=>(t[n]=e[n],t),{});return{errorMessage:e.message||"Unknown error message",...n,errorStack:this.getStackTrace(t)}}async remote(e,t,n){if(n instanceof Error){const e=n;try{const t=await g.fromError(e);n=this.extractErrorMetadata(e,t)}catch{n=this.extractErrorMetadata(e,[])}}if(n?.error){const{error:e,...t}=n;if(e instanceof Error)try{const r=await g.fromError(e),o=this.extractErrorMetadata(e,r);n={...t,...o}}catch{const r=this.extractErrorMetadata(e,[]);n={...t,...r}}}const r={severity:e,logMessage:t,...n,...h(this.config.platform,this.config.version)};i[e](this.config.platform,r),this.logSink.log(this.config.platform,r)}debug(e,...t){i.debug(e,...t)}info(e,t){this.remote("info",e,t)}error(e,t){this.remote("error",e,t)}log(e,t){this.remote("log",e,t)}warn(e,t){this.remote("warn",e,t)}}class v{constructor(e,t=8e3,n=100){this.loggerProvider=e,this.timeoutMs=t,this.checkIntervalMs=n,this._queue=[],this.loggerFn=null,this.isReady=!1,this.hasTimedOut=!1,this.checkInterval=null,this.timeoutTimer=null,this.startChecking()}startChecking(){this.checkLogger(),this.checkInterval=setInterval(()=>{this.checkLogger()},this.checkIntervalMs),this.timeoutTimer=setTimeout(()=>{this.handleTimeout()},this.timeoutMs)}checkLogger(){if(this.isReady||this.hasTimedOut)return;const e=this.loggerProvider();e&&(this.loggerFn=e,this.isReady=!0,this.flushQueue(),this.cleanup())}handleTimeout(){this.isReady||(this.hasTimedOut=!0,this._queue=[],this.cleanup())}flushQueue(){if(this.loggerFn&&0!==this._queue.length){for(const{eventName:e,data:t}of this._queue)this.loggerFn(e,t);this._queue=[]}}cleanup(){this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}log(e,t){this.hasTimedOut||(this.isReady&&this.loggerFn?this.loggerFn(e,t):this._queue.push({eventName:e,data:t}))}get ready(){return this.isReady}get timedOut(){return this.hasTimedOut}get queue(){return this._queue}}function w(){const e=(e,t)=>{const n=function(e){if("object"!=typeof e||null===e)return{};const t={};for(const[n,r]of Object.entries(e))if(null!=r)if("string"==typeof r||"number"==typeof r||"boolean"==typeof r)t[n]=r;else if(Array.isArray(r)||"object"==typeof r)try{t[n]=JSON.stringify(r)}catch(e){i.warn(`Failed to serialize attribute "${n}":`,e),t[n]=String(r)}else t[n]=String(r);return t}(t),r={eventType:"PageAction",actionName:e,...function(){const e={appName:"eshopworld",currentUrl:window.location.href,referrerUrl:document.referrer||""},t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);e.deviceType=t?"Mobile":"Desktop";const n=navigator.userAgent;return n.includes("Chrome")&&!n.includes("Edg")?e.userAgentName="Chrome":n.includes("Safari")&&!n.includes("Chrome")?e.userAgentName="Safari":n.includes("Firefox")?e.userAgentName="Firefox":n.includes("Edg")?e.userAgentName="Edge":e.userAgentName="Unknown",n.includes("Windows")?e.userAgentOS="Windows":n.includes("Android")?e.userAgentOS="Android":n.includes("iPhone")||n.includes("iPad")?e.userAgentOS="iPhone":n.includes("Mac")?e.userAgentOS="Mac":n.includes("Linux")?e.userAgentOS="Linux":e.userAgentOS="Unknown",e}(),...n};fetch("https://insights-collector.newrelic.com/v1/accounts/714737/events",{method:"POST",headers:{"Content-Type":"application/json","X-Insert-Key":"2lrxTiTBk6-5ot3iFiVRFwzX40tQTtw7"},body:JSON.stringify(r)}).catch(e=>{i.error("Failed to send event to New Relic:",e)})};window.experimentation||(window.experimentation={});window.experimentation.newrelic={addPageAction:(t,n)=>{e(t,n)},noticeError:(t,n)=>{const r={errorMessage:t.message,errorStack:t.stack,"error.class":t.name,...n};e("JavaScriptError",r)},loader_config:{licenseKey:"f6e2d580c7"}}}function b(e){var t,n;t=e.platform,n=e.version,window.experimentation||(window.experimentation={}),window.experimentation.platformsVersions||(window.experimentation.platformsVersions=[]),window.experimentation.platformsVersions.push({platform:t,version:n});const r=new v(()=>{const e=function(){if(window.location.href.includes("gs-checkout")){const e=window.experimentation.newrelic;if(e&&"function"==typeof e.addPageAction)return e;w();const t=window.experimentation.newrelic;return t&&"function"==typeof t.addPageAction?t:void i.warn("[experimentation-utils] Failed to create mock New Relic agent")}const e=window.newrelic;if(e&&"function"==typeof e.addPageAction)return e}();return e?.addPageAction?e.addPageAction.bind(e):void 0});return new y(e,r)}const E="authenticated",I="ambiguous",S="2iv4Qa7rFEipAs4iE850BkBpTYQvlAFZ",C="Universal Holdout Disposition",k={dbName:"uh",dbVersion:3,storeName:"current_config",keyPath:"id"},T={dbName:"experimentation",dbVersion:3,storeName:"experiments",keyPath:"id"},N={NA:"d6fb8ca6-f462-4ee3-9c25-6a60fabfb5d0",EMEA:"035c8ad3-1294-4444-9fbb-1506d5a35a82",APLA:"826f0c9a-f432-4678-919b-0b1d1524644a",NA_NPE:"fda8073e-524d-43ca-a9cc-97d15079ad0a",EMEA_NPE:"7e80feac-a4de-42fb-98ae-8ef7b49b6515",APLA_NPE:"0887862a-0ae8-463d-a2fb-c255be1c4b62"},A={APLA:["AU","ID","IN","JP","KR","MY","NZ","PH","SG","TH","TW","VN"],EMEA:["AE","AT","BE","BG","CH","CZ","DE","DK","ES","FI","FR","GB","GR","HR","HU","IE","IL","IT","LU","NL","NO","PL","PT","RO","SA","SE","SI","SK","TR","ZA"],NA:["CA","MX","US"]};let D=null,O=null;function _(e){const t=window.location.search;if(D!==t){const e=new URLSearchParams(t),n=new URLSearchParams;e.forEach((e,t)=>{n.set(t.toLowerCase(),e)}),O=n,D=t}return O.get((e||"").toLowerCase())}const P={info:(e,t)=>{if(window?.webShellClient?.optimization?.logger)return window.webShellClient.optimization.logger.info(e,t)},debug:(e,t)=>{if(window?.webShellClient?.optimization?.logger)return window.webShellClient.optimization.logger.debug(e,t)},warn:(e,t)=>{if(window?.webShellClient?.optimization?.logger)return window.webShellClient.optimization.logger.warn(e,t)},error:(e,t)=>{if(window?.webShellClient?.optimization?.logger)return window.webShellClient.optimization.logger.error(e,t)}};const x="optimization-debug";function R(e){return"boolean"==typeof e}function L(){try{const e=sessionStorage.getItem(x);if(!e)return{};const t=JSON.parse(e);return"object"!=typeof t||null===t?(P.warn("Invalid debug config format in session storage, returning empty config"),{}):t}catch(e){return P.warn("Failed to parse debug config from session storage",{error:e instanceof Error?e.message:String(e)}),{}}}function M(e){if(!R(e)){const t=new Error(`Invalid parameter: expected boolean, received ${typeof e}. Valid values are true or false.`);throw P.error("setbypassHoldout validation failed",{providedValue:e,expectedType:"boolean",actualType:typeof e}),t}try{const t={...L(),bypassHoldout:e};sessionStorage.setItem(x,JSON.stringify(t)),P.debug("Holdout debug override set",{bypassHoldout:e})}catch(t){const n="Failed to set holdout debug override";throw P.error(n,{error:t instanceof Error?t.message:String(t),bypassHoldout:e}),new Error(`${n}: ${t instanceof Error?t.message:String(t)}`)}}function U(){try{sessionStorage.removeItem(x),P.debug("Debug configuration cleared")}catch(e){P.warn("Failed to clear debug configuration",{error:e instanceof Error?e.message:String(e)})}}function F(){return L().bypassHoldout}function j(e){if(!R(e)){const t=new Error(`Invalid parameter: expected boolean, received ${typeof e}. Valid values are true or false.`);throw P.error("setBypassPrivacy validation failed",{providedValue:e,providedType:typeof e}),t}try{const t={...L(),bypassPrivacy:e};sessionStorage.setItem(x,JSON.stringify(t))}catch(e){throw P.error("Failed to set bypass privacy debug override",{error:e instanceof Error?e.message:String(e)}),new Error("Failed to set bypass privacy debug override: "+String(e))}}function B(e){if("string"!=typeof e){const t=new Error(`Invalid parameter: expected string, received ${typeof e}.`);throw P.error("setDatastreamId validation failed",{providedValue:e,providedType:typeof e}),t}try{const t=L();if(""===e){const{datastreamId:e,...n}=t;sessionStorage.setItem(x,JSON.stringify(n))}else{const n={...t,datastreamId:e};sessionStorage.setItem(x,JSON.stringify(n))}}catch(e){throw P.error("Failed to set datastream ID debug override",{error:e instanceof Error?e.message:String(e)}),new Error("Failed to set datastream ID debug override: "+String(e))}}function $(e){if("string"!=typeof e){const t=new Error(`Invalid parameter: expected string, received ${typeof e}.`);throw P.error("setEnv validation failed",{providedValue:e,providedType:typeof e}),t}try{const t=L();if(""===e){const{env:e,...n}=t;sessionStorage.setItem(x,JSON.stringify(n))}else{const n={...t,env:e};sessionStorage.setItem(x,JSON.stringify(n))}}catch(e){throw P.error("Failed to set env debug override",{error:e instanceof Error?e.message:String(e)}),new Error("Failed to set env debug override: "+String(e))}}function q(){return L().env}function V(){const e=L(),t=document.createElement("div");t.setAttribute("data-testid","debug-overrides-toast"),t.style.cssText="\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background-color: rgba(0, 0, 0, 0.8);\n      color: white;\n      padding: 12px 20px;\n      border-radius: 4px;\n      font-family: Arial, sans-serif;\n      font-size: 14px;\n      z-index: 9999;\n      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n      display: flex;\n      align-items: center;\n      gap: 10px;\n    ";const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column";const r=document.createElement("div");r.textContent=" Debug overrides active",r.style.fontWeight="bold",n.appendChild(r);const o=Object.entries(e);if(0===o.length){const e=document.createElement("div");e.textContent="No overrides active",e.style.fontSize="12px",e.style.opacity="0.9",e.style.marginTop="4px",n.appendChild(e)}else{const e=document.createElement("ul");e.style.cssText="\n      font-size: 12px;\n      opacity: 0.9;\n      margin: 4px 0 0 0;\n      padding-left: 20px;\n      list-style-type: disc;\n    ",o.forEach(([t,n])=>{const r=document.createElement("li");r.textContent=`${t}: ${n}`,r.style.marginTop="2px",e.appendChild(r)}),n.appendChild(e)}const i=document.createElement("div");i.textContent="Will persist until browser tab is closed",i.style.fontSize="11px",i.style.opacity="0.8",i.style.marginTop="4px",i.style.fontStyle="italic",n.appendChild(i);const a=document.createElement("button");a.textContent="",a.style.cssText="\n      background: none;\n      border: none;\n      color: white;\n      font-size: 16px;\n      cursor: pointer;\n      padding: 0 0 0 10px;\n      margin-left: auto;\n    ",a.title="Close";const s=()=>{t&&t.parentNode&&t.parentNode.removeChild(t)};a.onclick=s,t.appendChild(n),t.appendChild(a),document.body.appendChild(t),setTimeout(s,15e3)}function z(e={},t){try{const n=t||window.webShellClient?.optimization;if(!n)return void P.warn("No optimization client found, debug object cannot be initialized");n.__debug=function(e={}){const{logCreation:t=!0}=e,n={setBypassHoldout:M,setBypassPrivacy:j,setDatastreamId:B,setEnv:$,getConfig:L,clearConfig:U,info:{storageKey:"optimization-debug",help:function(){const e="\n Optimization Client Debug Utilities\n\nAvailable Functions:\n===================\n\nsetBypassHoldout(boolean)\n  Override the holdout status for testing\n  Example: window.webShellClient.optimization.__debug.setBypassHoldout(true)\n\nsetBypassPrivacy(boolean)\n  Bypass privacy checks for testing\n  Example: window.webShellClient.optimization.__debug.setBypassPrivacy(true)\n\nsetDatastreamId(string)\n  Override Adobe Alloy datastream ID for testing\n  Example: window.webShellClient.optimization.__debug.setDatastreamId('my-test-id')\n\nsetEnv(string)\n  Override environment for testing\n  Example: window.webShellClient.optimization.__debug.setEnv('npe')\n\ngetConfig()\n  Get the current debug configuration\n  Example: window.webShellClient.optimization.__debug.getConfig()\n\nclearConfig()\n  Clear all debug overrides\n  Example: window.webShellClient.optimization.__debug.clearConfig()\n\ninfo.help()\n  Show this help message\n  Example: window.webShellClient.optimization.__debug.info.help()\n\nURL Parameter Overrides (case insensitive):\n==========================================\n\nYou can set debug overrides via URL parameters:\n  ?bypassHoldout=true              - Force all locations into holdout\n  ?bypassPrivacy=true          - Bypass privacy checks\n  ?datastreamId=test-123       - Override datastream ID\n  ?env=npe                     - Override environment\n  ?bypassHoldout=true&bypassPrivacy=false&datastreamId=my-id&env=npe - Combine all\n\nCase insensitive examples:\n  ?bypassHoldout=false  \n  ?BYPASSPRIVACY=true\n  ?DatastreamId=my-test-stream\n  ?ENV=npe\n  ?BypassPrivacy=false&DATASTREAMID=test&Env=npe\n\nNote: All overrides are stored in session storage and persist across page reloads\nwithin the same browser session. URL parameters are auto-detected on initialization.\n    ".trim();console.info(e)}}};return t&&P.debug("Optimization debug object created",{availableFunctions:Object.keys(n),storageKey:n.info.storageKey}),n}(e),function(){try{if("undefined"==typeof window||!window.location.search)return;const e=window.location.search,t=_("bypassHoldout");null!==t&&("true"===t?(M(!0),P.debug("Holdout debug override set from query string",{parameter:"bypassHoldout",value:!0,queryString:e})):"false"===t?(M(!1),P.debug("Holdout debug override set from query string",{parameter:"bypassHoldout",value:!1,queryString:e})):P.warn("Invalid bypassHoldout query parameter value (case insensitive)",{value:t,queryString:e,validValues:["true","false"]}));const n=_("bypassPrivacy");null!==n&&("true"===n?(j(!0),P.debug("Bypass privacy debug override set from query string",{parameter:"bypassPrivacy",value:!0,queryString:e})):"false"===n?(j(!1),P.debug("Bypass privacy debug override set from query string",{parameter:"bypassPrivacy",value:!1,queryString:e})):P.warn("Invalid bypassPrivacy query parameter value (case insensitive)",{value:n,queryString:e,validValues:["true","false"]}));const r=_("datastreamId");null!==r&&""!==r&&(B(r),P.debug("Datastream ID debug override set from query string",{parameter:"datastreamId",value:r,queryString:e}));const o=_("env");null!==o&&""!==o&&($(o),P.debug("Environment debug override set from query string",{parameter:"env",value:o,queryString:e}))}catch(e){P.error("Failed to check query string for debug overrides",{error:e instanceof Error?e.message:String(e),queryString:"undefined"!=typeof window?window.location?.search:"unknown"})}}();const r=L();Object.keys(r).length>0&&setTimeout(()=>{V()},100)}catch(e){P.error("Failed to initialize debug object",{error:e instanceof Error?e.message:String(e)})}}const J=e=>{const t=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=atob(t);return Uint8Array.from(n,e=>e.codePointAt(0))},H=(e,t={})=>{const{urlSafe:n=!1}=t||{},r=btoa(String.fromCharCode(...e));return n?r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""):r};function G(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]=n[r]}return e}var X=function e(t,n){function r(e,r,o){if("undefined"!=typeof document){"number"==typeof(o=G({},n,o)).expires&&(o.expires=new Date(Date.now()+864e5*o.expires)),o.expires&&(o.expires=o.expires.toUTCString()),e=encodeURIComponent(e).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var i="";for(var a in o)o[a]&&(i+="; "+a,!0!==o[a]&&(i+="="+o[a].split(";")[0]));return document.cookie=e+"="+t.write(r,e)+i}}return Object.create({set:r,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var n=document.cookie?document.cookie.split("; "):[],r={},o=0;o<n.length;o++){var i=n[o].split("="),a=i.slice(1).join("=");try{var s=decodeURIComponent(i[0]);if(r[s]=t.read(a,s),e===s)break}catch(e){}}return e?r[e]:r}},remove:function(e,t){r(e,"",G({},t,{expires:-1}))},withAttributes:function(t){return e(this.converter,G({},this.attributes,t))},withConverter:function(t){return e(G({},this.converter,t),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(t)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"});const W={get:X.get.bind(X),set:X.set.bind(X),remove:X.remove.bind(X),withConverter:X.withConverter.bind(X)},Y=e=>null==e,K=e=>!Y(e)&&!Array.isArray(e)&&"object"==typeof e,Q=(e,t)=>{Object.keys(t).forEach(n=>{K(e[n])&&K(t[n])?Q(e[n],t[n]):e[n]=t[n]})},Z=(e,...t)=>{if(Y(e))throw new TypeError('deepAssign "target" cannot be null or undefined');const n=Object(e);return t.forEach(e=>Q(n,Object(e))),n},ee=(e,t)=>n=>{const r=t.split(".").reduce((e,t)=>(e[t]=e[t]||{},e[t]),e);Z(r,n)},te=({logger:e,cookieJar:t})=>({...t,set:(n,r,o)=>(e.info("Setting cookie",{name:n,value:r,...o}),t.set(n,r,o))}),ne=()=>{const e={};return e.promise=new Promise((t,n)=>{e.resolve=t,e.reject=n}),e},re=(e,t)=>e.appendChild(t),oe=(e,t={},n={},r=[],o=document)=>{const i=o.createElement(e);return Object.keys(t).forEach(e=>{i.setAttribute(e,t[e])}),((e,t)=>{Object.keys(t).forEach(n=>{if("style"===n&&K(t[n])){const r=t[n];Object.keys(r).forEach(t=>{e.style[t]=r[t]})}else e[n]=t[n]})})(i,n),r.forEach(e=>re(i,e)),i},ie="IMG",ae="STYLE",se="SCRIPT",ce=({src:e,currentDocument:t=document})=>new Promise((n,r)=>{oe(ie,{src:e},{onload:n,onerror:r,onabort:r},[],t)}),le=e=>"function"==typeof e,de=e=>Array.isArray(e)&&e.length>0,ue=e=>Array.isArray(e)?e:null==e?[]:[].slice.call(e),pe=/^\s*>/,fe=(e,t)=>pe.test(t)?ue(e.querySelectorAll(`:scope ${t}`)):ue(e.querySelectorAll(t)),ge=":shadow",me=(e,t)=>{const n=t;if(!n.startsWith(">"))return n;return`${e instanceof Element||e instanceof Document?":scope":":host"} ${n}`},he=(e,t)=>{const n=(e=>e.split(ge))(t);if(n.length<2)return fe(e,t);let r=e;for(let e=0;e<n.length;e+=1){const t=n[e].trim();if(""===t&&r.shadowRoot){r=r.shadowRoot;continue}const o=me(r,t),i=fe(r,o);if(0===i.length||!i[0]||!i[0].shadowRoot)return i;r=i[0].shadowRoot}},ye=(e,t=document)=>-1===e.indexOf(ge)?fe(t,e):he(t,e),ve="MutationObserver",we={childList:!0,subtree:!0},be=e=>new Error(`Could not find: ${e}`),Ee=e=>new Promise(e),Ie=(e,t=ye,n=5e3,r=window,o=document)=>{const i=t(e);return de(i)?Promise.resolve(i):(e=>le(e[ve]))(r)?((e,t,n,r,o)=>Ee((i,a)=>{let s;const c=new e[ve](()=>{const e=o(n);de(e)&&(c.disconnect(),s&&clearTimeout(s),i(e))});s=setTimeout(()=>{c.disconnect(),a(be(n))},r),c.observe(t,we)}))(r,o,e,n,t):(e=>"visible"===e.visibilityState)(o)?((e,t,n,r)=>Ee((o,i)=>{const a=()=>{const n=r(t);de(n)?o(n):e.requestAnimationFrame(a)};a(),setTimeout(()=>{i(be(t))},n)}))(r,e,n,t):((e,t,n)=>Ee((r,o)=>{const i=()=>{const t=n(e);de(t)?r(t):setTimeout(i,100)};i(),setTimeout(()=>{o(be(e))},t)}))(e,n,t)};let Se;const Ce=(e=document)=>{if(void 0===Se){const t=e.querySelector("[nonce]");Se=t&&(t.nonce||t.getAttribute("nonce"))}return Se},ke=(e,t={})=>document.querySelector(`script[src="${e}"]`)?(t.onLoad&&t.onLoad(),Promise.resolve()):new Promise((n,r)=>{const{attributes:o={},onLoad:i,onError:a}=t,s=oe("script",{type:"text/javascript",src:e,async:!0,...Ce()&&{nonce:Ce()},...o},{onload:()=>{i&&i(),n()},onerror:()=>{const t=new Error(`Failed to load script: ${e}`);a&&a(t),r(t)}}),c=()=>{const e=document.head||document.body;if(e)re(e,s);else{const e=new Error("Neither <head> nor <body> available for script insertion.");a&&a(e),r(e)}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c()}),Te=e=>{const t=e.parentNode;return t?t.removeChild(e):null},Ne={name:"Adobe Alloy"},Ae={style:{display:"none",width:0,height:0}},De=e=>(e=>{let t=2166136261;const n=(new TextEncoder).encode(e);for(let e=0;e<n.length;e+=1)t^=n[e],t=Math.imul(t,16777619);return t>>>0})(e).toString(16).padStart(8,"0"),Oe="com.adobe.alloy.",_e=(e,t)=>e.slice(-t),Pe=`${Oe}getTld`,xe=e=>e.replace("@","_"),Re=(e,t)=>`kndctr_${xe(e)}_${t}`,Le=(e,t)=>{const n={};return e.forEach(e=>{const r=t(e);n[r]||(n[r]=[]),n[r].push(e)}),n},Me="Chrome",Ue="Edge",Fe="EdgeChromium",je="Firefox",Be="IE",$e="Safari",qe="Unknown",Ve=e=>{let t,n=!1;return()=>(n||(n=!0,t=e()),t)},ze=[Me,Ue,Fe,"IE",qe],Je=({getBrowser:e})=>Ve(()=>ze.includes(e())),He=({orgId:e})=>{const t=Re(e,"identity");return()=>Boolean(W.get(t))},Ge=(e,t,n)=>({getItem(r){try{return e[t].getItem(n+r)}catch{return null}},setItem(r,o){try{return e[t].setItem(n+r,o),!0}catch{return!1}},clear(){try{return Object.keys(e[t]).forEach(r=>{r.startsWith(n)&&e[t].removeItem(r)}),!0}catch{return!1}}}),Xe=e=>t=>{const n=Oe+t;return{session:Ge(e,"sessionStorage",n),persistent:Ge(e,"localStorage",n)}},We=e=>K(e)&&0===Object.keys(e).length,Ye=e=>"string"==typeof e,Ke=e=>Ye(e)&&e.length>0,Qe=e=>"number"==typeof e&&!Number.isNaN(e),Ze=()=>{},et=(e,t)=>Y(e)||!K(e)?e:Object.keys(e).reduce((n,r)=>{const o=e[r];if(K(o)){const e=et(o,t);return We(e)?n:{...n,[r]:e}}return t(o)?{...n,[r]:o}:n},{}),tt=et,nt=e=>"boolean"==typeof e;const rt=n(68),ot=e=>Array.isArray(e)?e.map(e=>ot(e)):"object"==typeof e&&null!==e?Object.keys(e).sort().reduce((t,n)=>(t[n]=ot(e[n]),t),{}):e,it=e=>ot(e),at=(e,t)=>{if(Qe(e)||Ye(e)){const t=Math.round(Number(e));if(!Number.isNaN(t))return t}return t},st=(e,t,n)=>`${e}`.padStart(t,n),ct={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let lt;const dt=new Uint8Array(16);const ut=[];for(let e=0;e<256;++e)ut.push((e+256).toString(16).slice(1));function pt(e,t=0){return(ut[e[t+0]]+ut[e[t+1]]+ut[e[t+2]]+ut[e[t+3]]+"-"+ut[e[t+4]]+ut[e[t+5]]+"-"+ut[e[t+6]]+ut[e[t+7]]+"-"+ut[e[t+8]]+ut[e[t+9]]+"-"+ut[e[t+10]]+ut[e[t+11]]+ut[e[t+12]]+ut[e[t+13]]+ut[e[t+14]]+ut[e[t+15]]).toLowerCase()}const ft=function(e,t,n){if(ct.randomUUID&&!t&&!e)return ct.randomUUID();const r=(e=e||{}).random??e.rng?.()??function(){if(!lt){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");lt=crypto.getRandomValues.bind(crypto)}return lt(dt)}();if(r.length<16)throw new Error("Random bytes length must be >= 16");if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){if((n=n||0)<0||n+16>t.length)throw new RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=r[e];return t}return pt(r)},gt=e=>function(t,n){return null==t?t:e.call(this,t,n)},mt=(e,t)=>function(n,r){return t.call(this,e.call(this,n,r),r)},ht=(e,t)=>function(n,r){const o=[],i=[e,t].reduce((e,t)=>{try{return t.call(this,e,r)}catch(t){return o.push(t),e}},n);if(o.length)throw new Error(o.join("\n"));return i},yt=(e,t,n)=>Object.assign(mt(e,t),e,n),vt=(e,t,n)=>Object.assign(mt(e,gt(t)),e,n),wt=(e,t,n,r)=>{if(!e)throw new Error(`'${n}': Expected ${r}, but got ${JSON.stringify(t)}.`)},bt=(e,t)=>(wt(nt(e),e,t,"true or false"),e),Et=(e,t)=>(wt(le(e),e,t,"a function"),e),It=(e,t)=>function(n,r){let o;const i=e.find(e=>{try{return o=e.call(this,n,r),!0}catch{return!1}});return wt(i,n,r,t),o},St=e=>function(t,n){wt(Array.isArray(t),t,n,"an array");const r=[],o=t.map((o,i)=>{try{return e.call(this,o,`${n}[${i}]`,t)}catch(e){return void r.push(e.message)}});if(r.length)throw new Error(r.join("\n"));return o},Ct=(e="This field has been deprecated")=>function(t,n){let r=e;return void 0!==t&&(n&&(r=`'${n}': ${r}`),this&&this.logger&&this.logger.warn(r)),t},kt=e=>function(t,n){wt(K(t),t,n,"an object");const r=[],o={};if(Object.keys(t).forEach(i=>{const a=t[i],s=n?`${n}.${i}`:i;try{const t=e.call(this,a,s);void 0!==t&&(o[i]=t)}catch(e){r.push(e.message)}}),r.length)throw new Error(r.join("\n"));return o},Tt=(e,t)=>(n,r)=>(wt(n>=t,n,r,`${e} greater than or equal to ${t}`),n),Nt=e=>(t,n)=>(K(t)?wt(!We(t),t,n,e):wt(t.length>0,t,n,e),t),At=e=>function(t,n){wt(K(t),t,n,"an object");const r=[],o={};if(Object.keys(e).forEach(i=>{const a=t[i],s=e[i],c=n?`${n}.${i}`:i;try{const e=s.call(this,a,c);void 0!==e&&(o[i]=e)}catch(e){r.push(e.message)}}),Object.keys(t).forEach(e=>{Object.prototype.hasOwnProperty.call(o,e)||(o[e]=t[e])}),r.length)throw new Error(r.join("\n"));return o},Dt=(e,t,n)=>function(r,o){wt(K(r),r,o,"an object");const{[e]:i,[n]:a,...s}=r,c=t(i,o);if(void 0!==c){let t=`The field '${e}' is deprecated. Use '${n}' instead.`;if(o&&(t=`'${o}': ${t}`),void 0!==a&&a!==c)throw new Error(t);this&&this.logger&&this.logger.warn(t)}return{[n]:a||c,...s}},Ot=()=>(e,t)=>(wt((e=>{const t=Object.create(null);for(let n=0;n<e.length;n+=1){const r=e[n];if(r in t)return!1;t[r]=!0}return!0})(e),e,t,"array values to be unique"),e),_t=/^[a-z0-9.-]{1,}$/i,Pt=(e,t)=>(wt(_t.test(e),e,t,"a valid domain"),e),xt=(e,t)=>(wt((e=>{const t=parseInt(e,10);return Qe(t)&&e===t})(e),e,t,"an integer"),e),Rt=(e,t)=>(wt(Qe(e),e,t,"a number"),e),Lt=(e,t)=>(wt((e=>{try{return null!==RegExp(e)}catch{return!1}})(e),e,t,"a regular expression"),e),Mt=(e,t)=>{if(null==e)throw new Error(`'${t}' is a required option`);return e},Ut=(e,t)=>(wt(Ye(e),e,t,"a string"),e),Ft=e=>e;Ft.default=function(e){return yt(this,(e=>t=>null==t?e:t)(e))},Ft.required=function(){return yt(this,Mt)},Ft.deprecated=function(e){return yt(this,Ct(e))};const jt=function(){return vt(this,Pt)},Bt=function(e){return vt(this,Tt("an integer",e))},$t=function(e){return vt(this,Tt("a number",e))},qt=function(e){return vt(this,(t="a number",n=e,(e,r)=>(wt(e<=n,e,r,`${t} less than or equal to ${n}`),e)));var t,n},Vt=function(){return vt(this,xt,{minimum:Bt})},zt=function(){return vt(this,Nt("a non-empty string"))},Jt=function(){return vt(this,Nt("a non-empty array"))},Ht=function(){return vt(this,Nt("a non-empty object"))},Gt=function(){return vt(this,Lt)},Xt=function(e){return vt(this,(e=>(t,n)=>(wt(e.test(t),t,n,`does not match the ${e.toString()}`),t))(e))},Wt=function(){return vt(this,(()=>{const e=[];return(t,n)=>(wt(-1===e.indexOf(t),t,n,"a unique value across instances"),e.push(t),t)})())},Yt=function(){return vt(this,Ot())},Kt=e=>({noUnknownFields:function(){return vt(this,(e=>(t,n)=>{const r=[];if(Object.keys(t).forEach(t=>{if(!e[t]){const e=n?`${n}.${t}`:t;r.push(`'${e}': Unknown field.`)}}),r.length)throw new Error(r.join("\n"));return t})(e))},nonEmpty:Ht,concat:function(t){const n={...e,...t.schema};return vt(this,t,Kt(n))},renamed:function(e,t,n){return r=this,o=Dt(e,t,n),Object.assign(ht(gt(o),r),r,i);var r,o,i},schema:e}),Qt=function(e,t){return yt(this,It(e,t))}.bind(Ft),Zt=function(){return this}.bind(Ft),en=function(e){return vt(this,St(e),{nonEmpty:Jt,uniqueItems:Yt})}.bind(Ft),tn=function(){return vt(this,bt)}.bind(Ft),nn=function(){return vt(this,Et)}.bind(Ft),rn=function(e){return vt(this,(e=>(t,n)=>(wt(t===e,t,n,`${e}`),t))(e))}.bind(Ft),on=function(){return vt(this,Rt,{minimum:$t,maximum:qt,integer:Vt,unique:Wt})}.bind(Ft),an=function(e){return vt(this,kt(e),{nonEmpty:Ht})}.bind(Ft),sn=function(e){return vt(this,At(e),Kt(e))}.bind(Ft),cn=function(){return vt(this,Ut,{regexp:Gt,domain:jt,nonEmpty:zt,unique:Wt,matches:Xt})}.bind(Ft),ln=function(...e){return Qt(e.map(rn),`one of these values: ${JSON.stringify(e)}`)},dn=an(en(sn({authenticatedState:ln("ambiguous","authenticated","loggedOut"),id:cn(),namespace:sn({code:cn()}).noUnknownFields(),primary:tn(),xid:cn()}).noUnknownFields()).required()),un=sn({}),pn=(Object.freeze({VARINT:0,I64:1,LEN:2,SGROUP:3,EGROUP:4,I32:5}),e=>(t,n)=>{e.xdm=e.xdm||{},e.xdm.identityMap=e.xdm.identityMap||{},e.xdm.identityMap[t]=e.xdm.identityMap[t]||[],e.xdm.identityMap[t].push(n)}),fn=e=>{const{payload:t,getAction:n,getUseSendBeacon:r,datastreamIdOverride:o,edgeSubPath:i}=e,a=ft();let s=!1,c=!1;return{getId:()=>a,getPayload:()=>t,getAction:()=>n({isIdentityEstablished:c}),getDatastreamIdOverride:()=>o,getUseSendBeacon:()=>r({isIdentityEstablished:c}),getEdgeSubPath:()=>i||"",getUseIdThirdPartyDomain:()=>s,setUseIdThirdPartyDomain(){s=!0},setIsIdentityEstablished(){c=!0}}},gn=({payload:e,datastreamIdOverride:t})=>{const n=({isIdentityEstablished:t})=>e.getDocumentMayUnload()&&t;return fn({payload:e,getAction:({isIdentityEstablished:e})=>n({isIdentityEstablished:e})?"collect":"interact",getUseSendBeacon:n,datastreamIdOverride:t})},mn=e=>{const{content:t,addIdentity:n,hasIdentity:r}=e,o=((e,t)=>n=>{const r=t.split(".").reduce((e,t)=>(e[t]=e[t]||{},e[t]),e);Object.assign(r,n)})(t,"meta.configOverrides");return{mergeMeta:ee(t,"meta"),mergeState:ee(t,"meta.state"),mergeQuery:ee(t,"query"),mergeConfigOverride:e=>o((e=>{if(Y(e)||"object"!=typeof e)return null;const t=tt(e,e=>!(Y(e)||!nt(e)&&!Qe(e)&&!Ke(e)&&!de(e)));return We(t)?null:t})(e)),addIdentity:n,hasIdentity:r,toJSON:()=>t}},hn=e=>t=>void 0!==(e.xdm&&e.xdm.identityMap&&e.xdm.identityMap[t]),yn=()=>{const e={};return{...mn({content:e,addIdentity:pn(e),hasIdentity:hn(e)}),addEvent:t=>{e.events=e.events||[],e.events.push(t)},getDocumentMayUnload:()=>(e.events||[]).some(e=>e.getDocumentMayUnload())}},vn=({localConfigOverrides:e,globalConfigOverrides:t,payload:n})=>{const r={payload:n},{datastreamId:o,...i}=e||{};return o&&(r.datastreamIdOverride=o),t&&!We(t)&&n.mergeConfigOverride(t),i&&!We(i)&&n.mergeConfigOverride(i),r},wn="clientId",bn=e=>t=>{const n=e().toISOString();Z(t,{timestamp:n})},En="2.30.0",In=[["architecture","string"],["bitness","string"],["model","string"],["platformVersion","string"],["wow64","boolean"]],Sn=(e=>t=>{const n={webPageDetails:{URL:e.location.href||e.location},webReferrer:{URL:e.document.referrer}};Z(t,{web:n})})(window),Cn=(e=>t=>{const{screen:{width:n,height:r}}=e,o={},i=at(r);i>=0&&(o.screenHeight=i);const a=at(n);a>=0&&(o.screenWidth=a);const s=(e=>{const{screen:{orientation:t}}=e;if(null==t||null==t.type)return null;const n=t.type.split("-");return 0===n.length||"portrait"!==n[0]&&"landscape"!==n[0]?null:n[0]})(e)||(e=>{if(le(e.matchMedia)){if(e.matchMedia("(orientation: portrait)").matches)return"portrait";if(e.matchMedia("(orientation: landscape)").matches)return"landscape"}return null})(e);s&&(o.screenOrientation=s),Object.keys(o).length>0&&Z(t,{device:o})})(window),kn=(e=>t=>{const{document:{documentElement:{clientWidth:n,clientHeight:r}={}}}=e,o={type:"browser"},i=at(n);i>=0&&(o.browserDetails={viewportWidth:i});const a=at(r);a>=0&&(o.browserDetails=o.browserDetails||{},o.browserDetails.viewportHeight=a),Z(t,{environment:o})})(window),Tn=(Nn=()=>new Date,e=>{const t=Nn(),n={},r=at(t.getTimezoneOffset());void 0!==r&&(n.localTimezoneOffset=r),(void 0===r||Math.abs(r)<6e3)&&(n.localTime=(e=>{const t=e.getFullYear(),n=st(e.getMonth()+1,2,"0"),r=st(e.getDate(),2,"0"),o=st(e.getHours(),2,"0"),i=st(e.getMinutes(),2,"0"),a=st(e.getSeconds(),2,"0"),s=st(e.getMilliseconds(),3,"0"),c=at(e.getTimezoneOffset(),0);return`${t}-${n}-${r}T${o}:${i}:${a}.${s}${c>0?"-":"+"}${st(Math.floor(Math.abs(c)/60),2,"0")}:${st(Math.abs(c)%60,2,"0")}`})(t)),Z(e,{placeContext:n})});var Nn;const An=bn(()=>new Date),Dn={web:Sn,device:Cn,environment:kn,placeContext:Tn},On={highEntropyUserAgentHints:(e=>(e=>"userAgentData"in e)(e)?(t,n)=>{try{return e.userAgentData.getHighEntropyValues(In.map(e=>e[0])).then(e=>{const n={};In.forEach(([t,r])=>{Object.prototype.hasOwnProperty.call(e,t)&&typeof e[t]===r&&(n[t]=e[t])}),Z(t,{environment:{browserDetails:{userAgentClientHints:n}}})})}catch(e){return n.warn(`Unable to collect user-agent client hints. ${e.message}`),Ze}}:Ze)(navigator)},_n={...Dn,...On},Pn=[An,e=>{Z(e,{implementationDetails:{name:"https://ns.adobe.com/experience/alloy",version:En,environment:"browser"}})}],xn=({config:e,logger:t})=>((e,t,n,r)=>{const o=e.context.flatMap((e,r)=>n[e]?[n[e]]:(t.warn(`Invalid context[${r}]: '${e}' is not available.`),[])).concat(r);return{namespace:"Context",lifecycle:{onBeforeEvent({event:e}){const n={};return Promise.all(o.map(e=>Promise.resolve(e(n,t)))).then(()=>e.mergeXdm(n))}}}})(e,t,_n,Pn);xn.namespace="Context",xn.configValidators=sn({context:en(cn()).default(Object.keys(Dn))});const Rn="disabled",Ln="wait",Mn="auto",Un=({eventManager:e,logger:t})=>({commands:{sendEvent:{documentationUri:"https://adobe.ly/3GQ3Q7t",optionsValidator:e=>(({options:e})=>sn({type:cn(),xdm:sn({eventType:cn(),identityMap:dn}),data:sn({}),documentUnloading:tn(),renderDecisions:tn(),decisionScopes:en(cn()).uniqueItems(),personalization:sn({decisionScopes:en(cn()).uniqueItems(),surfaces:en(cn()).uniqueItems(),sendDisplayEvent:tn().default(!0),includeRenderedPropositions:tn().default(!1),defaultPersonalizationEnabled:tn(),decisionContext:sn({})}).default({sendDisplayEvent:!0}),datasetId:cn(),mergeId:cn(),edgeConfigOverrides:un,advertising:sn({handleAdvertisingData:ln(Rn,Ln,Mn).default(Rn)})}).required().noUnknownFields()(e))({options:e}),run:n=>{const{xdm:r,data:o,documentUnloading:i,type:a,mergeId:s,datasetId:c,edgeConfigOverrides:l,...d}=n,u=e.createEvent();return i&&u.documentMayUnload(),u.setUserXdm(r),u.setUserData(o),a&&u.mergeXdm({eventType:a}),s&&u.mergeXdm({eventMergeId:s}),l&&(d.edgeConfigOverrides=l),c&&(t.warn("The 'datasetId' option has been deprecated. Please use 'edgeConfigOverrides.com_adobe_experience_platform.datasets.event.datasetId' instead."),d.edgeConfigOverrides=l||{},Z(d.edgeConfigOverrides,{com_adobe_experience_platform:{datasets:{event:{datasetId:c}}}})),e.sendEvent(u,d)}},applyResponse:{documentationUri:"",optionsValidator:e=>(({options:e})=>sn({renderDecisions:tn(),responseHeaders:an(cn().required()),responseBody:sn({handle:en(sn({type:cn().required(),payload:Zt().required()})).required()}).required(),personalization:sn({sendDisplayEvent:tn().default(!0),decisionContext:sn({})}).default({sendDisplayEvent:!0})}).noUnknownFields()(e))({options:e}),run:t=>{const{renderDecisions:n=!1,decisionContext:r={},responseHeaders:o={},responseBody:i={handle:[]},personalization:a}=t,s=e.createEvent();return e.applyResponse(s,{renderDecisions:n,decisionContext:r,responseHeaders:o,responseBody:i,personalization:a})}}}});Un.namespace="DataCollector";const Fn=(e,t)=>`ID sync ${t?"succeeded":"failed"}: ${e.spec.url}`,jn=sn({thirdPartyCookiesEnabled:tn().default(!0),idMigrationEnabled:tn().default(!0)}),Bn=sn({url:cn().required().nonEmpty(),edgeConfigOverrides:un}).required().noUnknownFields(),$n="ECID",qn=({logger:e})=>new Promise((t,n)=>{if(K(window.adobe)&&K(window.adobe.optIn)){const r=window.adobe.optIn;e.info("Delaying request while waiting for legacy opt-in to let Visitor retrieve ECID from server."),r.fetchPermissions(()=>{r.isApproved([r.Categories.ECID])?(e.info("Received legacy opt-in approval to let Visitor retrieve ECID from server."),t()):n(new Error("Legacy opt-in was declined."))},!0)}else t()}),Vn=({logger:e,orgId:t,awaitVisitorOptIn:n})=>()=>{const r=(e=>{const t=e.Visitor;return le(t)&&le(t.getInstance)&&t})(window);return r?n({logger:e}).then(()=>(e.info("Delaying request while using Visitor to retrieve ECID from server."),new Promise(n=>{r.getInstance(t,{}).getMarketingCloudVisitorID(t=>{e.info("Resuming previously delayed request that was waiting for ECID from Visitor."),n(t)},!0)}))).catch(t=>{t?e.info(`${t.message}, retrieving ECID from experience edge`):e.info("An error occurred while obtaining the ECID from Visitor.")}):Promise.resolve()},zn="CORE",Jn=e=>{try{return decodeURIComponent(e)}catch{return""}},Hn=(e,t)=>{e.addIdentity($n,{id:t})},Gn=e=>e.getPayloadsByType("identity:result").reduce((e,t)=>(t.namespace&&t.namespace.code&&(e[t.namespace.code]=t.id),e),{}),Xn=({payload:e,datastreamIdOverride:t})=>fn({payload:e,datastreamIdOverride:t,getAction:()=>"identity/acquire",getUseSendBeacon:()=>!1}),Wn=e=>{const t={query:{identity:{fetch:e}}};return mn({content:t,addIdentity:pn(t),hasIdentity:hn(t)})},Yn=/^([^?#]*)(\??[^#]*)(#?.*)$/,Kn=sn({namespaces:en(ln($n,zn)).nonEmpty().uniqueItems().default([$n]),edgeConfigOverrides:un}).noUnknownFields().default({namespaces:[$n]}),Qn=({config:e,logger:t,consent:n,fireReferrerHideableImage:r,sendEdgeNetworkRequest:o,apexDomain:i,getBrowser:a,identity:s})=>{const{orgId:c,thirdPartyCookiesEnabled:l,edgeConfigOverrides:d}=e,u=(({config:e,getEcidFromVisitor:t,apexDomain:n,isPageSsl:r,cookieJar:o})=>{const{idMigrationEnabled:i,orgId:a}=e,s=`AMCV_${a}`,c=()=>{let e=null;const t=o.get("s_ecid")||o.get(s);if(t){const n=/(^|\|)MCMID\|(\d+)($|\|)/,r=t.match(n);r&&(e=r[2])}return e};return{getEcid(){if(i){const e=c();return e?Promise.resolve(e):t()}return Promise.resolve()},setEcid(e){if(i&&c()!==e){const t=r?{sameSite:"none",secure:!0}:{};o.set(s,`MCMID|${e}`,{domain:n,expires:390,...t})}}}})({config:e,getEcidFromVisitor:Vn({logger:t,orgId:c,awaitVisitorOptIn:qn}),apexDomain:i,cookieJar:te({logger:t,cookieJar:W}),isPageSsl:"https:"===window.location.protocol}),p=He({orgId:c}),f=(({sendEdgeNetworkRequest:e,createIdentityRequestPayload:t,createIdentityRequest:n,globalConfigOverrides:r})=>({namespaces:o,edgeConfigOverrides:i}={})=>{const a=vn({payload:t(o),globalConfigOverrides:r,localConfigOverrides:i}),s=n(a);return e({request:s})})({sendEdgeNetworkRequest:o,createIdentityRequestPayload:Wn,createIdentityRequest:Xn,globalConfigOverrides:d}),g=Je({getBrowser:a}),m=(({thirdPartyCookiesEnabled:e,areThirdPartyCookiesSupportedByDefault:t})=>n=>{e&&t()&&n.setUseIdThirdPartyDomain()})({thirdPartyCookiesEnabled:l,areThirdPartyCookiesSupportedByDefault:g}),h=(({getLegacyEcid:e,addEcidToPayload:t})=>n=>n.hasIdentity($n)?Promise.resolve():e().then(e=>{e&&t(n,e)}))({getLegacyEcid:u.getEcid,addEcidToPayload:Hn}),y=(({locationSearch:e,dateProvider:t,orgId:n,logger:r})=>o=>{if(o.hasIdentity($n))return;let i=rt.parse(e).adobe_mc;if(void 0===i)return;Array.isArray(i)&&(r.warn("Found multiple adobe_mc query string paramters, only using the last one."),i=i[i.length-1]);const a=i.split("|").reduce((e,t)=>{const[n,r]=t.split("=");return e[n]=Jn(r),e[n]=e[n].replace(/[^a-zA-Z0-9@.]/g,""),e},{}),s=parseInt(a.TS,10),c=a.MCMID,l=Jn(a.MCORGID);t().getTime()/1e3<=s+300&&l===n&&c?(r.info(`Found valid ECID identity ${c} from the adobe_mc query string parameter.`),o.addIdentity($n,{id:c})):r.info("Detected invalid or expired adobe_mc query string parameter.")})({locationSearch:window.document.location.search,dateProvider:()=>new Date,orgId:c,logger:t}),v=(({doesIdentityCookieExist:e,orgId:t,logger:n})=>({onResponse:r,onRequestFailure:o})=>new Promise((i,a)=>{r(()=>{e()?i():(n.warn(`Identity cookie not found. This could be caused by any of the following issues:\n\t* The org ID ${t} configured in Alloy doesn't match the org ID specified in the edge configuration.\n\t* Experience edge was not able to set the identity cookie due to domain or cookie restrictions.\n\t* The request was canceled by the browser and not fully processed.`),a(new Error("Identity cookie not found.")))}),o(()=>{e()?i():a(new Error("Identity cookie not found."))})}))({doesIdentityCookieExist:p,orgId:c,logger:t}),w=(({doesIdentityCookieExist:e,setDomainForInitialIdentityPayload:t,addLegacyEcidToPayload:n,awaitIdentityCookie:r,logger:o})=>{let i;const a=e=>(t(e),n(e.getPayload()));return({request:t,onResponse:n,onRequestFailure:s})=>{if(e())return t.setIsIdentityEstablished(),Promise.resolve();if(i){o.info("Delaying request while retrieving ECID from server.");const e=i;return i=e.catch(()=>r({onResponse:n,onRequestFailure:s})),i.catch(()=>{}),e.then(()=>{o.info("Resuming previously delayed request."),t.setIsIdentityEstablished()}).catch(()=>a(t))}return i=r({onResponse:n,onRequestFailure:s}),i.catch(()=>{}),a(t)}})({doesIdentityCookieExist:p,setDomainForInitialIdentityPayload:m,addLegacyEcidToPayload:h,awaitIdentityCookie:v,logger:t}),b=(({fireReferrerHideableImage:e,logger:t})=>n=>{const r=n.filter(e=>"url"===e.type);return r.length?Promise.all(r.map(n=>e(n.spec).then(()=>{t.info(Fn(n,!0))}).catch(()=>{t.error(Fn(n,!1))}))).then(Ze):Promise.resolve()})({fireReferrerHideableImage:r,logger:t}),E=(({processIdSyncs:e})=>t=>e(t.getPayloadsByType("identity:exchange")))({processIdSyncs:b}),I=(({dateProvider:e,orgId:t})=>(n,r)=>{const o=Math.round(e().getTime()/1e3),i=encodeURIComponent(`TS=${o}|MCMID=${n}|MCORGID=${encodeURIComponent(t)}`),[,a,s,c]=r.match(Yn),l=(e=>""===e?"?":"?"===e?"":"&")(s);return`${a}${s}${l}adobe_mc=${i}${c}`})({dateProvider:()=>new Date,orgId:c,globalConfigOverrides:d}),S=(({thirdPartyCookiesEnabled:e})=>t=>{const n=Kn(t);if(!e&&n.namespaces.includes(zn))throw new Error(`namespaces: The ${zn} namespace cannot be requested when third-party cookies are disabled.`);return n})({thirdPartyCookiesEnabled:l}),C=(({thirdPartyCookiesEnabled:e,areThirdPartyCookiesSupportedByDefault:t})=>{const n={identity:{fetch:[$n]}};return e&&t()&&n.identity.fetch.push(zn),e=>{e.mergeQuery(n)}})({thirdPartyCookiesEnabled:l,areThirdPartyCookiesSupportedByDefault:g});return(({addEcidQueryToPayload:e,addQueryStringIdentityToPayload:t,ensureSingleIdentity:n,setLegacyEcid:r,handleResponseForIdSyncs:o,getNamespacesFromResponse:i,getIdentity:a,consent:s,appendIdentityToUrl:c,logger:l,identity:d,getIdentityOptionsValidator:u})=>{let p,f={};return{lifecycle:{onBeforeRequest:({request:r,onResponse:o,onRequestFailure:i})=>(e(r.getPayload()),t(r.getPayload()),n({request:r,onResponse:o,onRequestFailure:i})),onResponse({response:e}){const t=i(e);return p&&p[$n]||!t||!t[$n]||r(t[$n]),t&&Object.keys(t).length>0&&(p={...p,...t}),f={...f,...e.getEdge()},d.setIdentityAcquired(),o(e)}},commands:{getIdentity:{optionsValidator:u,run:e=>{const{namespaces:t}=e;return s.awaitConsent().then(()=>{if(p)return;const n=d.getEcidFromCookie();return n&&t.includes($n)&&(p||(p={}),p[$n]=n,1===t.length)?void 0:a(e)}).then(()=>({identity:t.reduce((e,t)=>(e[t]=p[t]||null,e),{}),edge:f}))}},appendIdentityToUrl:{optionsValidator:Bn,run:e=>s.withConsent().then(()=>{if(p)return;const t=d.getEcidFromCookie();return t?(p||(p={}),void(p[$n]=t)):a(e)}).then(()=>({url:c(p[$n],e.url)})).catch(t=>(l.warn(`Unable to append identity to url. ${t.message}`),e))}}}})({addEcidQueryToPayload:C,addQueryStringIdentityToPayload:y,ensureSingleIdentity:w,setLegacyEcid:u.setEcid,handleResponseForIdSyncs:E,getNamespacesFromResponse:Gn,getIdentity:f,consent:n,identity:s,appendIdentityToUrl:I,logger:t,config:e,getIdentityOptionsValidator:S})};Qn.namespace="Identity",Qn.configValidators=jn;const Zn="configure",er="setDebug",tr=({config:e,componentRegistry:t})=>{const n=[...t.getCommandNames(),Zn,er].sort(),r={...e};Object.keys(e).forEach(t=>{const n=e[t];"function"==typeof n&&(r[t]=n.toString())});const o=t.getComponentNames();return{version:En,configs:r,commands:n,components:o}},nr=({config:e,componentRegistry:t})=>({commands:{getLibraryInfo:{run:()=>({libraryInfo:tr({config:e,componentRegistry:t})})}}});nr.namespace="LibraryInfo";const rr=Xe(window),{console:or,fetch:ir,navigator:ar}=window,sr=(sn({debugEnabled:tn().default(!1),datastreamId:cn().unique().required(),edgeDomain:cn().domain().default("edge.adobedc.net"),edgeBasePath:cn().nonEmpty().default("ee"),orgId:cn().unique().required(),onBeforeEventSend:nn().default(Ze),edgeConfigOverrides:un}).renamed("edgeConfigId",cn().unique(),"datastreamId"),((e,t)=>{let n="";const r=e.location.hostname.toLowerCase().split(".");let o=1;for(;o<r.length&&!t.get(Pe);)o+=1,n=_e(r,o).join("."),t.set(Pe,Pe,{domain:n});t.remove(Pe,{domain:n})})(window,W),(({fetch:e})=>{})({fetch:ir}),(({appendNode:e=re,awaitSelector:t=Ie,createNode:n=oe,fireImage:r=ce}={})=>{const o=r;let i;const a=({src:o})=>t("BODY").then(([t])=>i||(i=n("IFRAME",Ne,Ae),e(t,i))).then(e=>{const t=e.contentWindow.document;return r({src:o,currentDocument:t})})})(),(({window:e,createNamespacedStorage:t})=>{const n=t("validation.")})({window,createNamespacedStorage:rr}),(({userAgent:e})=>{Ve(()=>((e,t)=>{const n=Object.keys(e);for(let r=0;r<n.length;r+=1){const o=n[r];if(e[o].test(t))return o}return qe})({[Ue]:/Edge\/([0-9\._]+)/,[Fe]:/Edg\/([0-9\.]+)/,[Me]:/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/,[je]:/Firefox\/([0-9\.]+)(?:\s|$)/,[Be]:/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/,[$e]:/Version\/([0-9\._]+).*Safari/},e))})({userAgent:window.navigator.userAgent}),({eventManager:e,lifecycle:t,handleError:n})=>{const r=(({eventManager:e,lifecycle:t,handleError:n})=>r=>{if(r.s_fe)return Promise.resolve();const o="composedPath"in r&&r.composedPath().length>0?r.composedPath()[0]:r.target,i=e.createEvent();return i.documentMayUnload(),t.onClick({event:i,clickedElement:o}).then(()=>i.isEmpty()?Promise.resolve():e.sendEvent(i)).then(Ze).catch(e=>{n(e,"click collection")})})({eventManager:e,lifecycle:t,handleError:n});document.addEventListener("click",r,!0)}),cr="\\.(exe|zip|wav|mp3|mov|mpg|avi|wmv|pdf|doc|docx|xls|xlsx|ppt|pptx)$",lr=cn().regexp().default(cr),dr=sn({clickCollectionEnabled:tn().default(!0),clickCollection:sn({internalLinkEnabled:tn().default(!0),externalLinkEnabled:tn().default(!0),downloadLinkEnabled:tn().default(!0),sessionStorageEnabled:tn().default(!1),eventGroupingEnabled:tn().default(!1),filterClickProperties:nn()}).default({internalLinkEnabled:!0,externalLinkEnabled:!0,downloadLinkEnabled:!0,sessionStorageEnabled:!1,eventGroupingEnabled:!1}),downloadLinkQualifier:lr,onBeforeLinkClickSend:nn().deprecated('The field "onBeforeLinkClickSend" has been deprecated. Use "clickCollection.filterClickDetails" instead.')}),ur=(e=document)=>null!==e.getElementById("cppXYctnr"),pr=e=>{let t=e;/^https?:\/\//i.test(t)||(t=`${window.location.protocol}//${e}`);return new URL(t).hostname},fr=({config:e,logger:t,getClickedElementProperties:n,clickActivityStorage:r})=>{const{clickCollectionEnabled:o,clickCollection:i}=e;return o?({event:o,clickedElement:a})=>{const s=n({clickActivityStorage:r,clickedElement:a,config:e,logger:t}),c=s.linkType;var l,d;ur()||(s.isValidLink()&&((e,t)=>t&&("download"===t&&!e.downloadLinkEnabled||"exit"===t&&!e.externalLinkEnabled||"other"===t&&!e.internalLinkEnabled))(i,c)?t.info(`Cancelling link click event due to clickCollection.${c}LinkEnabled = false.`):s.isInternalLink()&&i.eventGroupingEnabled&&(!e.onBeforeLinkClickSend||i.filterClickDetails)&&(l=window.location.hostname,d=s.linkUrl,pr(l)===pr(d))?r.save(s.properties):s.isValidLink()?(o.mergeXdm(s.xdm),o.mergeData(s.data),r.save({pageName:s.pageName,pageIDType:s.pageIDType})):s.isValidActivityMapData()&&r.save(s.properties))}:()=>{}},gr=({properties:e,logger:t}={})=>{let n=e||{};return{get pageName(){return n.pageName},set pageName(e){n.pageName=e},get linkName(){return n.linkName},set linkName(e){n.linkName=e},get linkRegion(){return n.linkRegion},set linkRegion(e){n.linkRegion=e},get linkType(){return n.linkType},set linkType(e){n.linkType=e},get linkUrl(){return n.linkUrl},set linkUrl(e){n.linkUrl=e},get pageIDType(){return n.pageIDType},set pageIDType(e){n.pageIDType=e},get clickedElement(){return n.clickedElement},set clickedElement(e){n.clickedElement=e},get properties(){return{pageName:n.pageName,linkName:n.linkName,linkRegion:n.linkRegion,linkType:n.linkType,linkUrl:n.linkUrl,pageIDType:n.pageIDType}},isValidLink:()=>!!(n.linkUrl&&n.linkType&&n.linkName&&n.linkRegion),isInternalLink(){return this.isValidLink()&&"other"===n.linkType},isValidActivityMapData:()=>!!n.pageName&&!!n.linkName&&!!n.linkRegion&&void 0!==n.pageIDType,get xdm(){return n.filteredXdm?n.filteredXdm:(e=>({eventType:"web.webinteraction.linkClicks",web:{webInteraction:{name:e.linkName,region:e.linkRegion,type:e.linkType,URL:e.linkUrl,linkClicks:{value:1}}}}))(this)},get data(){return n.filteredData?n.filteredData:(e=>({__adobe:{analytics:{contextData:{a:{activitymap:{page:e.pageName,link:e.linkName,region:e.linkRegion,pageIDType:e.pageIDType}}}}}}))(this)},applyPropertyFilter(e){e&&!1===e(n)&&(t&&t.info(`Clicked element properties were rejected by filter function: ${JSON.stringify(this.properties,null,2)}`),n={})},applyOptionsFilter(e){const r=this.options;if(r&&r.clickedElement&&(r.xdm||r.data)){if(e&&!1===e(r))return t&&t.info(`Clicked element properties were rejected by filter function: ${JSON.stringify(this.properties,null,2)}`),void(this.options=void 0);this.options=r,n.filteredXdm=r.xdm,n.filteredData=r.data}},get options(){const e={};if(this.isValidLink()&&(e.xdm=this.xdm),this.isValidActivityMapData()&&(e.data=this.data),this.clickedElement&&(e.clickedElement=this.clickedElement),e.xdm||e.data)return e},set options(e){n={},e&&((e,t)=>{const{xdm:n,data:r,clickedElement:o}=e;if(t.clickedElement=o,n&&n.web&&n.web.webInteraction){const{name:e,region:r,type:o,URL:i}=n.web.webInteraction;t.linkName=e,t.linkRegion=r,t.linkType=o,t.linkUrl=i}if(r&&r.__adobe&&r.__adobe.analytics){const{contextData:e}=r.__adobe.analytics;if(e&&e.a&&e.a.activitymap){const{page:n,link:r,region:o,pageIDType:i}=e.a.activitymap;t.pageName=n||t.pageName,t.linkName=r||t.linkName,t.linkRegion=o||t.linkRegion,void 0!==i&&(t.pageIDType=i)}}})(e,n)}}},mr="clickData",hr=e=>e&&e.replace(/\s+/g," ").trim(),yr=/^(SCRIPT|STYLE|LINK|CANVAS|NOSCRIPT|#COMMENT)$/i,vr=e=>{let t=[],n=!1;if((e=>!(e&&e.nodeName&&e.nodeName.match(yr)))(e)){if(t.push(e),e.childNodes){Array.prototype.slice.call(e.childNodes).forEach(e=>{const r=vr(e);t=t.concat(r.supportedNodes),n=n||r.includesUnsupportedNodes})}}else n=!0;return{supportedNodes:t,includesUnsupportedNodes:n}},wr=(e,t,n)=>{let r;return n&&n!==e.nodeName.toUpperCase()||(r=e.getAttribute(t)),r},br=/^(HEADER|MAIN|FOOTER|NAV)$/i,Er=e=>{let t;return"region"===e.role&&Ke(e["aria-label"])&&(t=e["aria-label"]),t},Ir=e=>{let t;return e&&e.nodeName&&e.nodeName.match(br)&&(t=e.nodeName),t},Sr=e=>!(!e.href||"A"!==e.tagName&&"AREA"!==e.tagName||e.onclick&&e.protocol&&!(e.protocol.toLowerCase().indexOf("javascript")<0)),Cr=e=>!!e&&!!e.onclick,kr=e=>{if("INPUT"===e.tagName){const t=e.getAttribute("type");if("submit"===t)return!0;if("image"===t&&e.src)return!0}return!1},Tr=e=>"BUTTON"===e.tagName&&"submit"===e.type,Nr=e=>{const t=e.indexOf("?"),n=e.indexOf("#");return t>=0&&(t<n||n<0)?e.substring(0,t):n>=0?e.substring(0,n):e},Ar=(({window:e,getLinkName:t,getLinkRegion:n,getAbsoluteUrlFromAnchorElement:r,findClickableElement:o,determineLinkType:i})=>({clickedElement:a,config:s,logger:c,clickActivityStorage:l})=>{const{onBeforeLinkClickSend:d,clickCollection:u}=s,{filterClickDetails:p}=u,f=gr({logger:c});if(a){const c=o(a);if(c){f.clickedElement=a,f.linkUrl=r(e,c),f.linkType=i(e,s,f.linkUrl,c),f.linkRegion=n(c),f.linkName=t(c),f.pageIDType=0,f.pageName=e.location.href;const o=l.load();o&&o.pageName&&(f.pageName=o.pageName,f.pageIDType=1),p?f.applyPropertyFilter(p):d&&f.applyOptionsFilter(d)}}return f})({window,getLinkName:e=>{let t=hr(e.innerText||e.textContent);const n=vr(e);if(!t||n.includesUnsupportedNodes){const e=(e=>{const t={texts:[]};return e.supportedNodes.forEach(e=>{e.getAttribute&&(t.alt||(t.alt=hr(e.getAttribute("alt"))),t.title||(t.title=hr(e.getAttribute("title"))),t.inputValue||(t.inputValue=hr(wr(e,"value","INPUT"))),t.imgSrc||(t.imgSrc=hr(wr(e,"src","IMG")))),e.nodeValue&&t.texts.push(e.nodeValue)}),t})(n);t=hr(e.texts.join("")),t||(t=e.alt||e.title||e.inputValue||e.imgSrc)}return t||""},getLinkRegion:e=>{let t,n=e.parentNode;for(;n;){if(t=hr(n.id||Er(n)||Ir(n)),t)return t;n=n.parentNode}return"BODY"},getAbsoluteUrlFromAnchorElement:(e,t)=>{const n=e.location.href;let r=t.href||"";"string"!=typeof r&&(r="");try{return new URL(r,n).href}catch{return n}},findClickableElement:e=>{let t=e;for(;t&&(!t.nodeName||"BODY"!==t.nodeName);){if(Sr(t)||Cr(t)||kr(t)||Tr(t))return t;t=t.parentNode}return null},determineLinkType:(e,t,n,r)=>{let o="other";return Ke(n)&&(((e,t,n)=>{let r=!1;if(t)if(n&&n.download)r=!0;else if(e){const n=new RegExp(e),o=Nr(t).toLowerCase();r=n.test(o)}return r})(t.downloadLinkQualifier,n,r)?o="download":((e,t)=>{let n=!1;if(t&&e.location.hostname){const r=e.location.hostname.toLowerCase();n=Nr(t).toLowerCase().indexOf(r)<0}return n})(e,n)&&(o="exit")),o}});let Dr;const Or=e=>{if(!Dr){const t=Xe(window)(e.orgId||""),n=(()=>{const e={};return{getItem:t=>e[t],setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}})(),r=e.clickCollection.sessionStorageEnabled?t.session:n;Dr=(({storage:e})=>({save:t=>{const n=JSON.stringify(t);e.setItem(mr,n)},load:()=>{let t=null;const n=e.getItem(mr);return n&&(t=JSON.parse(n)),t},remove:()=>{e.removeItem(mr)}}))({storage:r})}},_r=({config:e,eventManager:t,handleError:n,logger:r})=>{((e,t)=>{const{clickCollectionEnabled:n,onBeforeLinkClickSend:r,downloadLinkQualifier:o}=e;!1===n&&(r&&t.warn("The 'onBeforeLinkClickSend' configuration was provided but will be ignored because clickCollectionEnabled is false."),o&&o!==cr&&t.warn("The 'downloadLinkQualifier' configuration was provided but will be ignored because clickCollectionEnabled is false."))})(e,r);const o=e.clickCollection;Dr||Or(e);const i=fr({config:e,logger:r,clickActivityStorage:Dr,getClickedElementProperties:Ar}),a=(({clickActivityStorage:e})=>t=>{if(ur())return;const n=e.load(),r=gr({properties:n});if(r.isValidLink()||r.isValidActivityMapData()){if(r.isValidLink()){const e=r.xdm;delete e.eventType,t.mergeXdm(e)}r.isValidActivityMapData()&&t.mergeData(r.data),e.save({pageName:r.pageName,pageIDType:r.pageIDType})}})({clickActivityStorage:Dr}),s=(({clickActivityStorage:e})=>t=>{e.save({pageName:t.getContent().xdm.web.webPageDetails.name,pageIDType:1})})({clickActivityStorage:Dr});return{lifecycle:{onComponentsRegistered(e){const{lifecycle:r}=e;sr({eventManager:t,lifecycle:r,handleError:n})},onClick({event:e,clickedElement:t}){i({event:e,clickedElement:t})},onBeforeEvent({event:e}){(e=>{const t=e.getContent();return void 0!==t.xdm&&void 0!==t.xdm.web&&void 0!==t.xdm.web.webPageDetails&&void 0!==t.xdm.web.webPageDetails.name})(e)&&(o.eventGroupingEnabled&&a(e),s(e,r,Dr))}}}};_r.namespace="ActivityCollector",_r.configValidators=dr,_r.buildOnInstanceConfiguredExtraParams=({config:e,logger:t})=>(Dr||Or(e),{getLinkDetails:n=>Ar({clickActivityStorage:Dr,clickedElement:n,config:e,logger:t}).properties});const Pr=({fireReferrerHideableImage:e,logger:t,cookieJar:n,isPageSsl:r})=>{const o=r?{sameSite:"none",secure:!0}:{};return r=>((e=>{e.filter(e=>"cookie"===e.type).forEach(e=>{const{name:t,value:r,domain:i,ttlDays:a}=e.spec;n.set(t,r||"",{domain:i||"",expires:a||10,...o})})})(r),(n=>{const r=n.filter(e=>"url"===e.type);return Promise.all(r.map(n=>e(n.spec).then(()=>{t.info((e=>`URL destination ${!0?"succeeded":"failed"}: ${e.spec.url}`)(n))}).catch(()=>{}))).then(Ze)})(r))},xr=({processDestinations:e})=>({response:t})=>(({response:t})=>{const n=t.getPayloadsByType("activation:push");return e(n)})({response:t}).then(()=>(({response:e})=>({destinations:e.getPayloadsByType("activation:pull")}))({response:t})),Rr=({logger:e,fireReferrerHideableImage:t})=>{const n=W.withConverter({write:e=>encodeURIComponent(e)}),r=te({logger:e,cookieJar:n}),o=Pr({fireReferrerHideableImage:t,logger:e,cookieJar:r,isPageSsl:"https:"===window.location.protocol});return{lifecycle:{onResponse:xr({processDestinations:o})},commands:{}}};Rr.namespace="Audiences";const Lr="general",Mr=({standard:e,version:t})=>`${e}.${t}`,Ur=({storage:e})=>({clear(){e.clear()},lookup(t){const n={},r=e=>{const t=Mr(e),{standard:r,version:o,...i}=e;var a;return n[t]||(n[t]=(a=i,De(JSON.stringify(it(a)))).toString()),n[t]};return{isNew:()=>t.some(t=>{const n=Mr(t),o=e.getItem(n);return null===o||o!==r(t)}),save(){t.forEach(t=>{const n=Mr(t);e.setItem(n,r(t))})}}}}),Fr=()=>{const e={};return{...mn({content:e,addIdentity:(t,n)=>{e.identityMap=e.identityMap||{},e.identityMap[t]=e.identityMap[t]||[],e.identityMap[t].push(n)},hasIdentity:t=>void 0!==(e.identityMap&&e.identityMap[t])}),setConsent:t=>{e.consent=t}}},jr=({payload:e,datastreamIdOverride:t})=>fn({payload:e,datastreamIdOverride:t,getAction:()=>"privacy/set-consent",getUseSendBeacon:()=>!1}),Br=e=>e.split(";").reduce((e,t)=>{const[n,r]=t.split("=");return e[n]=r,e},{}),$r=sn({consent:en(Zt()).required().nonEmpty(),identityMap:dn,edgeConfigOverrides:un}).noUnknownFields().required(),qr=sn({defaultConsent:ln("in","out","pending").default("in")}),Vr=({config:e,consent:t,sendEdgeNetworkRequest:n,createNamespacedStorage:r})=>{const{orgId:o,defaultConsent:i}=e,a=(({parseConsentCookie:e,orgId:t,cookieJar:n})=>{const r=Re(t,"consent");return{read(){const t=n.get(r);return t?e(t):{}},clear(){n.remove(r)}}})({parseConsentCookie:Br,orgId:o,cookieJar:W}),s=(()=>{let e=0,t=Promise.resolve();return{addTask(n){e+=1;const r=()=>n().finally(()=>{e-=1});return t=t.then(r,r),t},get length(){return e}}})(),c=(({createConsentRequestPayload:e,createConsentRequest:t,sendEdgeNetworkRequest:n,edgeConfigOverrides:r})=>({consentOptions:o,identityMap:i,edgeConfigOverrides:a})=>{const s=vn({payload:e(),globalConfigOverrides:r,localConfigOverrides:a});s.payload.setConsent(o),K(i)&&Object.keys(i).forEach(e=>{i[e].forEach(t=>{s.payload.addIdentity(e,t)})});const c=t(s);return n({request:c}).then(()=>{})})({createConsentRequestPayload:Fr,createConsentRequest:jr,sendEdgeNetworkRequest:n,edgeConfigOverrides:e.edgeConfigOverrides}),l=r(`${xe(o)}.consentHashes.`),d=Ur({storage:l.persistent}),u=He({orgId:o});return(({storedConsent:e,taskQueue:t,defaultConsent:n,consent:r,sendSetConsentRequest:o,validateSetConsentOptions:i,consentHashStore:a,doesIdentityCookieExist:s})=>{const c={[Lr]:n};let l=e.read();const d=s(),u=void 0!==l[Lr];d&&u||a.clear(),d||(e.clear(),l={}),r.initializeConsent(c,l);const p=()=>{if(0===t.length){const t=e.read();void 0!==t[Lr]&&r.setConsent(t)}};return{commands:{setConsent:{optionsValidator:i,run:({consent:e,identityMap:n,edgeConfigOverrides:i})=>{r.suspend();const s=a.lookup(e);return t.addTask(()=>s.isNew()?o({consentOptions:e,identityMap:n,edgeConfigOverrides:i}):Promise.resolve()).then(()=>s.save()).finally(p)}}},lifecycle:{onResponse:p,onRequestFailure:p}}})({storedConsent:a,taskQueue:s,defaultConsent:i,consent:t,sendSetConsentRequest:c,validateSetConsentOptions:$r,consentHashStore:d,doesIdentityCookieExist:u})};Vr.namespace="Consent",Vr.configValidators=qr;const zr=()=>({eventMergeId:ft()}),Jr=()=>(({createEventMergeId:e})=>({commands:{createEventMergeId:{run:e}}}))({createEventMergeId:zr});Jr.namespace="EventMerge";const Hr={PAUSE:"media.pauseStart",PLAY:"media.play",BUFFER_START:"media.bufferStart",AD_START:"media.adStart",Ad_BREAK_START:"media.adBreakStart",SESSION_END:"media.sessionEnd",SESSION_START:"media.sessionStart",SESSION_COMPLETE:"media.sessionComplete",PING:"media.ping",AD_BREAK_COMPLETE:"media.adBreakComplete",AD_COMPLETE:"media.adComplete",AD_SKIP:"media.adSkip",BITRATE_CHANGE:"media.bitrateChange",CHAPTER_COMPLETE:"media.chapterComplete",CHAPTER_SKIP:"media.chapterSkip",CHAPTER_START:"media.chapterStart",ERROR:"media.error",STATES_UPDATE:"media.statesUpdate"},Gr=({config:e,eventManager:t,consent:n,sendEdgeNetworkRequest:r,setTimestamp:o})=>({createMediaEvent({options:n}){const r=t.createEvent(),{xdm:i}=n;if(o(i),r.setUserXdm(i),i.eventType===Hr.AD_START){const{advertisingDetails:t}=n.xdm.mediaCollection;r.mergeXdm({mediaCollection:{advertisingDetails:{playerName:t.playerName||e.streamingMedia.playerName}}})}return r},createMediaSession(n){const{playerName:r,channel:o,appVersion:i}=e.streamingMedia,a=t.createEvent(),{sessionDetails:s}=n.xdm.mediaCollection;return a.setUserXdm(n.xdm),a.mergeXdm({eventType:Hr.SESSION_START,mediaCollection:{sessionDetails:{playerName:s.playerName||r,channel:s.channel||o,appVersion:s.appVersion||i}}}),a},augmentMediaEvent({event:e,playerId:t,getPlayerDetails:n,sessionID:r}){if(!t||!n)return e;const{playhead:o,qoeDataDetails:i}=n({playerId:t});return e.mergeXdm({mediaCollection:{playhead:at(o),qoeDataDetails:i,sessionID:r}}),e},trackMediaSession({event:e,mediaOptions:n,edgeConfigOverrides:r}){const o={mediaOptions:n,edgeConfigOverrides:r};return t.sendEvent(e,o)},trackMediaEvent({event:e,action:t}){const o=yn(),i=(({mediaRequestPayload:e,action:t})=>fn({payload:e,edgeSubPath:"/va",getAction:()=>t,getUseSendBeacon:()=>!1}))({mediaRequestPayload:o,action:t});return o.addEvent(e),e.finalize(),n.awaitConsent().then(()=>r({request:i}).then(()=>({})))}}),Xr="main",Wr="completed",Yr=()=>{let e;return{getSession:t=>e[t]||{},storeSession:({playerId:t,sessionDetails:n})=>{void 0===e&&(e={}),e[t]=n},stopPing:({playerId:t})=>{const n=e[t];n&&(clearTimeout(n.pingId),n.pingId=null,n.playbackState=Wr)},savePing:({playerId:t,pingId:n,playbackState:r})=>{e[t]&&(e[t].pingId&&clearTimeout(e[t].pingId),e[t].pingId=n,e[t].playbackState=r)}}},Kr=({mediaEventManager:e,mediaSessionCacheManager:t,config:n})=>{const r=o=>{const i=e.createMediaEvent({options:o}),{playerId:a,xdm:s}=o,{eventType:c}=s,l=c.split(".")[1],{getPlayerDetails:d,sessionPromise:u,playbackState:p}=t.getSession(a);return u.then(o=>o.sessionId?(e.augmentMediaEvent({event:i,eventType:c,playerId:a,getPlayerDetails:d,sessionID:o.sessionId}),e.trackMediaEvent({event:i,action:l}).then(()=>{if(a)if(c===Hr.SESSION_COMPLETE||c===Hr.SESSION_END)t.stopPing({playerId:a});else{const e=((e,t)=>e===Hr.AD_START||e===Hr.Ad_BREAK_START||e===Hr.AD_SKIP||e===Hr.AD_COMPLETE?"ad":e===Hr.AD_BREAK_COMPLETE||e===Hr.CHAPTER_COMPLETE||e===Hr.CHAPTER_START||e===Hr.CHAPTER_SKIP||e===Hr.SESSION_START?"main":e===Hr.SESSION_END||e===Hr.SESSION_COMPLETE?"completed":t)(c,p);if("completed"===e)return;const o="ad"===e?n.streamingMedia.adPingInterval:n.streamingMedia.mainPingInterval,i=setTimeout(()=>{r({playerId:a,xdm:{eventType:Hr.PING}})},1e3*o);t.savePing({playerId:a,pingId:i,playbackState:e})}})):Promise.reject(new Error(`Failed to trigger media event: ${c}. Session ID is not available for playerId: ${a}.`)))};return e=>r(e)},Qr=({config:e,mediaEventManager:t,mediaSessionCacheManager:n,legacy:r=!1})=>o=>{if(!e.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));const{playerId:i,getPlayerDetails:a,edgeConfigOverrides:s}=o,c=t.createMediaSession(o);t.augmentMediaEvent({event:c,playerId:i,getPlayerDetails:a});const l=t.trackMediaSession({event:c,mediaOptions:{playerId:i,getPlayerDetails:a,legacy:r},edgeConfigOverrides:s});return n.storeSession({playerId:i,sessionDetails:{sessionPromise:l,getPlayerDetails:a,playbackState:Xr}}),l},Zr=e=>!Ye(e)||!e.trim(),eo=({mediaSessionCacheManager:e,config:t,trackMediaEvent:n})=>({response:r,playerId:o,getPlayerDetails:i})=>{const a=r.getPayloadsByType("media-analytics:new-session");if(de(a)){const{sessionId:r}=a[0];if(Zr(r))return{};if(!o||!i)return{sessionId:r};const s=setTimeout(()=>{n({playerId:o,xdm:{eventType:Hr.PING}})},1e3*t.streamingMedia.mainPingInterval);return e.savePing({playerId:o,pingId:s,playbackState:Xr}),{sessionId:r}}return{}},to={Video:"video",Audio:"audio"},no={VOD:"vod",Live:"live",Linear:"linear",Podcast:"podcast",Audiobook:"audiobook",AOD:"aod"},ro={FullScreen:"fullScreen",ClosedCaption:"closedCaptioning",Mute:"mute",PictureInPicture:"pictureInPicture",InFocus:"inFocus"},oo={AdBreakStart:"adBreakStart",AdBreakComplete:"adBreakComplete",AdStart:"adStart",AdComplete:"adComplete",AdSkip:"adSkip",ChapterStart:"chapterStart",ChapterComplete:"chapterComplete",ChapterSkip:"chapterSkip",SeekStart:"seekStart",SeekComplete:"seekComplete",BufferStart:"bufferStart",BufferComplete:"bufferComplete",BitrateChange:"bitrateChange",StateStart:"stateStart",StateEnd:"stateEnd"},io="sessionStart",ao="sessionEnd",so="sessionComplete",co="play",lo="pauseStart",uo="error",po="statesUpdate",fo={MediaResumed:"media.resumed",GranularAdTracking:"media.granularadtracking"},go={Show:"a.media.show",Season:"a.media.season",Episode:"a.media.episode",AssetId:"a.media.asset",Genre:"a.media.genre",FirstAirDate:"a.media.airDate",FirstDigitalDate:"a.media.digitalDate",Rating:"a.media.rating",Originator:"a.media.originator",Network:"a.media.network",ShowType:"a.media.type",AdLoad:"a.media.adLoad",MVPD:"a.media.pass.mvpd",Authorized:"a.media.pass.auth",DayPart:"a.media.dayPart",Feed:"a.media.feed",StreamFormat:"a.media.format"},mo={Artist:"a.media.artist",Album:"a.media.album",Label:"a.media.label",Author:"a.media.author",Station:"a.media.station",Publisher:"a.media.publisher"},ho={Advertiser:"a.media.ad.advertiser",CampaignId:"a.media.ad.campaign",CreativeId:"a.media.ad.creative",PlacementId:"a.media.ad.placement",SiteId:"a.media.ad.site",CreativeUrl:"a.media.ad.creativeURL"},yo=({logger:e})=>({createMediaObject:(t,n,r,o,i)=>{const a={friendlyName:t,name:n,length:r,streamType:i,contentType:o},s=sn({friendlyName:cn().nonEmpty(),name:cn().nonEmpty(),length:on().required(),streamType:cn().nonEmpty(),contentType:cn().nonEmpty()});try{const e=s(a);return{sessionDetails:{name:e.name,friendlyName:e.friendlyName,length:Math.round(e.length),streamType:e.streamType,contentType:e.contentType}}}catch(t){return e.warn("An error occurred while creating the Media Object.",t),{}}},createAdBreakObject:(t,n,r)=>{const o={friendlyName:t,offset:n,index:r},i=sn({friendlyName:cn().nonEmpty(),offset:on(),index:on()});try{const e=i(o);return{advertisingPodDetails:{friendlyName:e.friendlyName,offset:e.offset,index:e.index}}}catch(t){return e.warn("An error occurred while creating the Ad Break Object.",t),{}}},createAdObject:(t,n,r,o)=>{const i={friendlyName:t,name:n,podPosition:r,length:o},a=sn({friendlyName:cn().nonEmpty(),name:cn().nonEmpty(),podPosition:on(),length:on()});try{const e=a(i);return{advertisingDetails:{friendlyName:e.friendlyName,name:e.name,podPosition:e.podPosition,length:e.length}}}catch(t){return e.warn("An error occurred while creating the Advertising Object.",t),{}}},createChapterObject:(t,n,r,o)=>{const i={friendlyName:t,offset:n,length:r,index:o},a=sn({friendlyName:cn().nonEmpty(),offset:on(),length:on(),index:on()});try{const e=a(i);return{chapterDetails:{friendlyName:e.friendlyName,offset:e.offset,index:e.index,length:e.length}}}catch(t){return e.warn("An error occurred while creating the Chapter Object.",t),{}}},createStateObject:t=>{const n=cn().matches(/^[a-zA-Z0-9_]{1,64}$/,"This is not a valid state name.");try{return{name:n(t)}}catch(t){return e.warn("An error occurred while creating the State Object.",t),{}}},createQoEObject:(t,n,r,o)=>{const i={bitrate:t,droppedFrames:n,fps:r,startupTime:o},a=sn({bitrate:on(),droppedFrames:on(),fps:on(),startupTime:on()});try{const e=a(i);return{bitrate:e.bitrate,droppedFrames:e.droppedFrames,framesPerSecond:e.fps,timeToStart:e.startupTime}}catch(t){return e.warn("An error occurred while creating the QOE Object.",t),{}}}}),vo={"a.media.show":"show","a.media.season":"season","a.media.episode":"episode","a.media.asset":"assetID","a.media.genre":"genre","a.media.airDate":"firstAirDate","a.media.digitalDate":"firstDigitalDate","a.media.rating":"rating","a.media.originator":"originator","a.media.network":"network","a.media.type":"showType","a.media.adLoad":"adLoad","a.media.pass.mvpd":"mvpd","a.media.pass.auth":"authorized","a.media.dayPart":"dayPart","a.media.feed":"feed","a.media.format":"streamFormat","a.media.artist":"artist","a.media.album":"album","a.media.label":"label","a.media.author":"author","a.media.station":"station","a.media.publisher":"publisher","media.resumed":"hasResume"},wo={"a.media.ad.advertiser":"advertiser","a.media.ad.campaign":"campaignID","a.media.ad.creative":"creativeID","a.media.ad.placement":"placementID","a.media.ad.site":"siteID","a.media.ad.creativeURL":"creativeURL"},bo=({logger:e,trackMediaSession:t,trackMediaEvent:n,uuid:r})=>{let o=null;const i=({eventType:e,mediaDetails:t={},contextData:n=[]})=>{const r=(({eventType:e})=>e===oo.BufferComplete||e===oo.SeekComplete?co:e===oo.StateStart||e===oo.StateEnd?po:e===oo.SeekStart?lo:e)({eventType:e});if(e===oo.StateStart){return{eventType:`media.${r}`,mediaCollection:{statesStart:[t]}}}if(e===oo.StateEnd){return{eventType:`media.${r}`,mediaCollection:{statesEnd:[t]}}}const o={eventType:`media.${r}`,mediaCollection:{...t}},i=[];return Object.keys(n).forEach(e=>{vo[e]?o.mediaCollection.sessionDetails[vo[e]]=n[e]:wo[e]?o.mediaCollection.advertisingDetails[wo[e]]=n[e]:i.push({name:e,value:n[e]})}),de(i)&&(o.mediaCollection.customMetadata=i),o};return{trackSessionStart:(n,a={})=>{if(Y(n)||We(n))return e.warn("Invalid media object"),{};null===o&&(e.warn("The Media Session was completed. Restarting a new session."),o={qoe:null,lastPlayhead:0,playerId:r()});const s=i({eventType:io,mediaDetails:n,contextData:a});return t({playerId:o.playerId,getPlayerDetails:()=>({playhead:o.lastPlayhead,qoeDataDetails:o.qoe}),xdm:s})},trackPlay:()=>{if(null===o)return e.warn("The Media Session was completed."),{};const t=i({eventType:co});return n({playerId:o.playerId,xdm:t})},trackPause:()=>{if(null===o)return e.warn("The Media Session was completed."),{};const t=i({eventType:lo});return n({playerId:o.playerId,xdm:t})},trackSessionEnd:()=>{if(null===o)return e.warn("The Media Session was completed."),{};const t=i({eventType:ao});return n({playerId:o.playerId,xdm:t})},trackComplete:()=>{if(null===o)return e.warn("The Media Session was completed."),{};const t=i({eventType:so});return n({playerId:o.playerId,xdm:t})},trackError:t=>{if(e.warn(`trackError(${t})`),null===o)return e.warn("The Media Session was completed."),{};const r=i({eventType:uo,mediaDetails:{errorDetails:{name:t,source:"player"}}});return n({playerId:o.playerId,xdm:r})},trackEvent:(t,r,a)=>{if(We(r))return e.warn("Invalid media object."),{};if(null===o)return e.warn("The Media Session was completed."),{};if(!Object.values(oo).includes(t))return e.warn("Invalid event type"),{};const s=i({eventType:t,mediaDetails:r,contextData:a});return n({playerId:o.playerId,xdm:s})},updatePlayhead:t=>{null!==o?Qe(t)&&(o.lastPlayhead=parseInt(t,10)):e.warn("The Media Session was completed.")},updateQoEObject:t=>{null!==o?t&&(o.qoe=t):e.warn("The Media Session was completed.")},destroy:()=>{e.warn("Destroy called, destroying the tracker."),o=null}}},Eo=({eventManager:e,sendEdgeNetworkRequest:t,config:n,logger:r,consent:o})=>{const i=Yr(),a=Gr({sendEdgeNetworkRequest:t,config:n,consent:o,eventManager:e,setTimestamp:bn(()=>new Date)}),s=Kr({mediaSessionCacheManager:i,mediaEventManager:a,config:n}),c=Qr({config:n,mediaEventManager:a,mediaSessionCacheManager:i,legacy:!0});return(({trackMediaEvent:e,trackMediaSession:t,mediaResponseHandler:n,logger:r,createMediaHelper:o,createGetInstance:i,config:a})=>({lifecycle:{onBeforeEvent({mediaOptions:e,onResponse:t=Ze}){if(!e)return;const{legacy:r,playerId:o,getPlayerDetails:i}=e;r&&t(({response:e})=>n({playerId:o,getPlayerDetails:i,response:e}))}},commands:{getMediaAnalyticsTracker:{run:()=>{if(!a.streamingMedia)return Promise.reject(new Error("Streaming media is not configured."));r.info("Streaming media is configured in legacy mode.");const n=o({logger:r});return Promise.resolve({getInstance:()=>i({logger:r,trackMediaEvent:e,trackMediaSession:t,uuid:ft}),Event:oo,MediaType:to,PlayerState:ro,StreamType:no,MediaObjectKey:fo,VideoMetadataKeys:go,AudioMetadataKeys:mo,AdMetadataKeys:ho,...n})}}}}))({mediaResponseHandler:eo({mediaSessionCacheManager:i,config:n,trackMediaEvent:s}),trackMediaSession:c,trackMediaEvent:s,createMediaHelper:yo,createGetInstance:bo,logger:r,config:n})};Eo.namespace="Legacy Media Analytics";const Io="web",So="webapp",Co="://",ko=/^(\w+):\/\/([^/#]+)(\/[^#]*)?(#.*)?$/,To=/^(?:.*@)?(?:[a-z\d\u00a1-\uffff.-]+|\[[a-f\d:]+])(?::\d+)?$/,No=/^\/(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})*$/,Ao=/^#(?:[/\w\u00a1-\uffff-.~]|%[a-fA-F\d]{2})+$/,Do=(e="/")=>{let t=e.length;for(;t>0&&-1!=="/".indexOf(e.charAt(t-1));)t-=1;return e.substring(0,t)||"/"},Oo=e=>`${e.surfaceType}${Co}${e.authority}${e.path||""}${e.fragment||""}`,_o=e=>{const t=e(),n=t.host.toLowerCase(),r=t.pathname;return Io+Co+n+Do(r)},Po=(e,t,n)=>{const r=e=>(n.warn(e),null);if(!Ke(e))return r(`Invalid surface: ${e}`);const o=((e,t)=>e.startsWith("#")?_o(t)+e:e)(e,t),i=(e=>{const t=e.match(ko);return t?{surfaceType:(o=t[1],Ke(o)?o.toLowerCase():""),authority:(r=t[2],Ke(r)?r.toLowerCase():""),path:(n=t[3],Ke(n)?Do(n):"/"),fragment:t[4]}:null;var n,r,o})(o);return null===i?r(`Invalid surface: ${e}`):[Io,So].includes(i.surfaceType)?i.authority&&To.test(i.authority)?i.path&&!No.test(i.path)?r(`Invalid path ${i.path} in surface: ${e}`):i.fragment&&!Ao.test(i.fragment)?r(`Invalid fragment ${i.fragment} in surface: ${e}`):i:r(`Invalid authority ${i.authority} in surface: ${e}`):r(`Unsupported surface type ${i.surfaceType} in surface: ${e}`)},xo=e=>!!e&&0===e.indexOf(Io+Co)&&-1===e.indexOf("#"),Ro="__view__",Lo="https://ns.adobe.com/personalization/default-content-item",Mo="https://ns.adobe.com/personalization/dom-action",Uo="https://ns.adobe.com/personalization/html-content-item",Fo="https://ns.adobe.com/personalization/json-content-item",jo="https://ns.adobe.com/personalization/ruleset-item",Bo="https://ns.adobe.com/personalization/redirect-item",$o="https://ns.adobe.com/personalization/message/in-app",qo=e=>e.filter((t,n)=>e.indexOf(t)===n),Vo=({getPageLocation:e,renderDecisions:t,decisionScopes:n,personalization:r,event:o,isCacheInitialized:i,logger:a})=>{const s=o.getViewName();return{isRenderDecisions:()=>t,isSendDisplayEvent:()=>!!r.sendDisplayEvent,shouldIncludeRenderedPropositions:()=>!!r.includeRenderedPropositions,getViewName:()=>s,hasScopes:()=>n.length>0||de(r.decisionScopes),hasSurfaces:()=>de(r.surfaces),hasViewName:()=>Ke(s),createQueryDetails(){const t=[...n];de(r.decisionScopes)&&t.push(...r.decisionScopes);const o=((e=[],t,n)=>e.map(e=>Po(e,t,n)).filter(e=>!Y(e)).map(Oo))(r.surfaces,e,a);this.shouldRequestDefaultPersonalization()&&((e=>{e.includes(Ro)||e.push(Ro)})(t),((e,t)=>{const n=_o(t);e.includes(n)||e.push(n)})(o,e));const i=[Lo,Uo,Fo,Bo,jo,$o,"https://ns.adobe.com/personalization/message/content-card"];return t.includes(Ro)&&i.push(Mo),{schemas:i,decisionScopes:qo(t),surfaces:qo(o)}},isCacheInitialized:()=>i,shouldFetchData(){return this.hasScopes()||this.hasSurfaces()||this.shouldRequestDefaultPersonalization()},shouldUseCachedData(){return this.hasViewName()&&!this.shouldFetchData()},shouldRequestDefaultPersonalization(){return r.defaultPersonalizationEnabled||!this.isCacheInitialized()&&!1!==r.defaultPersonalizationEnabled}}},zo="decisioning.propositionDisplay",Jo="decisioning.propositionInteract",Ho="decisioning.propositionTrigger",Go="decisioning.propositionDismiss",Xo="decisioning.propositionSuppressDisplay",Wo={DISPLAY:"display",INTERACT:"interact",TRIGGER:"trigger",DISMISS:"dismiss",SUPPRESS:"suppressDisplay"},Yo={[zo]:Wo.DISPLAY,[Jo]:Wo.INTERACT,[Ho]:Wo.TRIGGER,[Go]:Wo.DISMISS,[Xo]:Wo.SUPPRESS},Ko={[Wo.DISPLAY]:zo,[Wo.INTERACT]:Jo,[Wo.TRIGGER]:Ho,[Wo.DISMISS]:Go,[Wo.SUPPRESS]:Xo},Qo=e=>Yo[e],Zo=e=>Ko[e],ei={propositions:[]},ti=({getPageLocation:e,logger:t,fetchDataHandler:n,viewChangeHandler:r,onClickHandler:o,isAuthoringModeEnabled:i,mergeQuery:a,viewCache:s,showContainers:c,applyPropositions:l,setTargetMigration:d,mergeDecisionsMeta:u,renderedPropositions:p,onDecisionHandler:f,handleConsentFlicker:g})=>({lifecycle:{onComponentsRegistered(){g()},onDecision:f,onBeforeRequest:({request:e})=>(d(e),Promise.resolve()),onBeforeEvent({event:o,renderDecisions:l,decisionScopes:d=[],personalization:f={},onResponse:g=Ze,onRequestFailure:m=Ze}){if(g(()=>({propositions:[]})),m(()=>c()),i())return t.warn("Rendering is disabled for authoring mode."),a(o,{enabled:!1}),Promise.resolve();const h=Vo({getPageLocation:e,renderDecisions:l,decisionScopes:d,personalization:f,event:o,isCacheInitialized:s.isInitialized(),logger:t}),y=[];if(h.shouldIncludeRenderedPropositions()&&y.push(p.clear()),h.shouldFetchData()){const e=s.createCacheUpdate(h.getViewName());m(()=>e.cancel()),n({cacheUpdate:e,personalizationDetails:h,event:o,onResponse:g})}else h.shouldUseCachedData()&&y.push(r({personalizationDetails:h,event:o,onResponse:g,onRequestFailure:m}));return Promise.all(y).then(e=>{const t=e.flatMap(e=>e);de(t)&&u(o,t,[Wo.DISPLAY])})},onClick({event:e,clickedElement:t}){o({event:e,clickedElement:t})}},commands:{applyPropositions:{optionsValidator:e=>(({logger:e,options:t})=>{const n=sn({propositions:en(sn({id:cn().required(),scope:cn().required(),scopeDetails:sn({decisionProvider:cn().required()}).required(),items:en(sn({id:cn().required(),schema:cn().required(),data:sn(Zt())})).nonEmpty().required()}).required()).nonEmpty().required(),metadata:sn(Zt()),viewName:cn()}).required();try{return n(t)}catch(t){return e.warn("Invalid options for applyPropositions. No propositions will be applied.",t),ei}})({logger:t,options:e}),run:l}}}),ni=(e="undefined")=>oe("DIV",{},{innerHTML:e}),ri=/:eq\((\d+)\)/g,oi=e=>-1===e.indexOf(":eq("),ii=/(#|\.)(-?\w+)/g,ai=(e,t,n)=>`${t}${CSS.escape(n)}`,si=e=>{const t=[],n=(e=>e.split(ri).filter(Ke))((e=>e.replace(ii,ai))(e.trim())),{length:r}=n;let o=0;for(;o<r;){const e=n[o],r=n[o+1];r?t.push({sel:e,eq:Number(r)}):t.push({sel:e}),o+=2}return t},ci=e=>{const t=document;if(oi(e))return ye(e,t);const n=si(e),{length:r}=n;let o=[],i=t,a=0;for(;a<r;){const{sel:e,eq:t}=n[a],s=ye(e,i),{length:c}=s;if(0===c)break;if(null!=t&&t>c-1)break;a<r-1&&(null==t?[i]=s:i=s[t]),a===r-1&&(o=null==t?s:[s[t]]),a+=1}return o},li=(e,t=document)=>t.getElementById(e),di=(e,t,n)=>{e.setAttribute(t,n)},ui=(e,t)=>e.getAttribute(t),pi=(e,t,n,r)=>{let o;o=r?`${t}:${n} !${r};`:`${t}:${n};`,e.style.cssText+=`;${o}`},fi=e=>e.parentNode,gi=(e,t)=>{if(!e)return;const n=fi(e);n&&n.insertBefore(t,(e=>e.nextElementSibling)(e))},mi=(e,t)=>{if(!e)return;const n=fi(e);n&&n.insertBefore(t,e)},hi=e=>{const{childNodes:t}=e;return t?ue(t):[]},yi=e=>e.firstElementChild;let vi;const wi=(e=document)=>{if(void 0===vi){const t=e.querySelector("[nonce]");vi=t&&(t.nonce||t.getAttribute("nonce"))}return vi},bi="src",Ei=e=>oe(ie,{src:e}),Ii=e=>{ye(ie,e).forEach(e=>{const t=ui(e,bi);t&&Ei(t)})},Si=e=>((e,t)=>e.tagName===t)(e,ae)&&!ui(e,bi),Ci=e=>{const t=ye(ae,e),{length:n}=t,r=wi();if(r)for(let e=0;e<n;e+=1){const n=t[e];Si(n)&&(n.nonce=r)}},ki=e=>{const t=document.createElement("script");t.src=e,t.async=!0;const n=((e,t)=>new Promise((n,r)=>{t.onload=()=>{n(t)},t.onerror=()=>{r(new Error(`Failed to load script: ${e}`))}}))(e,t);return document.head.appendChild(t),n},Ti=(e,t)=>!!e&&e.tagName===t,Ni=e=>Ti(e,se)&&!ui(e,bi),Ai=e=>Ti(e,se)&&ui(e,bi),Di=e=>{const t=ye(se,e),n=[],{length:r}=t,o=wi(),i={...o&&{nonce:o}};for(let e=0;e<r;e+=1){const r=t[e];if(!Ni(r))continue;const{textContent:o}=r;o&&n.push(oe(se,i,{textContent:o}))}return n},Oi=e=>{const t=ye(se,e),n=[],{length:r}=t;for(let e=0;e<r;e+=1){const r=t[e];if(!Ai(r))continue;const o=ui(r,bi);o&&n.push(o)}return n},_i=(e,t)=>{t.forEach(t=>{e.appendChild(t),e.removeChild(t)})},Pi=e=>Promise.all(e.map(ki)),xi=(e,t,n)=>{const r=ni(t);Ci(r);const o=hi(r),i=Di(r),a=Oi(r);return Ii(r),o.forEach(t=>{re(e,t)}),n(e),_i(e,i),Pi(a)},Ri=(e,t,n)=>((e=>{hi(e).forEach(Te)})(e),xi(e,t,n)),Li=(e,t,n)=>{const r=ni(t);Ci(r);const o=hi(r),i=Di(r),a=Oi(r),{length:s}=o;let c=s-1;for(Ii(r);c>=0;){const t=o[c];n(t);const r=yi(e);r?mi(r,t):re(e,t),c-=1}return _i(e,i),Pi(a)},Mi="alloy-prehiding",Ui={},Fi=e=>{if(Ui[e])return;const t=wi(),n={...t&&{nonce:t}},r=oe(ae,n,{textContent:`${e} { visibility: hidden }`});re(document.head,r),Ui[e]=r},ji=e=>{const t=Ui[e];t&&(Te(t),delete Ui[e])},Bi=(e,t,n)=>{const r=ni(t);Ci(r);const o=hi(r),i=Di(r),a=Oi(r);return Ii(r),o.forEach(t=>{n(t),mi(e,t)}),_i(e,i),Pi(a)},$i=(e,t,n)=>Bi(e,t,n).then(()=>{Te(e)}),qi=(e,t,n)=>{const r=ni(t);Ci(r);const o=hi(r),i=Di(r),a=Oi(r);Ii(r);let s=e;return o.forEach(e=>{n(e),gi(s,e),s=e}),_i(e,i),Pi(a)},Vi=(e,t,n)=>{const{priority:r,...o}=t;Object.keys(o).forEach(t=>{pi(e,t,o[t],r)}),n(e)},zi=(e,t,n)=>{Object.keys(t).forEach(n=>{di(e,n,t[n])}),n(e)},Ji=(e,t,n)=>{e.tagName===ie&&(Ei(t),n(e),((e,t)=>{e.removeAttribute(t)})(e,bi),di(e,bi,t))},Hi=(e,{from:t,to:n},r)=>{const o=(e=>{const{children:t}=e;return t?ue(t):[]})(e),i=o[t],a=o[n];i&&a&&(t<n?gi(a,i):mi(a,i),r(a),r(i))},Gi=(e,t=!1)=>async(n,r,o)=>{const{selector:i,prehidingSelector:a,content:s}=n;Fi(a);try{(({containers:e,content:t,decorateProposition:n,renderFunc:r,renderStatusHandler:o,alwaysRender:i})=>{const a=e.filter(e=>i||o.shouldRender(e)).map(async e=>{await r(e,t,n),o.markAsRendered(e)});Promise.all(a)})({containers:await Ie(i,ci),content:s,decorateProposition:r,renderFunc:e,renderStatusHandler:o,alwaysRender:t})}finally{ji(a)}},Xi=(e,t,n)=>{n(e),e.textContent=t},Wi=e=>`${e}`.endsWith("px")?e:`${e}px`,Yi=(e,t,n)=>{const{priority:r,...o}=t;Object.keys(o).forEach(t=>{let n=o[t];"left"!==t&&"top"!==t||(n=Wi(n)),pi(e,t,n,r)}),n(e)},Ki=(e,t,n)=>{n(e)},Qi=(e,t,n)=>{const{priority:r,...o}=t;Object.keys(o).forEach(t=>{let n=o[t];"width"!==t&&"height"!==t||(n=Wi(n)),pi(e,t,n,r)}),n(e)},Zi="setHtml",ea="customCode",ta="setText",na="setAttribute",ra="setImageSource",oa="setStyle",ia="move",aa="resize",sa="rearrange",ca="remove",la="insertAfter",da="insertBefore",ua="replaceHtml",pa="prependHtml",fa="appendHtml",ga="click",ma="collectInteractions",ha=({eventManager:e,mergeDecisionsMeta:t})=>({decisionsMeta:n=[],propositionAction:r,documentMayUnload:o=!1,eventType:i=zo,propositionEventTypes:a=[Qo(i)],viewName:s})=>{const c=e.createEvent(),l={eventType:i};return s&&(l.web={webPageDetails:{viewName:s}}),de(n)&&t(c,n,a,r),c.mergeXdm(l),o&&c.documentMayUnload(),e.sendEvent(c)},ya=(e,t)=>{if(oi(e))return((e,t)=>t.matches?t.matches(e):t.msMatchesSelector(e))(e,t);const n=ci(e);let r=!1;for(let e=0;e<n.length;e+=1)if(n[e]===t){r=!0;break}return r},va="view",wa=e=>e.map(e=>{const{trackingLabel:t,scopeType:n,...r}=e;return r}),ba=(e,t,n)=>{const{documentElement:r}=document;let o=e,i=0;for(;o&&o!==r;){if(ya(t,o)){const e=n(t),r={metas:e},o=e.find(e=>e.trackingLabel);o&&(r.label=o.trackingLabel,r.weight=i);const a=e.find(e=>e.scopeType===va);return a&&(r.viewName=a.scope,r.weight=i),r}o=o.parentNode,i+=1}return{metas:null}},Ea=(e,t,n)=>{const r=[];let o,i="",a=Number.MAX_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER;for(let c=0;c<t.length;c+=1){const{metas:l,label:d,weight:u,viewName:p}=ba(e,t[c],n);l&&(d&&u<=a&&(i=d,a=u),p&&u<=s&&(o=p,s=u),r.push(...wa(l)))}return{decisionsMeta:(c=r,c.filter((e,t)=>{const n=JSON.stringify(e);return t===c.findIndex(e=>JSON.stringify(e)===n)})),propositionActionLabel:i,propositionActionToken:void 0,viewName:o};var c},Ia=(e=document)=>-1!==e.location.href.indexOf("adobe_authoring_enabled"),Sa=(e,t,n,r)=>{if(0===t.length)return;const o={};n.forEach(e=>{o[e]=1});const i={_experience:{decisioning:{propositions:t,propositionEventType:o}}};r&&(i._experience.decisioning.propositionAction=r),e.mergeXdm(i)},Ca=(e,t)=>{e.mergeQuery({personalization:{...t}})},ka=()=>{const e={};return{storeClickMeta:({selector:t,meta:{id:n,scope:r,scopeDetails:o,trackingLabel:i,scopeType:a}})=>{e[t]||(e[t]={}),e[t][n]={scope:r,scopeDetails:o,trackingLabel:i,scopeType:a}},getClickSelectors:()=>Object.keys(e),getClickMetas:t=>e[t]?(e=>Object.keys(e).map(t=>({id:t,...e[t]})))(e[t]):{}}},Ta=(e,t)=>e===Fo&&t===ma,Na={[Mo]:()=>!0,[Uo]:()=>!0,[Fo]:Ta,[$o]:()=>!0,[Lo]:()=>!0},Aa=({processPropositions:e,createProposition:t,renderedPropositions:n,viewCache:r})=>{const o=({items:e,metadataForScope:t={}})=>{const{actionType:n,selector:r}=t;return e.filter(e=>((e,t)=>"function"==typeof Na[e]&&Na[e](e,t))(e.schema,n)).map(e=>{const{schema:o}=e;return o===Uo||Ta(o,n)?We(t)?void 0:{...e,schema:Ta(o,n)?Mo:o,data:{...e.data,selector:r,type:n}}:{...e}}).filter(e=>e)},i=e=>!(e.scope===Ro&&e.renderAttempted);return({propositions:a=[],metadata:s={},viewName:c})=>{const l=ne();n.concat(l.promise);const d=(({propositions:e,metadata:t})=>e.filter(i).map(e=>{if(de(e.items)){const{id:n,scope:r,scopeDetails:i}=e;return{id:n,scope:r,scopeDetails:i,items:o({items:e.items,metadataForScope:t[e.scope]})}}return e}).filter(e=>de(e.items)))({propositions:a,metadata:s}).map(e=>t(e));return Promise.resolve().then(()=>c?r.getView(c):[]).then(t=>{const{render:n,returnedPropositions:r}=e([...d,...t]);return n().then(l.resolve),{propositions:r}})}},Da=e=>{const{selector:t,type:n}=e;return n!==ea||"BODY > *:eq(0)"!==t?e:{...e,selector:"BODY"}},Oa=e=>{const t={...e},{content:n,selector:r}=t;if(Zr(n))return t;if(null==r)return t;const o=ci(r);return Ti(o[0],"HEAD")?(t.type=fa,t.content=(e=>{const t=ni(e);return ye("SCRIPT,LINK,STYLE",t).map(e=>e.outerHTML).join("")})(n),t):t},_a=({preprocess:e,isPageWideSurface:t})=>(n,r=!0,o=!1)=>{const{id:i,scope:a,scopeDetails:s,items:c=[]}=n,{characteristics:{scopeType:l}={}}=s||{};return{getScope:()=>a,getScopeType:()=>a===Ro||t(a)?"page":l===va?va:"proposition",getItems(){return c.map(t=>((t,n)=>{const{id:r,schema:o,data:i,characteristics:{trackingLabel:a}={}}=t,s=i?i.type:void 0,c=e(i);return{getId:()=>r,getSchema:()=>o,getSchemaType:()=>s,getData:()=>c,getProposition:()=>n,getTrackingLabel:()=>a,getOriginalItem:()=>t,toString:()=>JSON.stringify(t),toJSON:()=>t}})(t,this))},getNotification:()=>({id:i,scope:a,scopeDetails:s}),getId:()=>i,toJSON:()=>n,shouldSuppressDisplay:()=>o,addToReturnValues(e,t,o,i){r&&(e.push({...n,items:o.map(e=>e.getOriginalItem()),renderAttempted:i}),i||t.push({...n,items:o.map(e=>e.getOriginalItem())}))}}},Pa=()=>({render:Ze,setRenderAttempted:!0,includeInNotification:!0}),xa="always",Ra="never",La="decoratedElementsOnly",Ma=[xa,Ra,La],Ua="data-aep-interact-id",Fa="data-aep-click-label";let ja=0;const Ba=(e,t,n,r,o,i,a,s)=>{const{scopeDetails:c={}}=a,{decisionProvider:l}=c;return((e,t)=>!!e&&!!e[t]&&[xa,La].includes(e[t]))(e,l)||t===ga?e=>{if(!e.tagName)return;const t=(c=ui(e,Ua))?parseInt(c,10):++ja;var c;s(n,r,i,a,t),di(e,Ua,t),o&&!ui(e,Fa)&&di(e,Fa,o)}:Ze},$a=(e,t)=>e!==va?{shouldRender:()=>!0,markAsRendered:()=>{}}:{shouldRender:e=>{if(!e)return!0;return!(e.dataset.adobePropositionIds??"").split(",").includes(t)},markAsRendered:e=>{const n=(e.dataset.adobePropositionIds??"").split(",");n.includes(t)||n.push(t),e.dataset.adobePropositionIds=n.sort().join(",")}},qa=({modules:e,logger:t,storeInteractionMeta:n,storeClickMeta:r,autoCollectPropositionInteractions:o})=>i=>{const{type:a,selector:s}=i.getData()||{};if(!a)return t.warn("Invalid DOM action data: missing type.",i.getData()),{setRenderAttempted:!1,includeInNotification:!1};if(a===ga)return s?(r({selector:s,meta:{...i.getProposition().getNotification(),trackingLabel:i.getTrackingLabel(),scopeType:i.getProposition().getScopeType()}}),{setRenderAttempted:!0,includeInNotification:!1}):(t.warn("Invalid DOM action data: missing selector.",i.getData()),{setRenderAttempted:!1,includeInNotification:!1});if(!e[a])return t.warn("Invalid DOM action data: unknown type.",i.getData()),{setRenderAttempted:!1,includeInNotification:!1};const c=$a(i.getProposition().getScopeType(),i.getId()),l=Ba(o,a,i.getProposition().getId(),i.getId(),i.getTrackingLabel(),i.getProposition().getScopeType(),i.getProposition().getNotification(),n);return{render:()=>e[a](i.getData(),l,c),setRenderAttempted:!0,includeInNotification:!0}},Va=({modules:e,logger:t,storeInteractionMeta:n,autoCollectPropositionInteractions:r})=>o=>{const{type:i,selector:a}=o.getData()||{};if(!a||!i)return{setRenderAttempted:!1,includeInNotification:!1};if(!e[i])return t.warn("Invalid HTML content data",o.getData()),{setRenderAttempted:!1,includeInNotification:!1};const s=Ba(r,i,o.getProposition().getId(),o.getId(),o.getTrackingLabel(),o.getProposition().getScopeType(),o.getProposition().getNotification(),n),c=$a(o.getProposition().getScopeType(),o.getId());return{render:()=>e[i](o.getData(),s,c),setRenderAttempted:!0,includeInNotification:!0}},za="BODY",Ja=({logger:e,executeRedirect:t,collect:n})=>r=>{const{content:o}=r.getData()||{};if(!o)return e.warn("Invalid Redirect data",r.getData()),{};return{render:()=>(Fi(za),n({decisionsMeta:[r.getProposition().getNotification()],documentMayUnload:!0}).then(()=>(e.logOnContentRendering({status:"rendering-redirect",detail:{propositionDetails:r.getProposition().getNotification(),redirect:o},message:`Redirect action ${r.toString()} executed.`,logLevel:"info"}),t(o))).catch(e=>{throw ji(za),e})),setRenderAttempted:!0,onlyRenderThis:!0}},Ha=({schemaProcessors:e,logger:t})=>{const n=(e,n)=>()=>Promise.resolve().then(e).then(()=>(t.enabled&&t.info(`Action ${n.toString()} executed.`),n.toJSON())).catch(e=>{const{message:r,stack:o}=e,i=`Failed to execute action ${n.toString()}. ${r} ${o}`;t.logOnContentRendering({status:"rendering-failed",detail:{propositionDetails:n.getProposition().getNotification(),item:n.toJSON()},error:e,message:i,logLevel:"warn"})}),r=t=>{const n=e[t.getSchema()];return n?n(t):{}},o=({renderers:e,returnedPropositions:t,returnedDecisions:o,items:i,proposition:a})=>{let s,c,l,d,u=[...e],p=[...t],f=[...o],g=[],m=[],h=[],y=!1,v=!1,w=0;for(;i.length>w;){if(d=i[w],({render:s,setRenderAttempted:c,includeInNotification:l,onlyRenderThis:v}=r(d)),v){p=[],f=[],c?(g=[d],m=[]):(g=[],m=[d]),u=[],h=[s],y=l;break}s&&h.push(n(s,d)),l&&(y=!0),c?g.push(d):m.push(d),w+=1}if(h.length>0){const e=y?a.getNotification():void 0;u.push(()=>(async(e,t)=>{const n=(await Promise.allSettled(e.map(e=>e()))).filter(e=>"fulfilled"===e.status).map(e=>e.value);if(t&&de(n))return{...t,items:n}})(h,e))}else y&&u.push(()=>Promise.resolve(a.getNotification()));return g.length>0&&a.addToReturnValues(p,f,g,!0),m.length>0&&a.addToReturnValues(p,f,m,!1),{renderers:u,returnedPropositions:p,returnedDecisions:f,onlyRenderThis:v}};return(e,n=[])=>{let r,i,a,s=[],c=[],l=[],d=0;for(;e.length>d&&(i=e[d],a=i.getItems(),({renderers:s,returnedPropositions:c,returnedDecisions:l,onlyRenderThis:r}=o({renderers:s,returnedPropositions:c,returnedDecisions:l,items:a,proposition:i})),!r);)d+=1;r&&e.forEach((e,t)=>{t!==d&&e.addToReturnValues(c,l,e.getItems(),!1)}),n.forEach(e=>{e.addToReturnValues(c,l,e.getItems(),!1)});return{returnedPropositions:c,returnedDecisions:l,render:()=>Promise.all(s.map(e=>e())).then(e=>{const n=e.filter(e=>e),r=n.map(e=>{const{id:t,scope:n,scopeDetails:r}=e;return{id:t,scope:n,scopeDetails:r}});if(de(n)){const e=Le(n,e=>e.scope);t.logOnContentRendering({status:"rendering-succeeded",detail:{...e},message:`Scopes: ${JSON.stringify(e)} successfully executed.`,logLevel:"info"})}return r})}}},Ga=({processPropositions:e,createProposition:t,notificationHandler:n})=>({renderDecisions:r,propositions:o,event:i,personalization:a={}})=>{if(!r)return Promise.resolve();const{sendDisplayEvent:s=!0}=a,c=i?i.getViewName():void 0,l=(()=>{let e=0;return t=>{const{items:n=[]}=t;return!!n.some(e=>e.schema===$o)&&(e+=1,e>1)}})(),d=o.map(e=>t(e,!0,l(e))),{render:u,returnedPropositions:p}=e(d),f=n(r,s,c),g=d.reduce((e,t)=>(e[t.getId()]=t,e),{});return u().then(e=>{const t=e.filter(e=>!g[e.id].shouldSuppressDisplay()),n=e.filter(e=>g[e.id].shouldSuppressDisplay());f(t,n)}),Promise.resolve({propositions:p})},Xa="text/html",Wa="defaultContent",Ya=["content","contentType"],Ka=["mobileParameters","webParameters","html"],Qa=({modules:e,logger:t})=>n=>{const r=n.getData(),o=n.getProposition(),i={...o.getNotification()},a=o.shouldSuppressDisplay();if(!r)return t.warn("Invalid in-app message data: undefined.",r),{};const{type:s=Wa}=r;return e[s]?((e,t)=>{for(let n=0;n<Ya.length;n+=1){const r=Ya[n];if(!Object.prototype.hasOwnProperty.call(e,r))return t.warn(`Invalid in-app message data: missing property '${r}'.`,e),!1}const{content:n,contentType:r}=e;if("application/json"===r)for(let r=0;r<Ka.length;r+=1){const o=Ka[r];if(!Object.prototype.hasOwnProperty.call(n,o))return t.warn(`Invalid in-app message data.content: missing property '${o}'.`,e),!1}return!0})(r,t)?i?{render:()=>a?null:e[s]({...r,meta:i}),setRenderAttempted:!0,includeInNotification:!0}:(t.warn("Invalid in-app message meta: undefined.",i),{}):{}:(t.warn("Invalid in-app message data: unknown type.",r),{})},Za=e=>{const t=ye(`#${e}`,document);t&&t.length>0&&Te(t[0])},es=e=>(t,n=!1)=>(n?e.location.href=t:e.location.replace(t),new Promise(()=>{})),ts="alloy-messaging-container",ns="alloy-overlay-container",rs="alloy-content-iframe",os=()=>[ts,ns].forEach(Za),is=(e,t=es(window))=>n=>{n.preventDefault(),n.stopImmediatePropagation();const{target:r}=n,o="a"===r.tagName.toLowerCase()?r:r.closest("a");if(!o)return;const{action:i,interaction:a,link:s,label:c,uuid:l}=(e=>{const t={};if(!e||"a"!==e.tagName.toLowerCase())return t;const{href:n}=e;if(!n||!n.startsWith("adbinapp://"))return t;const r=n.split("?"),o=r[0].split("://")[1],i=e.innerText,a=e.getAttribute("data-uuid")||"";let s,c;if(de(r)){const e=rt.parse(r[1]);s=e.interaction||"",c=Jn(e.link||"")}return{action:o,interaction:s,link:c,label:i,uuid:a}})(o);e(i,{label:c,id:a,uuid:l,link:s}),"dismiss"===i&&os(),Ke(s)&&s.length>0&&t(s,!0)},as=e=>{const{verticalAlign:t,width:n,horizontalAlign:r,backdropColor:o,height:i,cornerRadius:a,horizontalInset:s,verticalInset:c,uiTakeover:l=!1}=e,d={width:n?`${n}%`:"100%",backgroundColor:o||"rgba(0, 0, 0, 0.5)",borderRadius:a?`${a}px`:"0px",border:"none",position:l?"fixed":"relative",overflow:"hidden"};return"left"===r?d.left=s?`${s}%`:"0":"right"===r?d.right=s?`${s}%`:"0":"center"===r&&(d.left="50%",d.transform="translateX(-50%)"),"top"===t?d.top=c?`${c}%`:"0":"bottom"===t?(d.position="fixed",d.bottom=c?`${c}%`:"0"):"center"===t&&(d.top="50%",d.transform=("center"===r?`${d.transform} `:"")+"translateY(-50%)",d.display="flex",d.alignItems="center",d.justifyContent="center"),d.height=i?`${i}vh`:"100%",d},ss=e=>{const{backdropOpacity:t,backdropColor:n}=e;return{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",background:"transparent",opacity:t||.5,backgroundColor:n||"#FFFFFF"}},cs=["enabled","parentElement","insertionMethod"],ls=(e={},t)=>{os();const{content:n,contentType:r,mobileParameters:o}=e;let{webParameters:i}=e;if(r!==Xa)return;const a=oe("div",{id:ts}),s=((e,t)=>{const n=(new DOMParser).parseFromString(e,Xa),r=n.querySelector("script");r&&r.setAttribute("nonce",wi());const o=oe("iframe",{src:URL.createObjectURL(new Blob([n.documentElement.outerHTML],{type:"text/html"})),id:rs});return o.addEventListener("load",()=>{const{addEventListener:e}=o.contentDocument||o.contentWindow.document;e("click",t)}),o})(n,is(t)),c=oe("div",{id:ns});(e=>{if(!e)return!1;const t=Object.keys(e);if(!t.includes(ts))return!1;if(!t.includes(ns))return!1;const n=Object.values(e);for(let e=0;e<n.length;e+=1){if(!sn(n[e],"style"))return!1;if(!sn(n[e],"params"))return!1;for(let t=0;t<cs.length;t+=1)if(!sn(n[e].params,cs[t]))return!1}return!0})(i)||(i=(e=>{if(!e)return;const{uiTakeover:t=!1}=e;return{[rs]:{style:{border:"none",width:"100%",height:"100%"},params:{enabled:!0,parentElement:"#alloy-messaging-container",insertionMethod:"appendChild"}},[ts]:{style:as(e),params:{enabled:!0,parentElement:"body",insertionMethod:"appendChild"}},[ns]:{style:ss(e),params:{enabled:!0===t,parentElement:"body",insertionMethod:"appendChild"}}}})(o)),i&&((e,t,n,r)=>{[{id:ns,element:r},{id:ts,element:n},{id:rs,element:e}].forEach(({id:e,element:n})=>{const{style:r={},params:o={}}=t[e];Object.assign(n.style,r);const{parentElement:i="body",insertionMethod:a="appendChild",enabled:s=!0}=o,c=document.querySelector(i);s&&c&&"function"==typeof c[a]&&c[a](n)})})(s,i,a,c)},ds=e=>({defaultContent:t=>((e,t)=>new Promise(n=>{const{meta:r}=e;ls(e,(e,n)=>{const o={};o[Wo.INTERACT]=1,-1!==Object.values(Wo).indexOf(e)&&(o[e]=1),t({decisionsMeta:[r],propositionAction:n,eventType:Jo,propositionEventTypes:Object.keys(o)})}),n({meta:r})}))(t,e)}),us=e=>{const t=e.find(e=>e.scopeType===va);return t?t.scope:void 0},ps=(e,t,n)=>{const{interactIds:r,clickLabel:o="",clickToken:i}=(e=>{const{documentElement:t}=document;let n=e;const r=new Set;let o,i;for(;n&&n!==t&&!(n instanceof ShadowRoot);){const e=ui(n,Ua);e&&r.add(e),o=o||ui(n,Fa),i=i||ui(n,"data-aep-click-token"),n=n.parentNode}return{interactIds:[...r],clickLabel:o,clickToken:i}})(e),a=((e,t,n)=>r=>{const{scopeDetails:o={}}=r,{decisionProvider:i}=o;return e[i]===xa||e[i]===La&&(t||n)})(n,o,i);if(0===r.length)return{};const s=t(r).filter(a);return{decisionsMeta:wa(s),propositionActionLabel:o,propositionActionToken:i,viewName:us(s)}},fs="AJO",gs="TGT",ms=({config:e,logger:t,eventManager:n,consent:r})=>{const{targetMigrationEnabled:o,prehidingStyle:i,autoCollectPropositionInteractions:a}=e,s=ha({eventManager:n,mergeDecisionsMeta:Sa}),c=(e=>()=>{const t=li(Mi);t&&(e.logOnContentHiding({status:"show-containers",message:"Prehiding style removed to show containers.",logLevel:"info"}),Te(t))})(t),l=(e=>t=>{if(!t)return;if(li(Mi))return;const n=wi(),r={id:Mi,...n&&{nonce:n}},o=oe(ae,r,{textContent:t});e.logOnContentHiding({status:"hide-containers",message:"Prehiding style applied to hide containers.",logLevel:"info"}),re(document.head,o)})(t),{storeInteractionMeta:d,getInteractionMetas:u}=(()=>{const e={},t={};return{storeInteractionMeta:(n,r,o,i,a)=>{a=parseInt(a,10),e[a]||(e[a]={},t[a]={}),t[a][n]||(t[a][n]=new Set),t[a][n].add(r),e[a][n]={...i,scopeType:o}},getInteractionMetas:n=>Array.isArray(n)&&0!==n.length?Object.values(n.map(e=>parseInt(e,10)).reduce((n,r)=>(Object.keys(e[r]||{}).forEach(o=>{n[o]||(n[o]={proposition:e[r][o],items:new Set}),n[o].items=new Set([...n[o].items,...t[r][o]])}),n),{})).map(({proposition:e,items:t})=>({...e,items:Array.from(t).map(e=>({id:e}))})):[]}})(),{storeClickMeta:p,getClickSelectors:f,getClickMetas:g}=ka(),m=(({window:e})=>()=>e.location)({window}),h={[Zi]:Gi(Ri,!0),[ea]:Gi(Li),[ta]:Gi(Xi,!0),[na]:Gi(zi,!0),[ra]:Gi(Ji,!0),[oa]:Gi(Vi,!0),[ia]:Gi(Yi,!0),[aa]:Gi(Qi,!0),[sa]:Gi(Hi),[ca]:Gi(Te,!0),[la]:Gi(qi),[da]:Gi(Bi),[ua]:Gi($i,!0),[pa]:Gi(Li),[fa]:Gi(xi),[ma]:Gi(Ki,!0)},y=(v=[Oa,Da],e=>e?v.reduce((e,t)=>({...e,...t(e)}),e):e);var v;const w=_a({preprocess:y,isPageWideSurface:xo}),b=(({createProposition:e})=>{let t=!1,n=Promise.resolve({});const r=(t,n)=>{const r=t[n.toLowerCase()];return r&&r.length>0?r:[e({scope:n,scopeDetails:{characteristics:{scopeType:va}},items:[{schema:Lo}]},!1)]};return{createCacheUpdate:e=>{const o=ne();return t=!0,n=n.then(e=>o.promise.then(t=>({...e,...t})).catch(()=>e)),{update(t){const n=t.filter(e=>e.getScope()),i=Le(n,e=>e.getScope().toLowerCase());return o.resolve(i),e?r(i,e):[]},cancel(){o.reject()}}},getView:e=>n.then(t=>r(t,e)),isInitialized:()=>t}})({createProposition:w}),E=es(window),I={[Lo]:Pa,[Mo]:qa({modules:h,logger:t,storeInteractionMeta:d,storeClickMeta:p,autoCollectPropositionInteractions:a}),[Uo]:Va({modules:h,logger:t,storeInteractionMeta:d,autoCollectPropositionInteractions:a}),[Bo]:Ja({logger:t,executeRedirect:E,collect:s}),[$o]:Qa({modules:ds(s),logger:t})},S=Ha({schemaProcessors:I,logger:t}),C=(()=>{let e=Promise.resolve([]);return{concat(t){e=e.then(e=>t.then(t=>e.concat(t)).catch(()=>e))},clear(){const t=e;return e=Promise.resolve([]),t}}})(),k=((e,t)=>(n,r,o)=>{if(!n)return()=>{};if(!r){const e=ne();return t.concat(e.promise),e.resolve}return(t=[],n=[])=>{de(t)&&e({decisionsMeta:t,viewName:o}),de(n)&&e({decisionsMeta:n,eventType:Xo,propositionAction:{reason:"Conflict"},viewName:o})}})(s,C),T=(({logger:e,prehidingStyle:t,showContainers:n,hideContainers:r,mergeQuery:o,processPropositions:i,createProposition:a,notificationHandler:s,consent:c})=>({cacheUpdate:l,personalizationDetails:d,event:u,onResponse:p})=>{const{state:f,wasSet:g}=c.current();"out"===f&&g||(d.isRenderDecisions()?r(t):n()),o(u,d.createQueryDetails());const m=s(d.isRenderDecisions(),d.isSendDisplayEvent(),d.getViewName());p(({response:t})=>{const r=t.getPayloadsByType("personalization:decisions");de(r)||e.logOnContentRendering({status:"no-offers",message:"No offers were returned.",logLevel:"info",detail:{query:d.createQueryDetails()}});const o=r.map(e=>a(e)),{page:s=[],view:c=[],proposition:u=[]}=Le(o,e=>e.getScopeType()),p=l.update(c);let f,g,h;return d.isRenderDecisions()?(({render:f,returnedPropositions:g,returnedDecisions:h}=i([...s,...p],u)),de(s)&&e.logOnContentRendering({status:"rendering-started",message:"Started rendering propositions for page-wide scope.",logLevel:"info",detail:{scope:Ro,propositions:s.map(e=>e.toJSON())}}),de(p)&&e.logOnContentRendering({status:"rendering-started",message:`Rendering propositions started for view scope - ${d.getViewName()}.`,logLevel:"info",detail:{scope:d.getViewName(),propositions:p.map(e=>e.toJSON())}}),f().then(m),n()):({returnedPropositions:g,returnedDecisions:h}=i([],[...s,...p,...u])),{propositions:g,decisions:h}})})({prehidingStyle:i,showContainers:c,hideContainers:l,mergeQuery:Ca,processPropositions:S,createProposition:w,notificationHandler:k,consent:r,logger:t}),N=(({mergeDecisionsMeta:e,collectInteractions:t,collectClicks:n,getInteractionMetas:r,getClickMetas:o,getClickSelectors:i,autoCollectPropositionInteractions:a})=>({event:s,clickedElement:c})=>{const l=[];let d,u,p;if([t(c,r,a),n(c,i(),o)].forEach(({decisionsMeta:e,propositionActionLabel:t,propositionActionToken:n,viewName:r})=>{Array.prototype.push.apply(l,e),!d&&t&&(d=t),!u&&n&&(u=n),!p&&r&&(p=r)}),de(l)){const t={eventType:Jo};p&&(t.web={webPageDetails:{viewName:p}}),s.mergeXdm(t),e(s,l,[Wo.INTERACT],((e,t)=>{if(!t&&!e)return;const n={};return e&&(n.label=e),t&&(n.tokens=[t]),n})(d,u))}})({mergeDecisionsMeta:Sa,collectInteractions:ps,collectClicks:Ea,getInteractionMetas:u,getClickMetas:g,getClickSelectors:f,autoCollectPropositionInteractions:a}),A=(({processPropositions:e,viewCache:t,logger:n})=>({personalizationDetails:r,onResponse:o})=>{let i,a;const s=r.getViewName();return o(()=>({propositions:i,decisions:a})),t.getView(s).then(t=>{let o;return r.isRenderDecisions()?(({render:o,returnedPropositions:i,returnedDecisions:a}=e(t)),n.logOnContentRendering({status:"rendering-started",message:`Started rendering propositions for view scope - ${s}.`,logLevel:"info",detail:{scope:s,propositions:t.map(e=>e.toJSON())}}),o()):(({returnedPropositions:i,returnedDecisions:a}=e([],t)),[])})})({processPropositions:S,viewCache:b,logger:t}),D=Aa({processPropositions:S,createProposition:w,renderedPropositions:C,viewCache:b}),O=(({targetMigrationEnabled:e})=>e?e=>{e.getPayload().mergeMeta({target:{migration:!0}})}:Ze)({targetMigrationEnabled:o}),_=Ga({processPropositions:S,createProposition:w,notificationHandler:k}),P=(({showContainers:e,consent:t})=>()=>{const{state:n,wasSet:r}=t.current();"out"===n&&r?e():t.awaitConsent().catch(e)})({showContainers:c,consent:r});return ti({getPageLocation:m,logger:t,fetchDataHandler:T,viewChangeHandler:A,onClickHandler:N,isAuthoringModeEnabled:Ia,mergeQuery:Ca,viewCache:b,showContainers:c,applyPropositions:D,setTargetMigration:O,mergeDecisionsMeta:Sa,renderedPropositions:C,onDecisionHandler:_,handleConsentFlicker:P})};ms.namespace="Personalization";const hs=Ma.map(e=>rn(e));ms.configValidators=sn({prehidingStyle:cn().nonEmpty(),targetMigrationEnabled:tn().default(!1),autoCollectPropositionInteractions:sn({[fs]:Qt(hs).default(xa),[gs]:Qt(hs).default(Ra)}).default({[fs]:xa,[gs]:Ra}).noUnknownFields()});const ys=e=>null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype,vs=(e,t={},n=[])=>(Object.keys(e).forEach(r=>{ys(e[r])||Array.isArray(e[r])?vs(e[r],t,[...n,r]):t[[...n,r].join(".")]=e[r]}),t),ws=e=>ys(e)?vs(e):e,bs="matcher",Es="group",Is="historical",Ss="eq",Cs="ne",ks="ex",Ts="nx",Ns="gt",As="ge",Ds="lt",Os="le",_s="co",Ps="nc",xs="sw",Rs="ew",Ls="and",Ms="or",Us="ordered",Fs="mostRecent";function js(e){return"object"==typeof e||void 0===e}function Bs(e){return"number"==typeof e}const $s={[Ss]:{matches:(e,t,n=[])=>{if(js(e[t]))return!1;const r=String(e[t]).toLowerCase();for(let e=0;e<n.length;e+=1)if(!js(n[e])&&r===String(n[e]).toLowerCase())return!0;return!1}},[Cs]:{matches:(e,t,n=[])=>{if(js(e[t]))return!1;const r=String(e[t]).toLowerCase();for(let e=0;e<n.length;e+=1)if(!js(n[e])&&r===String(n[e]).toLowerCase())return!1;return!0}},[ks]:{matches:(e,t)=>void 0!==e[t]&&null!==e[t]},[Ts]:{matches:(e,t)=>void 0===e[t]||null===e[t]},[Ns]:{matches:(e,t,n=[])=>{const r=e[t];if(!Bs(r))return!1;for(let e=0;e<n.length;e+=1)if(Bs(n[e])&&r>n[e])return!0;return!1}},[As]:{matches:(e,t,n=[])=>{const r=e[t];if(!Bs(r))return!1;for(let e=0;e<n.length;e+=1)if(Bs(n[e])&&r>=n[e])return!0;return!1}},[Ds]:{matches:(e,t,n=[])=>{const r=e[t];if(!Bs(r))return!1;for(let e=0;e<n.length;e+=1)if(Bs(n[e])&&r<n[e])return!0;return!1}},[Os]:{matches:(e,t,n=[])=>{const r=e[t];if(!Bs(r))return!1;for(let e=0;e<n.length;e+=1)if(Bs(n[e])&&r<=n[e])return!0;return!1}},[_s]:{matches:(e,t,n=[])=>{if(js(e[t]))return!1;const r=String(e[t]).toLowerCase();for(let e=0;e<n.length;e+=1)if(!js(n[e])&&-1!==r.indexOf(String(n[e]).toLowerCase()))return!0;return!1}},[Ps]:{matches:(e,t,n=[])=>{if(js(e[t]))return!1;const r=String(e[t]).toLowerCase();for(let e=0;e<n.length;e+=1)if(!js(n[e])&&-1!==r.indexOf(String(n[e]).toLowerCase()))return!1;return!0}},[xs]:{matches:(e,t,n=[])=>{if(js(e[t]))return!1;const r=String(e[t]).toLowerCase();for(let e=0;e<n.length;e+=1)if(!js(n[e])&&r.startsWith(String(n[e]).toLowerCase()))return!0;return!1}},[Rs]:{matches:(e,t,n=[])=>{if(js(e[t]))return!1;const r=String(e[t]).toLowerCase();for(let e=0;e<n.length;e+=1)if(!js(n[e])&&r.endsWith(n[e].toLowerCase()))return!0;return!1}}};function qs(e){return void 0===e}const Vs="eventId",zs="eventType",Js=["iam.eventType",zs,"type"],Hs=["iam.id","id"],Gs=(e,t)=>{for(let n=0;n<t.length;n+=1)if(!qs(e[t[n]]))return t[n];throw new Error("The event does not match the expected schema.")},Xs=e=>{const t=structuredClone(e);return[[Gs(t,Js),zs],[Gs(t,Hs),Vs]].forEach(([e,n])=>{e!==n&&(t[n]=t[e],delete t[e])}),t};function Ws(e,t){return{evaluate:(e,n)=>t.evaluate(e,n),toString:()=>`Condition{type=${e}, definition=${t}}`}}function Ys(e,t,n){return{evaluate:r=>{const o=function(e){return $s[e]}(t);return!!o&&o.matches(r,e,n)}}}function Ks(e,t,n,r,o,i){return{evaluate:(a,s)=>{let c;return c=Fs===i?function(e,t,n,r=0,o=1/0){try{return e.reduce((e,i,a)=>{const s=n.generateEventHash(Xs(i)),c=t.events[s];if(!c)return e;const l=c.timestamps.filter(e=>e>=r&&e<=o).pop();return l&&l>e.timestamp?{index:a,timestamp:l}:e},{index:-1,timestamp:0}).index}catch{return-1}}(e,a,s,r,o):Us===i?function(e,t,n,r=0,o=1/0){try{let i=r;const a=e.every(e=>{const r=n.generateEventHash(Xs(e)),a=t.events[r];if(!a)return!1;const s=a.timestamps[0],c=s>=i&&s<=o;return i=s,c});return Number(a)}catch{return 0}}(e,a,s,r,o):function(e,t,n,r=0,o=1/0){return e.reduce((e,i)=>{try{const a=n.generateEventHash(Xs(i)),s=t.events[a];if(!s)return e;const{timestamps:c=[]}=s;return e+c.filter(e=>e>=r&&e<=o).length}catch{return e}},0)}(e,a,s,r,o),((e,t,n)=>{switch(t){case Ns:return e>n;case As:return e>=n;case Ds:return e<n;case Os:return e<=n;case Ss:return e===n;case Cs:return e!==n;default:return!1}})(c,t,n)}}}function Qs(e){const{logic:t,conditions:n}=e;return function(e,t){return{evaluate:(n,r)=>Ls===e?function(e,t,n){let r=!0;for(let o=0;o<t.length;o+=1)r=r&&t[o].evaluate(e,n);return r}(n,t,r):Ms===e&&function(e,t,n){let r=!1;for(let o=0;o<t.length;o+=1)if(r=r||t[o].evaluate(e,n),r)return!0;return!1}(n,t,r)}}(t,n.map(Zs))}function Zs(e){const{type:t,definition:n}=e;if(bs===t){const e=function(e){const{key:t,matcher:n,values:r}=e;return Ys(t,n,r)}(n);return Ws(t,e)}if(Es===t){return Ws(t,Qs(n))}if(Is===t){const e=function(e){const{events:t,from:n,to:r,matcher:o,value:i,searchType:a}=e;return Ks(t,o,i,n,r,a)}(n);return Ws(t,e)}throw new Error("Can not parse condition")}function ec(e){const{id:t,type:n,detail:r}=e;return function(e,t,n){return{id:e,type:t,detail:n}}(t,n,r)}function tc(e){const{condition:t,consequences:n,key:r}=e;return function(e,t,n){return{key:n,execute:(n,r)=>e.evaluate(n,r)?t:[],toString:()=>`Rule{condition=${e}, consequences=${t}}`}}(Zs(t),n.map(ec),r)}function nc(e){const{version:t,rules:n,metadata:r}=e,o=n.map(tc),i=function(e){if(!e)return;return{provider:e.provider,providerData:Object.assign({},e.providerData)}}(r);return function(e,t,n){return{version:e,rules:t,metadata:n}}(t,o,i)}function rc(e,t,n){const{providerData:r}=n,{identityTemplate:o}=r;return o.replace("<key>",t).replace("<identity>",e)}function oc(e,t=e=>e[0]){const n={};return function(...r){const o=t(r);return qs(n[o])&&(n[o]=e(...r)),n[o]}}function ic(e,t){const n=65535&t;return((t-n)*e|0)+(n*e|0)|0}const ac=oc(function(e,t=0){let n;const r=e.length,o=3432918353,i=461845907;let a=t;const s=-2&r;for(let t=0;t<s;t+=2)n=e.charCodeAt(t)|e.charCodeAt(t+1)<<16,n=ic(n,o),n=(131071&n)<<15|n>>>17,n=ic(n,i),a^=n,a=(524287&a)<<13|a>>>19,a=5*a+3864292196|0;return r%2==1&&(n=e.charCodeAt(s),n=ic(n,o),n=(131071&n)<<15|n>>>17,n=ic(n,i),a^=n),a^=r<<1,a^=a>>>16,a=ic(a,2246822507),a^=a>>>13,a=ic(a,3266489909),a^=a>>>16,a},e=>e.join("-"));const sc=oc(function(e,t){const n=ac(e),r=Math.abs(n)%t/t*100;return Math.round(100*r)/100});function cc(e,t,n){return{allocation:sc(e,t),...n}}function lc(e,t){return t.map(t=>t.execute(e)).filter(e=>e.length>0)}function dc(e,t){!function(e){const{providerData:t}=e;if(!t)throw new Error("Provider data is missing in metadata");const{identityTemplate:n,buckets:r}=t;if(!n)throw new Error("Identity template is missing in provider data");if(!r)throw new Error("Buckets is missing in provider data")}(t);const n=e.filter(e=>!e.key),r=function(e){const t={};for(let n=0;n<e.length;n+=1){const r=e[n];r.key&&(t[r.key]||(t[r.key]=[]),t[r.key].push(r))}return t}(e),{buckets:o}=t.providerData;return{provider:"TGT",execute:e=>{const i=function(e){const{xdm:t}=e;if(!t)throw new Error("XDM object is missing in the context");const{identityMap:n}=t;if(!n)throw new Error("Identity map is missing in the XDM object");const r=n.ECID;if(!r)throw new Error("ECID identity namespace is missing in the identity map");if(!Array.isArray(r)||0===r.length)throw new Error("ECID identities array is empty or not an array");const o=r[0].id;if(!o)throw new Error("ECID identity is missing in the identities array");return o}(e),a=lc(e,n),s=Object.keys(r),c=[];for(let n=0;n<s.length;n+=1){const a=s[n],l=r[a],d=lc(cc(rc(i,a,t),o,e),l);c.push(...d)}return[...a,...c]}}}function uc(e,t={generateEventHash:()=>{throw new Error("No hash function provided")}}){const{rules:n,metadata:r={}}=nc(e);return function(e,t,n){const{provider:r}=t;return"TGT"===r?dc(e,t):function(e,t){return{provider:"DEFAULT",execute:n=>e.map(e=>e.execute(n,t)).filter(e=>e.length>0)}}(e,n)}(n,r,t)}const pc=e=>{const t=structuredClone(e),n=Object.keys(t).sort().reduce((e,n)=>{const r=t[n];return null==r||""===r?e:e+=`${n}:${r}`},"");return De(n)},fc="events",gc="~type",mc="~source",hc="com.adobe.eventType.edge",yc="com.adobe.eventType.rulesEngine",vc="com.adobe.eventSource.requestContent",wc="cjmiam",bc="schema",Ec=(e=30,t=1e3)=>n=>{let r=Object.entries(n).reduce((e,[t,{timestamps:n=[]}])=>(n.forEach(n=>{e.push({key:t,timestamp:n})}),e),[]);const o=(e=>{const t=new Date;return t.setDate(t.getDate()-e),t})(e);return r=r.filter(({timestamp:e})=>e>=o),r.sort((e,t)=>e.timestamp-t.timestamp),r=r.slice(-t),r.reduce((e,{key:t,timestamp:n})=>(e[t]||(e[t]={timestamps:[]}),e[t].timestamps.push(n),e),{})},Ic=e=>e?.scopeDetails?.activity?.id,Sc=()=>{const e={};return{getItem:t=>t in e?e[t]:null,setItem:(t,n)=>{e[t]=n}}},Cc=e=>{e.clear()},kc={[wc]:(e,t,n)=>{const{html:r,mobileParameters:o}=n;return{schema:$o,data:{mobileParameters:o,webParameters:{},content:r,contentType:Xa},id:e}},[bc]:(e,t,n)=>{const{schema:r,data:o,id:i}=n;return{schema:r,data:o,id:i||e}}},Tc=e=>{const{schema:t,data:n}=e;if(t===jo)return!0;if(t!==Fo)return!1;try{const e="string"==typeof n.content?JSON.parse(n.content):n.content;return e&&Object.prototype.hasOwnProperty.call(e,"version")&&Object.prototype.hasOwnProperty.call(e,"rules")}catch{return!1}},Nc=(e,t)=>{const n=e=>{const{id:t,type:n,detail:r}=e;return"function"==typeof kc[n]?kc[n](t,n,r):r},r=Ic(e),o=[],i=e=>{const{data:t={},schema:n}=e,r=n===jo?t:t.content;r&&o.push(uc("string"==typeof r?JSON.parse(r):r,{generateEventHash:pc}))};return Array.isArray(e.items)&&e.items.filter(Tc).forEach(i),{rank:e?.scopeDetails?.rank||1/0,evaluate:i=>{const a=t.getEvent(zo,r),s=a?.timestamps[0],c=((e=[])=>Array.isArray(e)?e.flat(1/0):e)(o.map(e=>e.execute(i))).map(n).map(e=>{const n=t.addEvent({eventType:Wo.TRIGGER,eventId:r}).timestamps[0];return{...e,data:{...e.data,qualifiedDate:n,displayedDate:s}}});return{...e,items:c}},isEvaluable:o.length>0}},Ac=({storage:e,logger:t})=>{let n,r,o,i=e;const a=e=>{i=e;const t=((e,t)=>n=>{try{const n=e.getItem(t);return[JSON.parse(n),n.length]}catch{}return[n,0]})(i,fc);if(n=((e,t)=>n=>{e.setItem(t,JSON.stringify(n))})(i,fc),[r,o]=t({}),o>2097152){const e=Ec();r=e(r),n(r)}};a(e);const s=(e={eventType:null,eventId:null},o="insert")=>{const{eventType:i,eventId:a}=e;if(!i||!a)return;const s=pc(e);if("insertIfNotExists"===o&&r[s])return;r[s]&&Array.isArray(r[s].timestamps)||(r[s]={timestamps:[]});const c=(new Date).getTime();return r[s].timestamps.push(c),r[s].timestamps.sort(),t.info("[Event History] Added event for",e,"with hash",s,"and timestamp",c),n(r),r[s]};return{addExperienceEdgeEvent:e=>{const{xdm:t}=e.getContent();if(!(e=>{const{_experience:t}=e||{};return!!t&&"object"==typeof t})(t))return;const{_experience:{decisioning:{propositionEventType:n={},propositionAction:{id:r}={},propositions:o=[]}={}}}=t;Object.keys(n).filter(e=>1===n[e]).forEach(e=>{o.forEach(t=>{(e=>e?.scopeDetails?.decisionProvider)(t)===fs&&s({eventId:Ic(t),eventType:e,action:r})})})},addEvent:s,addEventPayloads:(e=[])=>e.map(({operation:e,event:t})=>s(t,e)),getEvent:(e,t)=>{const n=pc({eventType:e,eventId:t});if(r[n])return r[n]},toJSON:()=>r,setStorage:a}},Dc=e=>{const t={},n=e.split(".");switch(n.length){case 1:t.subdomain="",t.domain=e,t.topLevelDomain="";break;case 2:t.subdomain="",t.domain=e,t.topLevelDomain=n[1];break;case 3:t.subdomain="www"===n[0]?"":n[0],t.domain=e,t.topLevelDomain=n[2];break;case 4:t.subdomain="www"===n[0]?"":n[0],t.domain=e,t.topLevelDomain=`${n[2]}.${n[3]}`}return t},Oc=(e,t=Dc)=>{Ye(e)||(e="");const n=(e=>{try{const t=new URL(e);let n=t.pathname;return e.endsWith("/")||"/"!==n||(n=""),{host:t.hostname,path:n,query:t.search.replace(/^\?/,""),anchor:t.hash.replace(/^#/,"")}}catch{return{host:"",path:"",query:"",anchor:""}}})(e),{host:r,path:o,query:i,anchor:a}=n;return{path:o,query:i,fragment:a,...t(r)}},_c=(e,...t)=>t,Pc=(e,...t)=>!0,xc=()=>{let e=_c,t=Pc,n=0;const r={};return{add:(e,t=void 0)=>{return"function"!=typeof e?()=>{}:(n+=1,r[n]={callback:e,params:t},{id:n,unsubscribe:(o=n,()=>{delete r[o]})});var o},emit:(...n)=>{Object.values(r).forEach(({callback:r,params:o})=>{const i=e(o,...n);t(o,...i)&&r(...i)})},emitOne:(n,...o)=>{if(!n||!r[n])return;const{callback:i,params:a}=r[n],s=e(a,...o);t(a,...s)&&i(...s)},hasSubscriptions:()=>Object.keys(r).length>0,setEmissionPreprocessor:t=>{"function"==typeof t&&(e=t)},setEmissionCondition:e=>{"function"==typeof e&&(t=e)}}},Rc=({collect:e})=>{let t=()=>{};const n=new Set,r=(e,t,r)=>{const o=[e,t].join("-"),i=!r.has(o)&&((e=>[Wo.INTERACT,Wo.DISMISS].includes(e))(e)||!n.has(o));return r.add(o),n.add(o),i},o=(t,n=[])=>{if(!(n instanceof Array))return Promise.resolve();if(!Object.values(Wo).includes(t))return Promise.resolve();const o=[],i=new Set;return n.forEach(e=>{const n=(e=>{const{id:t,scope:n,scopeDetails:r}=e;return{id:t,scope:n,scopeDetails:r}})(e);r(t,n.id,i)&&o.push(n)}),o.length>0?e({decisionsMeta:o,eventType:Zo(t),documentMayUnload:!0}):Promise.resolve()},i=xc();i.setEmissionPreprocessor((e,t)=>{const{surfacesFilter:n,schemasFilter:r}=e;return[{propositions:t.filter(e=>!n||n.includes(e.scope)).map(e=>{const{items:t=[]}=e;return{...e,items:t.filter(e=>!r||r.includes(e.schema))}}).filter(e=>e.items.length>0)},o]});return{refresh:e=>{t=t=>{t?i.emitOne(t,e):i.emit(e)},t()},command:{optionsValidator:e=>(({options:e})=>sn({surfaces:en(cn()).uniqueItems(),schemas:en(cn()).uniqueItems(),callback:nn().required()}).noUnknownFields()(e))({options:e}),run:({surfaces:e,schemas:n,callback:r})=>{const{id:o,unsubscribe:a}=i.add(r,{surfacesFilter:e instanceof Array?e:void 0,schemasFilter:n instanceof Array?n:void 0});return t(o),Promise.resolve({unsubscribe:a})}}}},Lc=({contextProvider:e,decisionProvider:t})=>({optionsValidator:e=>(({options:e})=>sn({renderDecisions:tn(),personalization:sn({decisionContext:sn({})})}).noUnknownFields()(e))({options:e}),run:({renderDecisions:n,decisionContext:r,applyResponse:o})=>o({renderDecisions:n,propositions:t.evaluate(e.getContext(r))})}),Mc=({config:e,eventManager:t,createNamespacedStorage:n,consent:r,getBrowser:o,logger:i})=>{const{orgId:a,personalizationStorageEnabled:s}=e,c=ha({eventManager:t,mergeDecisionsMeta:Sa}),l=n(`${xe(a)}.decisioning.`);s||Cc(l.persistent);const d=Ac({storage:Sc(),logger:i}),u=(({eventRegistry:e})=>{const t={},n=n=>{const r=Ic(n);if(!r)return;const o=Nc(n,e);o.isEvaluable&&(t[r]=o)};return{addPayload:n,addPayloads:e=>{e.forEach(n)},evaluate:(e={})=>Object.values(t).sort(({rank:e},{rank:t})=>e-t).map(t=>t.evaluate(e)).filter(e=>e.items.length>0)}})({eventRegistry:d}),p=(({eventRegistry:e,window:t,getBrowser:n})=>{const r=(new Date).getTime(),o=()=>{const e=new Date,t=e.getTime();return{pageLoadTimestamp:r,currentTimestamp:t,currentDate:e.getDate(),"~state.com.adobe.module.lifecycle/lifecyclecontextdata.dayofweek":e.getDay()+1,"~state.com.adobe.module.lifecycle/lifecyclecontextdata.hourofday":e.getHours(),currentMinute:e.getMinutes(),currentMonth:e.getMonth(),currentYear:e.getFullYear(),pageVisitDuration:t-r,"~timestampu":t/1e3,"~timestampz":e.toISOString()}},i={browser:{name:n()},page:{title:t.title,url:t.url,...Oc(t.url)},referringPage:{url:t.referrer,...Oc(t.referrer)}};return{getContext:(n={})=>{const r={...{...i,...o(),window:{height:t.height,width:t.width,scrollY:t.scrollY,scrollX:t.scrollX},"~sdkver":En},...n};return{...ws(r),events:e.toJSON()}}}})({eventRegistry:d,window,getBrowser:o}),f=Lc({contextProvider:p,decisionProvider:u}),g=Rc({collect:c});let m;return{lifecycle:{onDecision({propositions:e}){g.refresh(e)},onComponentsRegistered(e){m=(({lifecycle:e,eventRegistry:t})=>({renderDecisions:n=!1,propositions:r=[],event:o,personalization:i})=>{if(e){const a=(e=>{const t=[];return e.forEach(e=>{const n=[];e.items.forEach(e=>{"https://ns.adobe.com/personalization/eventHistoryOperation"===e.schema?t.push({operation:e.data.operation,event:{eventId:e.data.content["iam.id"],eventType:e.data.content["iam.eventType"]}}):n.push(e)}),e.items=n}),t})(r);t.addEventPayloads(a),e.onDecision({renderDecisions:n,propositions:r,event:o,personalization:i})}return{propositions:r}})({lifecycle:e.lifecycle,eventRegistry:d}),s&&r.awaitConsent().then(()=>{d.setStorage(l.persistent)}).catch(()=>{l&&Cc(l.persistent)})},onBeforeEvent({event:e,renderDecisions:t,personalization:n={},onResponse:r=Ze}){const{decisionContext:o={}}=n;r((({renderDecisions:e,decisionProvider:t,applyResponse:n,event:r,personalization:o,decisionContext:i})=>{const a={...ws(r.getContent()),...i};return({response:i})=>{if(t.addPayloads(i.getPayloadsByType("personalization:decisions")),!r.hasQuery())return{propositions:[]};const s=t.evaluate(a);return n({renderDecisions:e,propositions:s,event:r,personalization:o})}})({renderDecisions:t,decisionProvider:u,applyResponse:m,event:e,personalization:n,decisionContext:p.getContext({[gc]:hc,[mc]:vc,...o})}))},onBeforeRequest({request:e}){const t=e.getPayload().toJSON(),{events:n=[]}=t;0!==n.length&&n.forEach(e=>d.addExperienceEdgeEvent(e))}},commands:{evaluateRulesets:{run:({renderDecisions:e,personalization:t={}})=>{const{decisionContext:n={}}=t;return f.run({renderDecisions:e,decisionContext:{[gc]:yc,[mc]:vc,...n},applyResponse:m})},optionsValidator:f.optionsValidator},subscribeRulesetItems:g.command}}};Mc.namespace="RulesEngine",Mc.configValidators=sn({personalizationStorageEnabled:tn().default(!1)});const Uc=sn({streamingMedia:sn({channel:cn().nonEmpty().required(),playerName:cn().nonEmpty().required(),appVersion:cn(),mainPingInterval:on().minimum(10).maximum(50).default(10),adPingInterval:on().minimum(1).maximum(10).default(10)}).noUnknownFields()}),Fc=({config:e,trackMediaEvent:t,trackMediaSession:n,mediaResponseHandler:r})=>({lifecycle:{onBeforeEvent({mediaOptions:e,onResponse:t=Ze}){if(!e)return;const{legacy:n,playerId:o,getPlayerDetails:i}=e;n||t(({response:e})=>r({playerId:o,getPlayerDetails:i,response:e}))}},commands:{createMediaSession:{optionsValidator:e=>(({options:e})=>Qt([sn({playerId:cn().required(),getPlayerDetails:nn().required(),xdm:sn({mediaCollection:sn({sessionDetails:sn(Zt()).required()})}),edgeConfigOverrides:un}).required(),sn({xdm:sn({mediaCollection:sn({playhead:on().required(),sessionDetails:sn(Zt()).required()})}),edgeConfigOverrides:un}).required()],"an object with playerId, getPlayerDetails and xdm.mediaCollection.sessionDetails, or an object with xdm.mediaCollection.playhead and xdm.mediaCollection.sessionDetails")(e))({options:e}),run:n},sendMediaEvent:{optionsValidator:e=>(({options:e})=>Qt([sn({playerId:cn().required(),xdm:sn({eventType:ln(...Object.values(Hr)).required(),mediaCollection:sn(Zt())}).required()}).required(),sn({xdm:sn({eventType:ln(...Object.values(Hr)).required(),mediaCollection:sn({playhead:on().integer().required(),sessionID:cn().required()}).required()}).required()}).required()],"Error validating the sendMediaEvent command options.")(e))({options:e}),run:n=>e.streamingMedia?t(n):Promise.reject(new Error("Streaming media is not configured."))}}}),jc=({config:e,logger:t,eventManager:n,sendEdgeNetworkRequest:r,consent:o})=>{const i=Yr(),a=Gr({config:e,eventManager:n,logger:t,consent:o,sendEdgeNetworkRequest:r,setTimestamp:bn(()=>new Date)}),s=Kr({mediaSessionCacheManager:i,mediaEventManager:a,config:e}),c=Qr({config:e,mediaEventManager:a,mediaSessionCacheManager:i}),l=eo({mediaSessionCacheManager:i,config:e,trackMediaEvent:s});return Fc({config:e,trackMediaEvent:s,mediaEventManager:a,mediaResponseHandler:l,trackMediaSession:c})};jc.namespace="Streaming media",jc.configValidators=Uc;const Bc="advertising",$c="_les_lsc",qc="lastConversionTime",Vc="displayClickCookieExpires",zc="rampIdExpires",Jc="surferId",Hc="rampId",Gc="id5Id",Xc="advertising.enrichment",Wc="trackingCode",Yc="trackingIdentities",Kc="Ad conversion submission failed",Qc="ev_lcc";let Zc="",el="",tl=null;const nl=()=>tl||(tl=new Promise((e,t)=>{setTimeout(()=>{const n="https:"===document.location.protocol?"https:":"http:",r=`${n}//www.everestjs.net/static/pixel_details.html#${new URLSearchParams({google:"__EFGCK__",gsurfer:"__EFGSURFER__",imsId:"__EFIMSORGID__",is_fb_cookie_synced:"__EFFB__",optout:"__EFOPTOUT__",throttleCookie:"__EFSYNC__",time:"__EFTIME__",ev_lcc:"__LCC__"}).toString()}`,o=`${n}//pixel.everesttech.net/1/gr?${new URLSearchParams({ev_gb:"0",url:r}).toString()}`,i=oe("iframe",{src:o},{height:0,width:0,frameBorder:0,style:{display:"none"}},[]);var a;a=i,document.body?document.body.appendChild(a):window.addEventListener("load",()=>{document.body.appendChild(a)},!1);var s;s=function n(r){var o;if(r.origin.includes("www.everestjs.net"))try{const t=r.data,i=t.indexOf("#");if(-1===i)return void e({surferId:null,displayClickCookie:null});const a=new URLSearchParams(t.substring(i+1));let s,c;const l=a.get("gsurfer");l&&(s=l);const d=a.get(Qc);d&&"__LCC__"!==d&&(c=d),o=n,window.removeEventListener("message",o,!1),s?(Zc=s,el=c,e({surferId:Zc,displayClickCookie:el})):e({surferId:null,displayClickCookie:null})}catch(e){t(e)}finally{tl=null}},window.addEventListener("message",s,!1)},5e3)}),tl),rl=function(e,t,n=!0){if(t){if(!Je({getBrowser:t})())return Promise.resolve(null)}if(Zc&&""!==Zc)return Promise.resolve(Zc);if(e){const t=e.getValue(Jc);if(t)return Zc=t,Promise.resolve(t)}return n?nl().then(t=>(e&&t&&(t.surferId&&e.setValue(Jc,t.surferId),t.displayClickCookie&&(e.setValue(Qc,t.displayClickCookie),e.setValue(Vc,Date.now()+9e5))),t.surferId)):Promise.resolve(null)},ol=15,il=3e4,al=500,sl=5e3,cl=2e3,ll={rampIdEnv:void 0,rampIdCallInitiated:!1,inProgressRampIdPromise:null,scriptLoadingInitiated:!1,envelopeRetrievalInProgress:!1},dl=(e,t,n,r)=>{let o;try{o=JSON.parse(e).envelope}catch{o=e}o&&!ll.rampIdCallInitiated?(ll.rampIdCallInitiated=!0,ll.rampIdEnv=o,ll.envelopeRetrievalInProgress=!1,ll.inProgressRampIdPromise=null,n.setValue(Hc,ll.rampIdEnv),n.setValue(zc,Date.now()+1728e5),t(ll.rampIdEnv)):(r.warn("Invalid RampID envelope received",{envelope:o}),ll.envelopeRetrievalInProgress=!1)},ul=(e,t,n,r=!1)=>{if(ll.inProgressRampIdPromise)return ll.inProgressRampIdPromise;const o=r?cl:il;let i=!1;const a=new Promise((r,o)=>{ke(e,{onLoad:()=>{void 0===window.ats||ll.envelopeRetrievalInProgress||(ll.envelopeRetrievalInProgress=!0,window.ats.retrieveEnvelope().then(e=>{e?i||dl(e,r,t,n):(ll.envelopeRetrievalInProgress=!1,window.addEventListener("lrEnvelopePresent",()=>{ll.envelopeRetrievalInProgress||i||(ll.envelopeRetrievalInProgress=!0,window.ats.retrieveEnvelope().then(e=>{i||dl(e,r,t,n)},e=>{i||(n.error("Failed to retrieve envelope after event",e),ll.envelopeRetrievalInProgress=!1,o(e),ll.inProgressRampIdPromise=null)}))}))}).catch(e=>{i||(n.error("Error retrieving envelope",e),ll.envelopeRetrievalInProgress=!1,o(e),ll.inProgressRampIdPromise=null)})),((e,t,n,r)=>{let o=ol,i=1,a=0;const s=()=>{if(ll.rampIdEnv)return;if(a>il)return r.error("Maximum retry time exceeded"),ll.envelopeRetrievalInProgress=!1,t(new Error("Failed to retrieve RampID - timeout")),void(ll.inProgressRampIdPromise=null);if(0===o)return r.error("Maximum retries exceeded"),ll.envelopeRetrievalInProgress=!1,t(new Error("Failed to retrieve RampID after maximum retries")),void(ll.inProgressRampIdPromise=null);const c=Math.min(al*i,sl);setTimeout(()=>{a+=c,o-=1,i+=1,void 0===window.ats||null===window.ats||ll.rampIdEnv||ll.envelopeRetrievalInProgress?s():(ll.envelopeRetrievalInProgress=!0,window.ats.retrieveEnvelope().then(t=>{dl(t,e,n,r),ll.rampIdEnv||s()},()=>{r.warn("Failed to retrieve envelope"),ll.envelopeRetrievalInProgress=!1,s()}))},c)};s()})(e=>{i||r(e)},e=>{i||o(e)},t,n)},onError:e=>{i||o(e),ll.inProgressRampIdPromise=null}})}),s=new Promise(e=>{setTimeout(()=>{i=!0,e(null)},o)});return ll.inProgressRampIdPromise=Promise.race([a,s]).finally(()=>{ll.inProgressRampIdPromise=null}),ll.inProgressRampIdPromise},pl=(e,t,n,r=!0,o=!1)=>{if(ll.rampIdEnv)return Promise.resolve(ll.rampIdEnv);if(n){const e=n.getValue(Hc),t=n.getValue(zc);if(e&&t&&t>Date.now())return ll.rampIdEnv=e,Promise.resolve(e)}return r&&null!=t?ul(t,n,e,o):Promise.resolve(null)};let fl="",gl=null;const ml=function(e,t,n=!0,r=!1){return fl&&""!==fl?Promise.resolve(fl):n?((e,t,n)=>{if(e=Math.floor(Number(e)),gl)return gl;const r=t?2e3:3e4;let o=!1;const i=new Promise((t,r)=>{if(!e)return n.error("Missing partner ID"),void r(new Error("ID5 partner ID is required"));const i=()=>{try{if(void 0===window.ID5)return void r(new Error("ID5 object not available after script load"));const i=window.ID5.init({partnerId:e});fl=i.getUserId();const a=e=>{o||t(e)};fl?a(fl):window.ID5.init({partnerId:e}).onAvailable(function(t){fl=t.getUserId(),fl?a(fl):window.ID5.init({partnerId:e}).onAvailable(function(e){fl=e.getUserId(),fl?a(fl):(n.error("Failed to get ID5 ID after all retries"),a(null))})},1e3)}catch(e){n.error("Error during ID5 initialization",e),r(e)}};void 0!==window.ID5?i():ke("https://www.everestjs.net/static/id5-api.js",{onLoad:i,onError:e=>{n.error("Script loading failed",e),r(e)}})}),a=new Promise(e=>{setTimeout(()=>{o=!0,e(null)},r)});return gl=Promise.race([i,a]).finally(()=>{gl=null}),gl})(t,r,e).then(e=>e).catch(t=>{throw e.error("Failed to get ID5 ID",t),t}):Promise.resolve(null)},hl=()=>{const e=rt.parse(window.location.search);return{skwcid:e.s_kwcid,efid:e.ef_id}},yl=e=>e&&Array.isArray(e)?e.filter(e=>e&&!0===e.enabled&&e.advertiserId).map(e=>e.advertiserId).join(", "):"",vl=(e,t,n,r,o=!1)=>{const i=n.getValue($c);let a=null;const s=n.getValue(Vc);s&&s>Date.now()&&(a=n.getValue(Qc));const c={advertising:{...i?.click_time&&{lastSearchClick:i.click_time},...a&&{lastDisplayClick:a},stitchIds:{...e[Jc]&&{surferId:e[Jc]},...e[Gc]&&{id5:e[Gc]},...e[Hc]&&{rampIdEnv:e[Hc]},ipAddress:"DUMMY_IP_ADDRESS"},advIds:yl(r.advertiserSettings),...o&&{eventType:Xc}}};return t.mergeQuery(c),t},wl=(e,t)=>{const n=Date.now(),r=t.getValue(`${e}_last_conversion`);return Boolean(r&&n-r<18e5)},bl=(e,t,n,r)=>{const o={};return wl(Jc,n)||(o.surferId=rl(n,r,!0).catch(()=>null)),t.id5PartnerId&&t.dspEnabled&&!wl(Gc,n)&&(o.id5Id=ml(e,t.id5PartnerId).catch(()=>null)),t.rampIdJSPath&&t.dspEnabled&&!wl(Hc,n)&&(o.rampId=pl(e,t.rampIdJSPath,n,!0).catch(()=>null)),o};async function El({eventManager:e,cookieManager:t,logger:n,componentConfig:r,adConversionHandler:o,getBrowser:i}){const a={},s={},c=async()=>{if(i=a,c=s,!Object.entries(i).some(([e])=>!c[e]))return null;var i,c;const l=Object.keys(a);try{const i=vl(a,e.createEvent(),t,r,!0),c={eventType:Xc,timestamp:(new Date).toISOString()};i.setUserXdm(c);const d=await o.trackAdConversion({event:i});return((e,t,n,r)=>{const o=Date.now();e.forEach(e=>{t[e]=!0,n.setValue(`${e}_last_conversion`,o),r.info("Ad conversion submitted successfully".replace("{0}",e))}),n.setValue(qc,o)})(l,s,t,n),d}catch(e){return n.error(Kc,e),null}},l=bl(n,r,t,i);if(0===Object.keys(l).length)return[];const d=Object.entries(l).map(([e,t])=>t.then(t=>{if(t)return a[e]=t,c()}).catch(t=>(n.error("Unable to obtain ad identity".replace("{0}",e),t),null)));return Promise.allSettled(d)}const Il=({eventManager:e,cookieManager:t,adConversionHandler:n,logger:r,componentConfig:o,getBrowser:i})=>{const a=o?.advertiserSettings?yl(o.advertiserSettings):"";return async()=>{const{skwcid:s,efid:c}=hl(),l=!(!s&&!c);try{if(l)return async function({eventManager:e,cookieManager:t,adConversionHandler:n,logger:r,skwcid:o,efid:i}){r.info("Processing ad conversion",{skwcid:o,efid:i});const a=e.createEvent();if(void 0!==o&&void 0!==i&&o.startsWith("AL!")){const e={click_time:Date.now(),...void 0!==o&&{skwcid:o},...void 0!==i&&{efid:i}};t.setValue($c,e)}const s={_experience:{adcloud:{conversionDetails:{...void 0!==o&&{[Wc]:o},...void 0!==i&&{[Yc]:i}}}},eventType:"advertising.enrichment_ct",timestamp:(new Date).toISOString()};a.setUserXdm(s),t.setValue(qc),t.setValue("lastConversionTimeExpires",Date.now()+78624e5);try{return await n.trackAdConversion({event:a})}catch(e){throw r.error(Kc,e),e}}({eventManager:e,cookieManager:t,adConversionHandler:n,logger:r,skwcid:s,efid:c});a&&El({eventManager:e,cookieManager:t,logger:r,componentConfig:o,adConversionHandler:n,getBrowser:i}).catch(e=>r.error("Error in view through:",e))}catch(e){r.error("Error in sendAdConversion:",e)}}};async function Sl({cookieManager:e,logger:t,event:n,componentConfig:r,advertising:o,getBrowser:i}){const{skwcid:a,efid:s}=hl(),c=!(!a||!s);if(!((e=>![Mn,Ln].includes(e?.handleAdvertisingData?.toLowerCase()))(o)||c||wl(Jc,e)&&wl(Gc,e)&&wl(Hc,e)))try{const a=(e=>e?.handleAdvertisingData?.toLowerCase()===Ln)(o);let s=null;i&&i()===Me||(s=pl(t,r.rampIdJSPath,e,a,a));const[c,l,d]=await Promise.allSettled([rl(e,i,a),ml(t,r.id5PartnerId,a,a),s]),u={};if("fulfilled"===c.status&&c.value&&!wl(Jc,e)&&(u.surferId=c.value),"fulfilled"===l.status&&l.value&&!wl(Gc,e)&&(u.id5Id=l.value),"fulfilled"===d.status&&d.value&&!wl(Hc,e)&&(u.rampId=d.value),0===Object.keys(u).length&&(wl(Jc,e)||wl(Gc,e)||wl(Hc,e)))return;vl(u,n,e,r)}catch(e){t.error("Error in onBeforeSendEvent hook:",e)}}const Cl=sn({advertising:sn({id5PartnerId:cn(),rampIdJSPath:cn(),dspEnabled:tn(),advertiserSettings:en(sn({advertiserId:cn().required(),enabled:tn().required()}).noUnknownFields())}).noUnknownFields()}),kl=({orgId:e,logger:t})=>{const n=te({logger:t,cookieJar:W}),r=(t,n=!0)=>n?Re(e,t):t,o=(e=30)=>new Date(Date.now()+60*e*1e3),i=(e,o=!0)=>{try{const t=r(e,o),i=n.get(t);return i?(e=>{try{if(e?.startsWith("%7B")||e?.startsWith("{"))return JSON.parse(decodeURIComponent(e))}catch{}return e})(i):null}catch(n){return t.error(`Error reading cookie: ${e}`,n),null}},a=(e,o,i={},a=!0)=>{try{const t=r(e,a),s=(e=>"object"==typeof e&&null!==e?encodeURIComponent(JSON.stringify(e)):e)(o);return n.set(t,s,i),!0}catch(n){return t.error(`Error writing cookie: ${e}`,n),!1}};return{setValue:(e,t,n={})=>{const r={...i(Bc)||{},[e]:t};return a(Bc,r,{expires:o(527040),...n})},getValue:e=>(i(Bc)||{})[e]}},Tl=({logger:e,config:t,eventManager:n,sendEdgeNetworkRequest:r,consent:o,getBrowser:i})=>{const a=kl({orgId:t.orgId,logger:e}),s=(({sendEdgeNetworkRequest:e,consent:t,createDataCollectionRequest:n,createDataCollectionRequestPayload:r,logger:o})=>({trackAdConversion:({event:i})=>{const a=r();a.addEvent(i),i.finalize();const s=n({payload:a});return t.awaitConsent().then(()=>e({request:s}).then(()=>({success:!0})).catch(e=>{throw o.error("Failed to send ad conversion event",e),e}))}}))({eventManager:n,sendEdgeNetworkRequest:r,consent:o,createDataCollectionRequest:gn,createDataCollectionRequestPayload:yn,logger:e});return(({logger:e,config:t,eventManager:n,cookieManager:r,adConversionHandler:o,getBrowser:i})=>{const a=t.advertising,s=Il({eventManager:n,cookieManager:r,adConversionHandler:o,logger:e,componentConfig:a,getBrowser:i});return{lifecycle:{onComponentsRegistered:()=>s(),onBeforeEvent:({event:t,advertising:n={}})=>Sl({cookieManager:r,logger:e,event:t,componentConfig:a,advertising:n,getBrowser:i})}}})({logger:e,config:t,eventManager:n,cookieManager:a,adConversionHandler:s,getBrowser:i})};Tl.namespace="Advertising",Tl.configValidators=Cl;const Nl=async({vapidPublicKey:e,window:t})=>{if(!("serviceWorker"in t.navigator))throw new Error("Service workers are not supported in this browser.");if(!("PushManager"in t)||!("Notification"in t))throw new Error("Push notifications are not supported in this browser.");if("granted"!==t.Notification.permission)throw new Error("The user has not given permission to send push notifications.");const n=await t.navigator.serviceWorker.getRegistration();if(!n)throw new Error("No service worker registration was found.");if(!e)throw new Error("No VAPID public key was provided.");const r={userVisibleOnly:!0,applicationServerKey:J(e)};try{const e=await n.pushManager.subscribe(r);return{endpoint:e.endpoint,keys:{p256dh:H(new Uint8Array(e.getKey("p256dh")),{urlSafe:!0}),auth:H(new Uint8Array(e.getKey("auth")),{urlSafe:!0})}}}catch(r){const o=await n.pushManager.getSubscription();if(!o)throw r;if(!await o.unsubscribe())throw r;return Nl({vapidPublicKey:e,window:t})}},Al=Nl,Dl="config",Ol="alloyConfig";async function _l(e,t){try{const i=await(n="alloyPushNotifications",r=1,o=e=>{e.objectStoreNames.contains(Dl)||e.createObjectStore(Dl,{keyPath:"id"})},new Promise((e,t)=>{const i=indexedDB.open(n,r);i.onerror=()=>t(i.error),i.onsuccess=()=>e(i.result),i.onupgradeneeded=e=>{const t=e.target.result;o&&o(t)}})),a=await((e,t,n)=>new Promise((r,o)=>{const i=e.transaction([t],"readonly").objectStore(t).get(n);i.onerror=()=>o(i.error),i.onsuccess=()=>r(i.result)}))(i,Dl,Ol),s={...a||{},...e,id:Ol,timestamp:Date.now()};await((e,t,n)=>new Promise((r,o)=>{const i=e.transaction([t],"readwrite").objectStore(t).put(n);i.onerror=()=>o(i.error),i.onsuccess=()=>r(i.result)}))(i,Dl,s),i.close(),t.info("Successfully saved web SDK config to IndexedDB",s)}catch(e){t.error("Failed to save config to IndexedDB",{error:e})}var n,r,o}const Pl="subscriptionDetails",xl=async({config:{vapidPublicKey:e,appId:t},storage:n,logger:r,sendEdgeNetworkRequest:o,consent:i,eventManager:a,identity:s,window:c})=>{await s.awaitIdentity();const l=s.getEcidFromCookie(),d=await Al({vapidPublicKey:e,window:c}),u=JSON.stringify(it(d)),p=`${l}${u}`;if(p===n.getItem(Pl))return void r.info("Subscription details have not changed. Not sending to the server.");n.setItem(Pl,p);const f=await(async({ecid:e,eventManager:t,serializedPushSubscriptionDetails:n,appId:r})=>{const o=t.createEvent();o.setUserData({pushNotificationDetails:[{appID:r,token:n,platform:"web",denylisted:!1,identity:{namespace:{code:"ECID"},id:e}}]}),o.finalize();const i=yn();return i.addEvent(o),i})({eventManager:a,ecid:l,serializedPushSubscriptionDetails:u,appId:t}),g=(({payload:e})=>fn({payload:e,getAction:()=>"interact",getUseSendBeacon:()=>!1}))({payload:f});await i.awaitConsent(),await o({request:g}),await _l({ecid:l},r)},Rl=({orgId:e,pushNotifications:{vapidPublicKey:t,appId:n,trackingDatasetId:r}={vapidPublicKey:void 0,appId:void 0,trackingDatasetId:void 0}})=>e&&t&&n&&r,Ll=({createNamespacedStorage:e,eventManager:t,config:n,logger:r,consent:o,identity:i,getBrowser:a,sendEdgeNetworkRequest:s})=>({lifecycle:{async onComponentsRegistered(){if(Rl(n)){const{datastreamId:e,edgeDomain:t,edgeBasePath:o,pushNotifications:{trackingDatasetId:i}}=n;await _l({datastreamId:e,edgeDomain:t,edgeBasePath:o,datasetId:i,browser:a()},r)}}},commands:{sendPushSubscription:{run:async()=>{if(!Rl(n))throw new Error("Push notifications module is not configured.");const{orgId:a,pushNotifications:{vapidPublicKey:c,appId:l}={vapidPublicKey:void 0,appId:void 0}}=n||{},d=e(`${xe(a)}.pushNotifications.`);return xl({config:{vapidPublicKey:c,appId:l},storage:d.persistent,logger:r,sendEdgeNetworkRequest:s,consent:o,eventManager:t,identity:i,window})},optionsValidator:sn({}).noUnknownFields()}}});Ll.namespace="Push Notifications",Ll.configValidators=sn({pushNotifications:sn({vapidPublicKey:cn().required(),appId:cn().required(),trackingDatasetId:cn().required()}).noUnknownFields()});const{console:Ml}=window;Xe(window);const Ul="optimization-client";function Fl(){try{return window.experimentation?.gridiron?window.experimentation.gridiron.get(Ul):null}catch{return null}}function jl(e,t){const n=Fl();return n?.bucketing?.getBucket?n.bucketing.getBucket(e,t):((e,t="nike")=>{const n=(e+":"+t).toLowerCase(),r=a.x86.hash32(n,17786)/s;return Math.floor(1e4*r)/100})(e,t)}function Bl(e,t){const n=Fl();return n?.enrichThrowData?n.enrichThrowData(e,t):r(e,t)}const $l=(e,n)=>{const r=Fl();return r?.backoffTimer?.runAsync?r.backoffTimer.runAsync(e,n):t.runAsync(e,n)};function ql(e,t){const n=Fl();return n?.storage?.open?n.storage.open(e,t):async function(e,t){if(!e.dbName)throw new l(c.DB_NAME_REQUIRED);if(!e.dbVersion)throw new l(c.DB_VERSION_REQUIRED);return new Promise((n,o)=>{try{let i=!0,a=null;e.timeout&&(a=setTimeout(()=>{i&&(i=!1,o(new l(c.DB_TIMEOUT)))},e.timeout));const s=()=>{i=!1,a&&(clearTimeout(a),a=null)},p=window.indexedDB.open(e.dbName,e.dbVersion);p.onsuccess=async t=>{s();const i=t.target.result,a=new d(i,e);if(e.storeTTL)for(const t in e.storeTTL)try{await u(i,t,e.storeTTL[t])}catch(e){return void o(r(new l(c.EXPIRED_DATA_STORE_CLEANUP_FAILED),{storeName:t}))}n(a)},p.onerror=()=>{s(),o(new l(c.CONNECTION_FAILED))},p.onblocked=()=>{s(),o(new l(c.DB_BLOCKED))},p.onupgradeneeded=async n=>{const r=n.target.result,o=r.version,i=e.dbVersion;t&&t(r,o,i)}}catch(e){o(new l(e instanceof Error?e.message:c.UNKNOWN_ERROR))}})}(e,t)}const Vl=async()=>{const[e,t,n,r,o]=await Promise.all([$l(()=>window.webShellClient),$l(()=>window.NikePrivacy),$l(()=>window.analyticsClient),$l(()=>(async()=>window.webShellClient?.analytics?.isInitialized?await $l(()=>window.webShellClient.analytics.isInitialized())?{status:!0}:{status:!1,error:"Analytics is not initialized"}:{status:!1,error:"Analytics client not present"})()),$l(()=>window.webShellClient.analytics?.track)]);return e?t?n?r||o?o?{status:!0}:(P.error("Analytics Track is not available"),{status:!1,error:"Analytics Track is not available"}):(P.error("Analytics is not initialized & Analytics Track is not available"),{status:!1,error:"Analytics is not initialized & Analytics Track is not available"}):(P.warn("Analytics Client is not available"),{status:!1,error:"Analytics Client is not available"}):(P.warn("Nike Privacy is not available"),{status:!1,error:"Nike Privacy is not available"}):(P.error("WebShellClient is not available"),{status:!1,error:"WebShellClient is not available"})},zl=async e=>{try{return e&&e&&(r=e.locale)&&"string"==typeof r.country&&"string"==typeof r.language&&"string"==typeof r.currency&&"string"==typeof r.langRegion&&(n=e.user)&&(void 0===n.upmId||"string"==typeof n.upmId)&&"string"==typeof n.fpid&&(t=e.privacy)&&"boolean"==typeof t.hasConsent?{status:!0}:(P?.error("Invalid context",{data:e}),{status:!1,error:"Invalid context"})}catch(t){return P.error("Invalid context",{data:e}),{status:!1,error:JSON.stringify(t)}}var t,n,r},Jl=()=>{const{country:e,language:t}=window.webShellClient.locale.get();return{country:e?.toUpperCase(),language:t}},Hl=async()=>({track:window.analyticsClient.track});function Gl(e){const t=new RegExp(`(^| )${e}=([^;]+)`),n=document.cookie.match(t);return n?n[2]:null}const Xl=async()=>{const e=await(window.webShellClient?.identity.getUserProfile());return{upmId:e?.upmId,registeredCountry:e?.registeredCountry,fpid:Gl("ni_d")}},Wl=async e=>{try{if(e){const t=await zl(e);return t.status?{status:!0,...e}:{status:!1,error:t.error}}return await(async()=>{try{const{status:e,error:t}=await Vl();return e?{locale:Jl(),user:await Xl(),analytics:await Hl(),status:e}:{status:e,error:t||"Context build failed"}}catch(e){return{status:!1,error:`Context build failed with ${JSON.stringify(e)}`}}})()}catch(e){return{status:!1,error:`error getting context. ${JSON.stringify(e)}`}}};class Yl{constructor(e){this._locations=[],this._alloy=e}}const Kl="nikecom",Ql=e=>({locale:{language:e?.language||"en",country:e?.country||"us"},langRegion:e?.langRegion||"en-US",currency:e?.currency||"USD"}),Zl=()=>Ql(window.webShellClient?.locale?.get());async function ed(e){if(e?.locale?.country)return e.locale.country;const t=window.webShellClient;if(await t.identity.getIsLoggedIn()){const{registeredCountry:e}=await t.identity.getUserProfile();return e}return t.userLocation.current.country}const td=(e,t)=>{try{const n=function(){const e=Fl();return e?.page?.getPageType?e.page.getPageType():f()}(),{pageName:r,pageDetail:o}=((e,t)=>{let n,r;const o=e.location?.pathname||"";try{switch(t){case"pdp":r=document.querySelector("#pdp_product_title")?.innerText.toLowerCase();break;case"pw":r=e.__NEXT_DATA__?.props?.pageProps?.initialState?.Wall?.facetNav?.analytics?.legacyPageName?.toLowerCase()??void 0;break;case"homepage":n=e.__NEXT_DATA__?.props?.pageProps?.navConfig?.pageDetail,r=n;break;case"landing page":n=e.__NEXT_DATA__?.props?.pageProps?.navConfig?.globalNavPageName,r=e.__NEXT_DATA__?.props?.pageProps?.navConfig?.pageDetail;break;case"cart":n="cart",r="view";break;case"help":n="help";const t=o.split("/");2===t.length?r="home":o.includes("/search/")?r="search":o.includes("/a/")&&(r=`article>${t[t.length-1]}`);break;case"checkout":r="shipping";break;case"onsite search":r=e.__NEXT_DATA__?.props?.pageProps?.initialState?.Wall?.pageData?.totalResources?"results found":"no search results";break;case"member":n="member",r=["inbox","profile","settings"].find(e=>o.includes(e))}return{pageName:n,pageDetail:r}}catch(e){return P.error("Failed to get page name and detail",{error:"object"==typeof e&&null!==e?e:{message:String(e)}}),{pageName:void 0,pageDetail:void 0}}})(e,n),i=(e=>{let t;switch(e){case"pdp":case"homepage":case"landing page":case"cart":case"checkout":t=e;break;case"pw":t="product wall"}return t})(n),{locale:a,langRegion:s,currency:c}=t?Ql(t):Zl(),l=(e=>({domain:"www.nike.com",backendPlatform:"cloud",...e&&{name:e}}))(i),d=((e,t,n)=>{const r={experienceType:Kl,...t&&{pageType:t},...n&&{pageDetail:n}};return"landing page"===t||"homepage"===t?{...r,...e&&{pageName:`${Kl}>${e}`}}:{...r,...n&&{pageName:`${Kl}>${t}>${n}`}}})(r,n,o);return{app:l,view:d,currency:c,language:s,locale:a}}catch(e){return P.error("Failed to get common properties",{error:"object"==typeof e&&null!==e?e:{message:String(e)}}),{app:{backendPlatform:"",domain:"",name:"",version:""},view:{experienceType:"",pageName:"",pageType:"",pageDetail:""},language:"",locale:{country:"",language:""},currency:""}}};function nd(){const e=L().bypassPrivacy;return Boolean(e)}const rd=["adtargeting_behavioralevents","performance","personalization_targeted_comms"],od=["au","id","in","jp","kr","my","nz","ph","sg","th","tw","vn","mx"];async function id(e,t){return await async function(e){if(void 0!==e?.privacy?.hasConsent)return e.privacy.hasConsent;const t=window.NikePrivacy;if(!t?.isEnabled)return!1;await t.isInitialized();const n=window.NikePrivacy?.permissions.get();if(n){const e=n.flatMap(({category:e,isEnabled:t})=>t?[e.toLocaleLowerCase()]:[]);return rd.every(t=>e.includes(t))}return!1}(t)||function(e){const t=e.toLocaleLowerCase();return od.includes(t)}(e)}async function ad(e,t){let n=!1;try{if(nd())return V(),!0;if(void 0!==t?.privacy?.hasConsent)n=t.privacy.hasConsent;else{const e=await ed();n=await id(e)}n||P.warn("Appropriate UGP permissions have not been given. Cannot fetch Adobe Target locations.",{errorMessage:`Appropriate UGP permissions have not been given.${JSON.stringify(t)}`,locations:e})}catch(t){return"Initialize guest error"===String("object"==typeof t&&null!==t&&"message"in t?t.message:t)?P.warn("Failed to find locations",{error:"object"==typeof t&&null!==t?t:{message:String(t)},locations:e.length?e:null}):P.error("Failed to find locations",{error:"object"==typeof t&&null!==t?t:{message:String(t)},locations:e.length?e:null}),!1}return n}const sd=async(e,t)=>{if(void 0!==window.alloy)return{status:!0};const n=t||await Wl();return await ad(e,n)?(await(async()=>void 0!==window.alloy?{status:!0}:new Promise(e=>{const t=document.createElement("script");return t.src="https://www.nike.com/assets/vendor/adobe-alloy/2.32.1/alloy.js",t.async=!0,t.id="alloy-from-optclient",t.onload=()=>{e({status:!0})},t.onerror=()=>{P.error("Alloy Inject failed"),e({status:!1,error:"Alloy Inject failed"})},document.head.appendChild(t),{status:!0}}))(),{status:!0}):{status:!1,error:"Alloy fallback failed due to privacy permissions"}};class cd{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,r=n.makeReadOptions(t);return n.readMessage(this,r.readerFactory(e),e.byteLength,r),this}fromJson(e,t){const n=this.getType(),r=n.runtime.json,o=r.makeReadOptions(t);return r.readMessage(n,e,o,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(e){throw new Error(`cannot decode ${this.getType().typeName} from JSON: ${e instanceof Error?e.message:String(e)}`)}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),r=n.writerFactory();return t.writeMessage(this,r,n),r.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null==e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function ld(e,t){if(!e)throw new Error(t)}function dd(e){if("number"!=typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function ud(e){if("number"!=typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function pd(e){if("number"!=typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}function fd(){let e=0,t=0;for(let n=0;n<28;n+=7){let r=this.buf[this.pos++];if(e|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,!(128&n))return this.assertBounds(),[e,t];for(let n=3;n<=31;n+=7){let r=this.buf[this.pos++];if(t|=(127&r)<<n,!(128&r))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function gd(e,t,n){for(let r=0;r<28;r+=7){const o=e>>>r,i=!(o>>>7==0&&0==t),a=255&(i?128|o:o);if(n.push(a),!i)return}const r=e>>>28&15|(7&t)<<4,o=!!(t>>3);if(n.push(255&(o?128|r:r)),o){for(let e=3;e<31;e+=7){const r=t>>>e,o=!(r>>>7==0),i=255&(o?128|r:r);if(n.push(i),!o)return}n.push(t>>>31&1)}}const md=4294967296;function hd(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let r=0,o=0;function i(t,i){const a=Number(e.slice(t,i));o*=n,r=r*n+a,r>=md&&(o+=r/md|0,r%=md)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),t?wd(r,o):vd(r,o)}function yd(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(md*t+e);const n=16777215&(e>>>24|t<<8),r=t>>16&65535;let o=(16777215&e)+6777216*n+6710656*r,i=n+8147497*r,a=2*r;const s=1e7;return o>=s&&(i+=Math.floor(o/s),o%=s),i>=s&&(a+=Math.floor(i/s),i%=s),a.toString()+bd(i)+bd(o)}function vd(e,t){return{lo:0|e,hi:0|t}}function wd(e,t){return t=~t,e?e=1+~e:t+=1,vd(e,t)}const bd=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Ed(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Id(){let e=this.buf[this.pos++],t=127&e;if(!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,!(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,!(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let t=5;128&e&&t<10;t++)e=this.buf[this.pos++];if(128&e)throw new Error("invalid varint");return this.assertBounds(),t>>>0}const Sd=function(){const e=new DataView(new ArrayBuffer(8));if("function"==typeof BigInt&&"function"==typeof e.getBigInt64&&"function"==typeof e.getBigUint64&&"function"==typeof e.setBigInt64&&"function"==typeof e.setBigUint64&&("object"!=typeof process||"object"!=typeof process.env||"1"!==process.env.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),r=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const r="bigint"==typeof e?e:BigInt(e);if(r>n||r<t)throw new Error(`int64 invalid: ${e}`);return r},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>o||t<r)throw new Error(`uint64 invalid: ${e}`);return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>ld(/^-?[0-9]+$/.test(e),`int64 invalid: ${e}`),n=e=>ld(/^[0-9]+$/.test(e),`uint64 invalid: ${e}`);return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),hd(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),hd(e)),dec:(e,t)=>function(e,t){let n=vd(e,t);const r=2147483648&n.hi;r&&(n=wd(n.lo,n.hi));const o=yd(n.lo,n.hi);return r?"-"+o:o}(e,t),uDec:(e,t)=>yd(e,t)}}(),Cd=Symbol("@bufbuild/protobuf/enum-type");function kd(e){const t=e[Cd];return ld(t,"missing enum type on enum object"),t}function Td(e,t,n,r){e[Cd]=Nd(t,n.map(t=>({no:t.no,name:t.name,localName:e[t.no]})),r)}function Nd(e,t,n){const r=Object.create(null),o=Object.create(null),i=[];for(const e of t){const t=Dd(e);i.push(t),r[e.name]=t,o[e.no]=t}return{typeName:e,values:i,findName:e=>r[e],findNumber:e=>o[e]}}function Ad(e,t,n){const r={};for(const e of t){const t=Dd(e);r[t.localName]=t.no,r[t.no]=t.localName}return Td(r,e,t,n),r}function Dd(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}var Od,_d;function Pd(e,t,n){if(t===n)return!0;if(e==Od.BYTES){if(!(t instanceof Uint8Array&&n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Od.UINT64:case Od.FIXED64:case Od.INT64:case Od.SFIXED64:case Od.SINT64:return t==n}return!1}function xd(e,t){switch(e){case Od.BOOL:return!1;case Od.UINT64:case Od.FIXED64:case Od.INT64:case Od.SFIXED64:case Od.SINT64:return 0==t?Sd.zero:"0";case Od.DOUBLE:case Od.FLOAT:return 0;case Od.BYTES:return new Uint8Array(0);case Od.STRING:return"";default:return 0}}function Rd(e,t){switch(e){case Od.BOOL:return!1===t;case Od.STRING:return""===t;case Od.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}function Ld(e){const t=e.field.localName,n=Object.create(null);return n[t]=function(e){const t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return xd(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Od||(Od={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(_d||(_d={}));let Md="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Ud=[];for(let e=0;e<Md.length;e++)Ud[Md[e].charCodeAt(0)]=e;Ud["-".charCodeAt(0)]=Md.indexOf("+"),Ud["_".charCodeAt(0)]=Md.indexOf("/");const Fd={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,r=new Uint8Array(t),o=0,i=0,a=0;for(let t=0;t<e.length;t++){if(n=Ud[e.charCodeAt(t)],void 0===n)switch(e[t]){case"=":i=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:a=n,i=1;break;case 1:r[o++]=a<<2|(48&n)>>4,a=n,i=2;break;case 2:r[o++]=(15&a)<<4|(60&n)>>2,a=n,i=3;break;case 3:r[o++]=(3&a)<<6|n,i=0}}if(1==i)throw Error("invalid base64 string.");return r.subarray(0,o)},enc(e){let t,n="",r=0,o=0;for(let i=0;i<e.length;i++)switch(t=e[i],r){case 0:n+=Md[t>>2],o=(3&t)<<4,r=1;break;case 1:n+=Md[o|t>>4],o=(15&t)<<2,r=2;break;case 2:n+=Md[o|t>>6],n+=Md[63&t],r=0}return r&&(n+=Md[o],n+="=",1==r&&(n+="=")),n}};function jd(e,t,n){qd(t,e);const r=t.runtime.bin.makeReadOptions(n),o=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[i,a]=Ld(t);for(const e of o)t.runtime.bin.readField(i,r.readerFactory(e.data),t.field,e.wireType,r);return a()}function Bd(e,t,n,r){qd(t,e);const o=t.runtime.bin.makeReadOptions(r),i=t.runtime.bin.makeWriteOptions(r);if($d(e,t)){const n=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);e.getType().runtime.bin.discardUnknownFields(e);for(const t of n)e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}const a=i.writerFactory();let s=t.field;s.opt||s.repeated||"enum"!=s.kind&&"scalar"!=s.kind||(s=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(s,n,a,i);const c=o.readerFactory(a.finish());for(;c.pos<c.len;){const[t,n]=c.tag(),r=c.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,r)}}function $d(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function qd(e,t){ld(e.extendee.typeName==t.getType().typeName,`extension ${e.typeName} can only be applied to message ${e.extendee.typeName}`)}function Vd(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[n]:"enum"==e.kind?t[n]!==e.T.values[0].no:!Rd(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function zd(e,t){const n=e.localName,r=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=r?e.T.values[0].no:void 0;break;case"scalar":t[n]=r?xd(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function Jd(e,t){if(null===e||"object"!=typeof e)return!1;if(!Object.getOwnPropertyNames(cd.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;const n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function Hd(e,t){return Jd(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Od.DOUBLE,Od.FLOAT,Od.INT64,Od.UINT64,Od.INT32,Od.UINT32,Od.BOOL,Od.STRING,Od.BYTES;const Gd={ignoreUnknownFields:!1},Xd={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Wd(e){return e?Object.assign(Object.assign({},Gd),e):Gd}function Yd(e){return e?Object.assign(Object.assign({},Xd),e):Xd}const Kd=Symbol(),Qd=Symbol();function Zd(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":`"${e.split('"').join('\\"')}"`;default:return String(e)}}function eu(e,t,n,r,o){let i=n.localName;if(n.repeated){if(ld("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw new Error(`cannot decode field ${o.typeName}.${n.name} from JSON: ${Zd(t)}`);const a=e[i];for(const e of t){if(null===e)throw new Error(`cannot decode field ${o.typeName}.${n.name} from JSON: ${Zd(e)}`);switch(n.kind){case"message":a.push(n.T.fromJson(e,r));break;case"enum":const t=ru(n.T,e,r.ignoreUnknownFields,!0);t!==Qd&&a.push(t);break;case"scalar":try{a.push(nu(n.T,e,n.L,!0))}catch(t){let r=`cannot decode field ${o.typeName}.${n.name} from JSON: ${Zd(e)}`;throw t instanceof Error&&t.message.length>0&&(r+=`: ${t.message}`),new Error(r)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw new Error(`cannot decode field ${o.typeName}.${n.name} from JSON: ${Zd(t)}`);const a=e[i];for(const[e,i]of Object.entries(t)){if(null===i)throw new Error(`cannot decode field ${o.typeName}.${n.name} from JSON: map value null`);let s;try{s=tu(n.K,e)}catch(e){let r=`cannot decode map key for field ${o.typeName}.${n.name} from JSON: ${Zd(t)}`;throw e instanceof Error&&e.message.length>0&&(r+=`: ${e.message}`),new Error(r)}switch(n.V.kind){case"message":a[s]=n.V.T.fromJson(i,r);break;case"enum":const e=ru(n.V.T,i,r.ignoreUnknownFields,!0);e!==Qd&&(a[s]=e);break;case"scalar":try{a[s]=nu(n.V.T,i,_d.BIGINT,!0)}catch(e){let r=`cannot decode map value for field ${o.typeName}.${n.name} from JSON: ${Zd(t)}`;throw e instanceof Error&&e.message.length>0&&(r+=`: ${e.message}`),new Error(r)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:i},i="value"),n.kind){case"message":const a=n.T;if(null===t&&"google.protobuf.Value"!=a.typeName)return;let s=e[i];Jd(s)?s.fromJson(t,r):(e[i]=s=a.fromJson(t,r),a.fieldWrapper&&!n.oneof&&(e[i]=a.fieldWrapper.unwrapField(s)));break;case"enum":const c=ru(n.T,t,r.ignoreUnknownFields,!1);switch(c){case Kd:zd(n,e);break;case Qd:break;default:e[i]=c}break;case"scalar":try{const r=nu(n.T,t,n.L,!1);if(r===Kd)zd(n,e);else e[i]=r}catch(e){let r=`cannot decode field ${o.typeName}.${n.name} from JSON: ${Zd(t)}`;throw e instanceof Error&&e.message.length>0&&(r+=`: ${e.message}`),new Error(r)}}}function tu(e,t){if(e===Od.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return nu(e,t,_d.BIGINT,!0).toString()}function nu(e,t,n,r){if(null===t)return r?xd(e,n):Kd;switch(e){case Od.DOUBLE:case Od.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const r=Number(t);if(Number.isNaN(r))break;if(!Number.isFinite(r))break;return e==Od.FLOAT&&pd(r),r;case Od.INT32:case Od.FIXED32:case Od.SFIXED32:case Od.SINT32:case Od.UINT32:let o;if("number"==typeof t?o=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(o=Number(t)),void 0===o)break;return e==Od.UINT32||e==Od.FIXED32?ud(o):dd(o),o;case Od.INT64:case Od.SFIXED64:case Od.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;const i=Sd.parse(t);return n?i.toString():i;case Od.FIXED64:case Od.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;const a=Sd.uParse(t);return n?a.toString():a;case Od.BOOL:if("boolean"!=typeof t)break;return t;case Od.STRING:if("string"!=typeof t)break;try{encodeURIComponent(t)}catch(e){throw new Error("invalid UTF8")}return t;case Od.BYTES:if(""===t)return new Uint8Array(0);if("string"!=typeof t)break;return Fd.dec(t)}throw new Error}function ru(e,t,n,r){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:r?e.values[0].no:Kd;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const r=e.findName(t);if(void 0!==r)return r.no;if(n)return Qd}throw new Error(`cannot decode enum ${e.typeName} from JSON: ${Zd(t)}`)}function ou(e){return!(!e.repeated&&"map"!=e.kind)||!e.oneof&&("message"!=e.kind&&(!e.opt&&!e.req))}function iu(e,t,n){if("map"==e.kind){ld("object"==typeof t&&null!=t);const r={},o=Object.entries(t);switch(e.V.kind){case"scalar":for(const[t,n]of o)r[t.toString()]=su(e.V.T,n);break;case"message":for(const[e,t]of o)r[e.toString()]=t.toJson(n);break;case"enum":const t=e.V.T;for(const[e,i]of o)r[e.toString()]=au(t,i,n.enumAsInteger)}return n.emitDefaultValues||o.length>0?r:void 0}if(e.repeated){ld(Array.isArray(t));const r=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)r.push(su(e.T,t[n]));break;case"enum":for(let o=0;o<t.length;o++)r.push(au(e.T,t[o],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)r.push(t[e].toJson(n))}return n.emitDefaultValues||r.length>0?r:void 0}switch(e.kind){case"scalar":return su(e.T,t);case"enum":return au(e.T,t,n.enumAsInteger);case"message":return Hd(e.T,t).toJson(n)}}function au(e,t,n){var r;if(ld("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;const o=e.findNumber(t);return null!==(r=null==o?void 0:o.name)&&void 0!==r?r:t}function su(e,t){switch(e){case Od.INT32:case Od.SFIXED32:case Od.SINT32:case Od.FIXED32:case Od.UINT32:return ld("number"==typeof t),t;case Od.FLOAT:case Od.DOUBLE:return ld("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case Od.STRING:return ld("string"==typeof t),t;case Od.BOOL:return ld("boolean"==typeof t),t;case Od.UINT64:case Od.FIXED64:case Od.INT64:case Od.SFIXED64:case Od.SINT64:return ld("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case Od.BYTES:return ld(t instanceof Uint8Array),Fd.enc(t)}}var cu;!function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(cu||(cu={}));class lu{constructor(e){this.stack=[],this.textEncoder=null!=e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;let t=new Uint8Array(e),n=0;for(let e=0;e<this.chunks.length;e++)t.set(this.chunks[e],n),n+=this.chunks[e].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(ud(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return dd(e),Ed(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){pd(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){ud(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){dd(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return dd(e),Ed(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=Sd.enc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),r=Sd.uEnc(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}int64(e){let t=Sd.enc(e);return gd(t.lo,t.hi,this.buf),this}sint64(e){let t=Sd.enc(e),n=t.hi>>31;return gd(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Sd.uEnc(e);return gd(t.lo,t.hi,this.buf),this}}class du{constructor(e,t){this.varint64=fd,this.uint32=Id,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!=t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case cu.Varint:for(;128&this.buf[this.pos++];);break;case cu.Bit64:this.pos+=4;case cu.Bit32:this.pos+=4;break;case cu.LengthDelimited:let n=this.uint32();this.pos+=n;break;case cu.StartGroup:for(;;){const[e,n]=this.tag();if(n===cu.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Sd.dec(...this.varint64())}uint64(){return Sd.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,Sd.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Sd.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Sd.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}const uu=Symbol("@bufbuild/protobuf/unknown-fields"),pu={readUnknownFields:!0,readerFactory:e=>new du(e)},fu={writeUnknownFields:!0,writerFactory:()=>new lu};function gu(e){return e?Object.assign(Object.assign({},pu),e):pu}function mu(e){return e?Object.assign(Object.assign({},fu),e):fu}function hu(e,t,n,r,o){let{repeated:i,localName:a}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=a&&delete e.value,e.case=a,a="value"),n.kind){case"scalar":case"enum":const s="enum"==n.kind?Od.INT32:n.T;let c=wu;if("scalar"==n.kind&&n.L>0&&(c=vu),i){let n=e[a];if(r==cu.LengthDelimited&&s!=Od.STRING&&s!=Od.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(c(t,s))}else n.push(c(t,s))}else e[a]=c(t,s);break;case"message":const l=n.T;i?e[a].push(yu(t,new l,o,n)):Jd(e[a])?yu(t,e[a],o,n):(e[a]=yu(t,new l,o,n),!l.fieldWrapper||n.oneof||n.repeated||(e[a]=l.fieldWrapper.unwrapField(e[a])));break;case"map":let[d,u]=function(e,t,n){const r=t.uint32(),o=t.pos+r;let i,a;for(;t.pos<o;){const[r]=t.tag();switch(r){case 1:i=wu(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=wu(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=yu(t,new e.V.T,n,void 0)}}}void 0===i&&(i=xd(e.K,_d.BIGINT));"string"!=typeof i&&"number"!=typeof i&&(i=i.toString());if(void 0===a)switch(e.V.kind){case"scalar":a=xd(e.V.T,_d.BIGINT);break;case"enum":a=e.V.T.values[0].no;break;case"message":a=new e.V.T}return[i,a]}(n,t,o);e[a][d]=u}}function yu(e,t,n,r){const o=t.getType().runtime.bin,i=null==r?void 0:r.delimited;return o.readMessage(t,e,i?r.no:e.uint32(),n,i),t}function vu(e,t){const n=wu(e,t);return"bigint"==typeof n?n.toString():n}function wu(e,t){switch(t){case Od.STRING:return e.string();case Od.BOOL:return e.bool();case Od.DOUBLE:return e.double();case Od.FLOAT:return e.float();case Od.INT32:return e.int32();case Od.INT64:return e.int64();case Od.UINT64:return e.uint64();case Od.FIXED64:return e.fixed64();case Od.BYTES:return e.bytes();case Od.FIXED32:return e.fixed32();case Od.SFIXED32:return e.sfixed32();case Od.SFIXED64:return e.sfixed64();case Od.SINT64:return e.sint64();case Od.UINT32:return e.uint32();case Od.SINT32:return e.sint32()}}function bu(e,t,n,r){ld(void 0!==t);const o=e.repeated;switch(e.kind){case"scalar":case"enum":let i="enum"==e.kind?Od.INT32:e.T;if(o)if(ld(Array.isArray(t)),e.packed)!function(e,t,n,r){if(!r.length)return;e.tag(n,cu.LengthDelimited).fork();let[,o]=Cu(t);for(let t=0;t<r.length;t++)e[o](r[t]);e.join()}(n,i,e.no,t);else for(const r of t)Su(n,i,e.no,r);else Su(n,i,e.no,t);break;case"message":if(o){ld(Array.isArray(t));for(const o of t)Iu(n,r,e,o)}else Iu(n,r,e,t);break;case"map":ld("object"==typeof t&&null!=t);for(const[o,i]of Object.entries(t))Eu(n,r,e,o,i)}}function Eu(e,t,n,r,o){e.tag(n.no,cu.LengthDelimited),e.fork();let i=r;switch(n.K){case Od.INT32:case Od.FIXED32:case Od.UINT32:case Od.SFIXED32:case Od.SINT32:i=Number.parseInt(r);break;case Od.BOOL:ld("true"==r||"false"==r),i="true"==r}switch(Su(e,n.K,1,i),n.V.kind){case"scalar":Su(e,n.V.T,2,o);break;case"enum":Su(e,Od.INT32,2,o);break;case"message":ld(void 0!==o),e.tag(2,cu.LengthDelimited).bytes(o.toBinary(t))}e.join()}function Iu(e,t,n,r){const o=Hd(n.T,r);n.delimited?e.tag(n.no,cu.StartGroup).raw(o.toBinary(t)).tag(n.no,cu.EndGroup):e.tag(n.no,cu.LengthDelimited).bytes(o.toBinary(t))}function Su(e,t,n,r){ld(void 0!==r);let[o,i]=Cu(t);e.tag(n,o)[i](r)}function Cu(e){let t=cu.Varint;switch(e){case Od.BYTES:case Od.STRING:t=cu.LengthDelimited;break;case Od.DOUBLE:case Od.FIXED64:case Od.SFIXED64:t=cu.Bit64;break;case Od.FIXED32:case Od.SFIXED32:case Od.FLOAT:t=cu.Bit32}return[t,Od[e].toLowerCase()]}function ku(e){if(void 0===e)return e;if(Jd(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function Tu(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class Nu{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Au(e,t){const n=_u(e);return t?n:Mu(Lu(n))}function Du(e){return Au(e,!1)}const Ou=_u;function _u(e){let t=!1;const n=[];for(let r=0;r<e.length;r++){let o=e.charAt(r);switch(o){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(o),t=!1;break;default:t&&(t=!1,o=o.toUpperCase()),n.push(o)}}return n.join("")}new Set(["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with","yield","enum","implements","interface","let","package","private","protected","public","static","Object","bigint","number","boolean","string","object","globalThis","Uint8Array","Partial"]);const Pu=new Set(["constructor","toString","toJSON","valueOf"]),xu=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Ru=e=>`${e}$`,Lu=e=>xu.has(e)?Ru(e):e,Mu=e=>Pu.has(e)?Ru(e):e;class Uu{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Du(e)}addField(e){ld(e.oneof===this,`field ${e.name} not one of ${this.name}`),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const Fu=(ju=e=>new Nu(e,e=>function(e,t){var n,r,o,i,a,s;const c=[];let l;for(const d of"function"==typeof e?e():e){const e=d;if(e.localName=Au(d.name,void 0!==d.oneof),e.jsonName=null!==(n=d.jsonName)&&void 0!==n?n:Ou(d.name),e.repeated=null!==(r=d.repeated)&&void 0!==r&&r,"scalar"==d.kind&&(e.L=null!==(o=d.L)&&void 0!==o?o:_d.BIGINT),e.delimited=null!==(i=d.delimited)&&void 0!==i&&i,e.req=null!==(a=d.req)&&void 0!==a&&a,e.opt=null!==(s=d.opt)&&void 0!==s&&s,void 0===d.packed&&(e.packed=!!t&&("enum"==d.kind||"scalar"==d.kind&&d.T!=Od.BYTES&&d.T!=Od.STRING)),void 0!==d.oneof){const t="string"==typeof d.oneof?d.oneof:d.oneof.name;l&&l.name==t||(l=new Uu(t)),e.oneof=l,l.addField(e)}c.push(e)}return c}(e,!0)),Bu=e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,r=e;if(t.repeated)r[n]=[];else switch(t.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=xd(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:Wd,makeWriteOptions:Yd,readMessage(e,t,n,r){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error(`cannot decode message ${e.typeName} from JSON: ${Zd(t)}`);r=null!=r?r:new e;const o=new Map,i=n.typeRegistry;for(const[a,s]of Object.entries(t)){const t=e.fields.findJsonName(a);if(t){if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const n=o.get(t.oneof);if(void 0!==n)throw new Error(`cannot decode message ${e.typeName} from JSON: multiple keys for oneof "${t.oneof.name}" present: "${n}", "${a}"`);o.set(t.oneof,a)}eu(r,s,t,n,e)}else{let t=!1;if((null==i?void 0:i.findExtension)&&a.startsWith("[")&&a.endsWith("]")){const o=i.findExtension(a.substring(1,a.length-1));if(o&&o.extendee.typeName==e.typeName){t=!0;const[e,i]=Ld(o);eu(e,s,o.field,n,o),Bd(r,o,i(),n)}}if(!t&&!n.ignoreUnknownFields)throw new Error(`cannot decode message ${e.typeName} from JSON: key "${a}" is unknown`)}}return r},writeMessage(e,t){const n=e.getType(),r={};let o;try{for(o of n.fields.byNumber()){if(!Vd(o,e)){if(o.req)throw"required field not set";if(!t.emitDefaultValues)continue;if(!ou(o))continue}const n=iu(o,o.oneof?e[o.oneof.localName].value:e[o.localName],t);void 0!==n&&(r[t.useProtoFieldName?o.name:o.jsonName]=n)}const i=t.typeRegistry;if(null==i?void 0:i.findExtensionFor)for(const o of n.runtime.bin.listUnknownFields(e)){const a=i.findExtensionFor(n.typeName,o.no);if(a&&$d(e,a)){const n=jd(e,a,t),o=iu(a.field,n,t);void 0!==o&&(r[a.field.jsonName]=o)}}}catch(e){const t=o?`cannot encode field ${n.typeName}.${o.name} to JSON`:`cannot encode message ${n.typeName} to JSON`,r=e instanceof Error?e.message:String(e);throw new Error(t+(r.length>0?`: ${r}`:""))}return r},readScalar:(e,t,n)=>nu(e,t,null!=n?n:_d.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t)return n||Rd(e,t)?su(e,t):void 0},debug:Zd},bin:{makeReadOptions:gu,makeWriteOptions:mu,listUnknownFields(e){var t;return null!==(t=e[uu])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[uu]},writeUnknownFields(e,t){const n=e[uu];if(n)for(const e of n)t.tag(e.no,e.wireType).raw(e.data)},onUnknownField(e,t,n,r){const o=e;Array.isArray(o[uu])||(o[uu]=[]),o[uu].push({no:t,wireType:n,data:r})},readMessage(e,t,n,r,o){const i=e.getType(),a=o?t.len:t.pos+n;let s,c;for(;t.pos<a&&([s,c]=t.tag(),!0!==o||c!=cu.EndGroup);){const n=i.fields.find(s);if(!n){const n=t.skip(c,s);r.readUnknownFields&&this.onUnknownField(e,s,c,n);continue}hu(e,t,n,c,r)}if(o&&(c!=cu.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:hu,writeMessage(e,t,n){const r=e.getType();for(const o of r.fields.byNumber())if(Vd(o,e))bu(o,o.oneof?e[o.oneof.localName].value:e[o.localName],t,n);else if(o.req)throw new Error(`cannot encode field ${r.typeName}.${o.name} to binary: required field not set`);return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,r){void 0!==t&&bu(e,t,n,r)}},util:Object.assign(Object.assign({},{setEnumType:Td,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const r of n.fields.byMember()){const n=r.localName,o=t,i=e;if(null!=i[n])switch(r.kind){case"oneof":const e=i[n].case;if(void 0===e)continue;const t=r.findField(e);let a=i[n].value;t&&"message"==t.kind&&!Jd(a,t.T)?a=new t.T(a):t&&"scalar"===t.kind&&t.T===Od.BYTES&&(a=Tu(a)),o[n]={case:e,value:a};break;case"scalar":case"enum":let s=i[n];r.T===Od.BYTES&&(s=r.repeated?s.map(Tu):Tu(s)),o[n]=s;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===Od.BYTES)for(const[e,t]of Object.entries(i[n]))o[n][e]=Tu(t);else Object.assign(o[n],i[n]);break;case"message":const e=r.V.T;for(const t of Object.keys(i[n])){let r=i[n][t];e.fieldWrapper||(r=new e(r)),o[n][t]=r}}break;case"message":const c=r.T;if(r.repeated)o[n]=i[n].map(e=>Jd(e,c)?e:new c(e));else{const e=i[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?o[n]=Tu(e):o[n]=e:o[n]=Jd(e,c)?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every(e=>{const r=t[e.localName],o=n[e.localName];if(e.repeated){if(r.length!==o.length)return!1;switch(e.kind){case"message":return r.every((t,n)=>e.T.equals(t,o[n]));case"scalar":return r.every((t,n)=>Pd(e.T,t,o[n]));case"enum":return r.every((e,t)=>Pd(Od.INT32,e,o[t]))}throw new Error(`repeated cannot contain ${e.kind}`)}switch(e.kind){case"message":let t=r,n=o;return e.T.fieldWrapper&&(void 0===t||Jd(t)||(t=e.T.fieldWrapper.wrapField(t)),void 0===n||Jd(n)||(n=e.T.fieldWrapper.wrapField(n))),e.T.equals(t,n);case"enum":return Pd(Od.INT32,r,o);case"scalar":return Pd(e.T,r,o);case"oneof":if(r.case!==o.case)return!1;const i=e.findField(r.case);if(void 0===i)return!0;switch(i.kind){case"message":return i.T.equals(r.value,o.value);case"enum":return Pd(Od.INT32,r.value,o.value);case"scalar":return Pd(i.T,r.value,o.value)}throw new Error(`oneof cannot contain ${i.kind}`);case"map":const a=Object.keys(r).concat(Object.keys(o));switch(e.V.kind){case"message":const t=e.V.T;return a.every(e=>t.equals(r[e],o[e]));case"enum":return a.every(e=>Pd(Od.INT32,r[e],o[e]));case"scalar":const n=e.V.T;return a.every(e=>Pd(n,r[e],o[e]))}}}),clone(e){const t=e.getType(),n=new t,r=n;for(const n of t.fields.byMember()){const t=e[n.localName];let o;if(n.repeated)o=t.map(ku);else if("map"==n.kind){o=r[n.localName];for(const[e,n]of Object.entries(t))o[e]=ku(n)}else o="oneof"==n.kind?n.findField(t.case)?{case:t.case,value:ku(t.value)}:{case:void 0}:ku(t);r[n.localName]=o}for(const n of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(r,n.no,n.wireType,n.data);return n}}),{newFieldList:ju,initFields:Bu}),makeMessageType(e,t,n){return function(e,t,n,r){var o;const i=null!==(o=null==r?void 0:r.localName)&&void 0!==o?o:t.substring(t.lastIndexOf(".")+1),a={[i]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[i];return Object.setPrototypeOf(a.prototype,new cd),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new a).fromBinary(e,t),fromJson:(e,t)=>(new a).fromJson(e,t),fromJsonString:(e,t)=>(new a).fromJsonString(e,t),equals:(t,n)=>e.util.equals(a,t,n)}),a}(this,e,t,n)},makeEnum:Ad,makeEnumType:Nd,getEnumType:kd,makeExtension(e,t,n){return function(e,t,n,r){let o;return{typeName:t,extendee:n,get field(){if(!o){const n="function"==typeof r?r():r;n.name=t.split(".").pop(),n.jsonName=`[${t}]`,o=e.util.newFieldList([n]).list()[0]}return o},runtime:e}}(this,e,t,n)}});var ju,Bu,$u,qu,Vu;class zu extends cd{constructor(e){super(),this.seconds=Sd.zero,this.nanos=0,Fu.util.initPartial(e,this)}fromJson(e,t){if("string"!=typeof e)throw new Error(`cannot decode google.protobuf.Timestamp from JSON: ${Fu.json.debug(e)}`);const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Sd.parse(r/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return zu.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new zu({seconds:Sd.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new zu).fromBinary(e,t)}static fromJson(e,t){return(new zu).fromJson(e,t)}static fromJsonString(e,t){return(new zu).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals(zu,e,t)}}function Ju(e){const t=Vu[e];return"string"!=typeof t?e.toString():t[0].toLowerCase()+t.substring(1).replace(/[A-Z]/g,e=>"_"+e.toLowerCase())}let Hu;zu.runtime=Fu,zu.typeName="google.protobuf.Timestamp",zu.fields=Fu.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]),function(e){e[e.Unary=0]="Unary",e[e.ServerStreaming=1]="ServerStreaming",e[e.ClientStreaming=2]="ClientStreaming",e[e.BiDiStreaming=3]="BiDiStreaming"}($u||($u={})),function(e){e[e.NoSideEffects=1]="NoSideEffects",e[e.Idempotent=2]="Idempotent"}(qu||(qu={})),function(e){e[e.Canceled=1]="Canceled",e[e.Unknown=2]="Unknown",e[e.InvalidArgument=3]="InvalidArgument",e[e.DeadlineExceeded=4]="DeadlineExceeded",e[e.NotFound=5]="NotFound",e[e.AlreadyExists=6]="AlreadyExists",e[e.PermissionDenied=7]="PermissionDenied",e[e.ResourceExhausted=8]="ResourceExhausted",e[e.FailedPrecondition=9]="FailedPrecondition",e[e.Aborted=10]="Aborted",e[e.OutOfRange=11]="OutOfRange",e[e.Unimplemented=12]="Unimplemented",e[e.Internal=13]="Internal",e[e.Unavailable=14]="Unavailable",e[e.DataLoss=15]="DataLoss",e[e.Unauthenticated=16]="Unauthenticated"}(Vu||(Vu={}));class Gu extends Error{constructor(e,t=Vu.Unknown,n,r,o){super(function(e,t){return e.length?`[${Ju(t)}] ${e}`:`[${Ju(t)}]`}(e,t)),this.name="ConnectError",Object.setPrototypeOf(this,new.target.prototype),this.rawMessage=e,this.code=t,this.metadata=new Headers(null!=n?n:{}),this.details=null!=r?r:[],this.cause=o}static from(e,t=Vu.Unknown){return e instanceof Gu?e:e instanceof Error?"AbortError"==e.name?new Gu(e.message,Vu.Canceled):new Gu(e.message,t,void 0,void 0,e):new Gu(String(e),t,void 0,void 0,e)}static[Symbol.hasInstance](e){return e instanceof Error&&(Object.getPrototypeOf(e)===Gu.prototype||"ConnectError"===e.name&&"code"in e&&"number"==typeof e.code&&"metadata"in e&&"details"in e&&Array.isArray(e.details)&&"rawMessage"in e&&"string"==typeof e.rawMessage&&"cause"in e)}findDetails(e){const t="typeName"in e?{findMessage:t=>t===e.typeName?e:void 0}:e,n=[];for(const e of this.details){if("getType"in e){t.findMessage(e.getType().typeName)&&n.push(e);continue}const r=t.findMessage(e.type);if(r)try{n.push(r.fromBinary(e.value))}catch(e){}}return n}}var Xu=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,o){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,o,(t=e[n](t)).done,t.value)})}}},Wu=function(e){return this instanceof Wu?(this.v=e,this):new Wu(e)},Yu=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(e,t){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||s(e,t)})},t&&(r[e]=t(r[e])))}function s(e,t){try{(n=o[e](t)).value instanceof Wu?Promise.resolve(n.value.v).then(c,l):d(i[0][2],n)}catch(e){d(i[0][3],e)}var n}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}},Ku=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:Wu(e[r](t)),done:!1}:o?o(t):t}:o}};var Qu=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise(function(r,o){(function(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)})(r,o,(t=e[n](t)).done,t.value)})}}},Zu=function(e){return this instanceof Zu?(this.v=e,this):new Zu(e)},ep=function(e){var t,n;return t={},r("next"),r("throw",function(e){throw e}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:Zu(e[r](t)),done:!1}:o?o(t):t}:o}},tp=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(e,t){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||s(e,t)})},t&&(r[e]=t(r[e])))}function s(e,t){try{(n=o[e](t)).value instanceof Zu?Promise.resolve(n.value.v).then(c,l):d(i[0][2],n)}catch(e){d(i[0][3],e)}var n}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}};function np(e,t){return function(e,t){const n={};for(const[r,o]of Object.entries(e.methods)){const i=t(Object.assign(Object.assign({},o),{localName:r,service:e}));null!=i&&(n[r]=i)}return n}(e,n=>{switch(n.kind){case $u.Unary:return function(e,t,n){return async function(r,o){var i,a;const s=await e.unary(t,n,null==o?void 0:o.signal,null==o?void 0:o.timeoutMs,null==o?void 0:o.headers,r,null==o?void 0:o.contextValues);return null===(i=null==o?void 0:o.onHeader)||void 0===i||i.call(o,s.header),null===(a=null==o?void 0:o.onTrailer)||void 0===a||a.call(o,s.trailer),s.message}}(t,e,n);case $u.ServerStreaming:return function(e,t,n){return function(r,o){return rp(e.stream(t,n,null==o?void 0:o.signal,null==o?void 0:o.timeoutMs,null==o?void 0:o.headers,function(e){return Yu(this,arguments,function*(){yield Wu(yield*Ku(Xu(e)))})}([r]),null==o?void 0:o.contextValues),o)}}(t,e,n);case $u.ClientStreaming:return function(e,t,n){return async function(r,o){var i,a,s,c,l,d;const u=await e.stream(t,n,null==o?void 0:o.signal,null==o?void 0:o.timeoutMs,null==o?void 0:o.headers,r,null==o?void 0:o.contextValues);let p;null===(l=null==o?void 0:o.onHeader)||void 0===l||l.call(o,u.header);let f=0;try{for(var g,m=!0,h=Qu(u.message);!(i=(g=await h.next()).done);m=!0){c=g.value,m=!1;p=c,f++}}catch(e){a={error:e}}finally{try{m||i||!(s=h.return)||await s.call(h)}finally{if(a)throw a.error}}if(!p)throw new Gu("protocol error: missing response message",Vu.Unimplemented);if(f>1)throw new Gu("protocol error: received extra messages for client streaming method",Vu.Unimplemented);return null===(d=null==o?void 0:o.onTrailer)||void 0===d||d.call(o,u.trailer),p}}(t,e,n);case $u.BiDiStreaming:return function(e,t,n){return function(r,o){return rp(e.stream(t,n,null==o?void 0:o.signal,null==o?void 0:o.timeoutMs,null==o?void 0:o.headers,r,null==o?void 0:o.contextValues),o)}}(t,e,n);default:return null}})}function rp(e,t){const n=function(){return tp(this,arguments,function*(){var n,r;const o=yield Zu(e);null===(n=null==t?void 0:t.onHeader)||void 0===n||n.call(t,o.header),yield Zu(yield*ep(Qu(o.message))),null===(r=null==t?void 0:t.onTrailer)||void 0===r||r.call(t,o.trailer)})}()[Symbol.asyncIterator]();return{[Symbol.asyncIterator]:()=>({next:()=>n.next()})}}function op(){return{get(e){return e.id in this?this[e.id]:e.defaultValue},set(e,t){return this[e.id]=t,this},delete(e){return delete this[e.id],this}}}function ip(e){var t;const n=Object.assign({},e);return null!==(t=n.ignoreUnknownFields)&&void 0!==t||(n.ignoreUnknownFields=!0),n}function ap(e,t,n,r){const o=t?sp(e.I,r):cp(e.I,n);return{parse:(t?sp(e.O,r):cp(e.O,n)).parse,serialize:o.serialize}}function sp(e,t){return{parse(n){try{return e.fromBinary(n,t)}catch(e){const t=e instanceof Error?e.message:String(e);throw new Gu(`parse binary: ${t}`,Vu.Internal)}},serialize(e){try{return e.toBinary(t)}catch(e){const t=e instanceof Error?e.message:String(e);throw new Gu(`serialize binary: ${t}`,Vu.Internal)}}}}function cp(e,t){var n,r;const o=null!==(n=null==t?void 0:t.textEncoder)&&void 0!==n?n:new TextEncoder,i=null!==(r=null==t?void 0:t.textDecoder)&&void 0!==r?r:new TextDecoder,a=ip(t);return{parse(t){try{const n=i.decode(t);return e.fromJsonString(n,a)}catch(e){throw Gu.from(e,Vu.InvalidArgument)}},serialize(e){try{const t=e.toJsonString(a);return o.encode(t)}catch(e){throw Gu.from(e,Vu.Internal)}}}}function lp(e,t){var n;return null!==(n=null==t?void 0:t.concat().reverse().reduce((e,t)=>t(e),e))&&void 0!==n?n:e}function dp(e){if(!e.aborted)return;if(void 0!==e.reason)return e.reason;const t=new Error("This operation was aborted");return t.name="AbortError",t}function up(e,t){return t instanceof e?t:new e(t)}function pp(e,t){function n(t){return!0===t.done?t:{done:t.done,value:up(e,t.value)}}return{[Symbol.asyncIterator](){const e=t[Symbol.asyncIterator](),r={next:()=>e.next().then(n)};return void 0!==e.throw&&(r.throw=t=>e.throw(t).then(n)),void 0!==e.return&&(r.return=t=>e.return(t).then(n)),r}}}function fp(e){const{signal:t,cleanup:n}=function(e){const t=new AbortController,n=()=>{t.abort(new Gu("the operation timed out",Vu.DeadlineExceeded))};let r;return void 0!==e&&(e<=0?n():r=setTimeout(n,e)),{signal:t.signal,cleanup:()=>clearTimeout(r)}}(e.timeoutMs),r=function(...e){const t=new AbortController,n=e.filter(e=>void 0!==e).concat(t.signal);for(const e of n){if(e.aborted){r.apply(e);break}e.addEventListener("abort",r)}function r(){t.signal.aborted||t.abort(dp(this));for(const e of n)e.removeEventListener("abort",r)}return t}(e.signal,t);return[r.signal,function(e){const o=Gu.from(t.aborted?dp(t):e);return r.abort(o),n(),Promise.reject(o)},function(){n(),r.abort()}]}function gp(e,t,n){const r="string"==typeof t?t:t.typeName,o="string"==typeof n?n:n.name;return e.toString().replace(/\/?$/,`/${r}/${o}`)}const mp="Content-Type",hp="Content-Length",yp="Content-Encoding",vp="Accept-Encoding",wp="Connect-Protocol-Version",bp="User-Agent",Ep="1";const Ip=/^application\/(connect\+)?(?:(json)(?:; ?charset=utf-?8)?|(proto))$/i;function Sp(e,t,n,r,o){const i=new Headers(null!=r?r:{});return void 0!==n&&i.set("Connect-Timeout-Ms",`${n}`),i.set(mp,e==$u.Unary?t?"application/proto":"application/json":t?"application/connect+proto":"application/connect+json"),i.set(wp,Ep),o&&!i.has(bp)&&i.set(bp,"connect-es/1.7.0"),i}const Cp="application/";function kp(e,t,n){let r=`?connect=v${Ep}`;const o=e.header.get(mp);0===(null==o?void 0:o.indexOf(Cp))&&(r+="&encoding="+encodeURIComponent(o.slice(12)));const i=e.header.get(yp);null!==i&&"identity"!==i&&(r+="&compression="+encodeURIComponent(i),n=!0),n&&(r+="&base64=1"),r+="&message="+function(e,t){return t?Fd.enc(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):encodeURIComponent((new TextDecoder).decode(e))}(t,n);const a=e.url+r,s=new Headers(e.header);return[wp,mp,hp,yp,vp].forEach(e=>s.delete(e)),Object.assign(Object.assign({},e),{init:Object.assign(Object.assign({},e.init),{method:"GET"}),url:a,header:s})}function Tp(e,t,n,r){const o=r.get(mp),i=function(e){const t=null==e?void 0:e.match(Ip);if(!t)return;return{stream:!!t[1],binary:!!t[3]}}(o);if(200!==n){const t=new Gu(`HTTP ${n}`,function(e){switch(e){case 400:return Vu.Internal;case 401:return Vu.Unauthenticated;case 403:return Vu.PermissionDenied;case 404:return Vu.Unimplemented;case 429:case 502:case 503:case 504:return Vu.Unavailable;default:return Vu.Unknown}}(n),r);if(e==$u.Unary&&i&&!i.binary)return{isUnaryError:!0,unaryError:t};throw t}const a=t,s=e!==$u.Unary;if((null==i?void 0:i.binary)!==a||i.stream!==s)throw new Gu(`unsupported content type ${o}`,void 0===i?Vu.Unknown:Vu.Internal,r);return{isUnaryError:!1}}function Np(e,t,n){var r;if(t&&new Headers(t).forEach((e,t)=>n.metadata.append(t,e)),"object"!=typeof e||null==e||Array.isArray(e))throw n;let o=n.code;"code"in e&&"string"==typeof e.code&&(o=null!==(r=function(e){if(!Hu){Hu={};for(const e of Object.values(Vu))"string"!=typeof e&&(Hu[Ju(e)]=e)}return Hu[e]}(e.code))&&void 0!==r?r:o);const i=e.message;if(null!=i&&"string"!=typeof i)throw n;const a=new Gu(null!=i?i:"",o,t);if("details"in e&&Array.isArray(e.details))for(const t of e.details){if(null===t||"object"!=typeof t||Array.isArray(t)||"string"!=typeof t.type||"string"!=typeof t.value)throw n;try{a.details.push({type:t.type,value:Fd.dec(t.value),debug:t.debug})}catch(e){throw n}}return a}function Ap(e){const t=new Headers,n=new Headers;return e.forEach((e,r)=>{r.toLowerCase().startsWith("trailer-")?n.append(r.substring(8),e):t.append(r,e)}),[t,n]}function Dp(e){const t=new Gu("invalid end stream",Vu.Unknown);let n;try{n=JSON.parse("string"==typeof e?e:(new TextDecoder).decode(e))}catch(e){throw t}if("object"!=typeof n||null==n||Array.isArray(n))throw t;const r=new Headers;if("metadata"in n){if("object"!=typeof n.metadata||null==n.metadata||Array.isArray(n.metadata))throw t;for(const[e,o]of Object.entries(n.metadata)){if(!Array.isArray(o)||o.some(e=>"string"!=typeof e))throw t;for(const t of o)r.append(e,t)}}return{metadata:r,error:"error"in n&&null!=n.error?Np(n.error,r,t):void 0}}var Op,_p,Pp,xp=function(e){return this instanceof xp?(this.v=e,this):new xp(e)},Rp=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},a("next"),a("throw"),a("return",function(e){return function(t){return Promise.resolve(t).then(e,l)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(e,t){o[e]&&(r[e]=function(t){return new Promise(function(n,r){i.push([e,t,n,r])>1||s(e,t)})},t&&(r[e]=t(r[e])))}function s(e,t){try{(n=o[e](t)).value instanceof xp?Promise.resolve(n.value.v).then(c,l):d(i[0][2],n)}catch(e){d(i[0][3],e)}var n}function c(e){s("next",e)}function l(e){s("throw",e)}function d(e,t){e(t),i.shift(),i.length&&s(i[0][0],i[0][1])}};function Lp(e){var t;!function(){try{new Headers}catch(e){throw new Error("connect-web requires the fetch API. Are you running on an old version of Node.js? Node.js is not supported in Connect for Web - please stay tuned for Connect for Node.")}}();const n=null!==(t=e.useBinaryFormat)&&void 0!==t&&t;return{async unary(t,r,o,i,a,s,c){var l;const{serialize:d,parse:u}=ap(r,n,e.jsonOptions,e.binaryOptions);return i=void 0===i?e.defaultTimeoutMs:i<=0?void 0:i,await function(e){const t=lp(e.next,e.interceptors),[n,r,o]=fp(e);return t(Object.assign(Object.assign({},e.req),{message:up(e.req.method.I,e.req.message),signal:n})).then(e=>(o(),e),r)}({interceptors:e.interceptors,signal:o,timeoutMs:i,req:{stream:!1,service:t,method:r,url:gp(e.baseUrl,t,r),init:{method:"POST",credentials:null!==(l=e.credentials)&&void 0!==l?l:"same-origin",redirect:"error",mode:"cors"},header:Sp(r.kind,n,i,a,!1),contextValues:null!=c?c:op(),message:s},next:async o=>{var i;let a=null;!0===e.useHttpGet&&r.idempotency===qu.NoSideEffects?o=kp(o,d(o.message),n):a=d(o.message);const s=null!==(i=e.fetch)&&void 0!==i?i:globalThis.fetch,c=await s(o.url,Object.assign(Object.assign({},o.init),{headers:o.header,signal:o.signal,body:a})),{isUnaryError:l,unaryError:p}=Tp(r.kind,n,c.status,c.headers);if(l)throw Np(await c.json(),function(...e){const t=new Headers;for(const n of e)n.forEach((e,n)=>{t.append(n,e)});return t}(...Ap(c.headers)),p);const[f,g]=Ap(c.headers);return{stream:!1,service:t,method:r,header:f,message:n?u(new Uint8Array(await c.arrayBuffer())):r.O.fromJson(await c.json(),ip(e.jsonOptions)),trailer:g}}})},async stream(t,r,o,i,a,s,c){var l;const{serialize:d,parse:u}=ap(r,n,e.jsonOptions,e.binaryOptions);function p(e,t,n,r){return Rp(this,arguments,function*(){const o=function(e){let t,n=new Uint8Array(0);function r(e){const t=new Uint8Array(n.length+e.length);t.set(n),t.set(e,n.length),n=t}return new ReadableStream({start(){t=e.getReader()},async pull(e){let o;for(;;){if(void 0===o&&n.byteLength>=5){let e=0;for(let t=1;t<5;t++)e=(e<<8)+n[t];o={flags:n[0],length:e}}if(void 0!==o&&n.byteLength>=o.length+5)break;const e=await t.read();if(e.done)break;r(e.value)}if(void 0===o)return 0==n.byteLength?void e.close():void e.error(new Gu("premature end of stream",Vu.DataLoss));const i=n.subarray(5,5+o.length);n=n.subarray(5+o.length),e.enqueue({flags:o.flags,data:i})}})}(e).getReader();let i=!1;for(;;){const e=yield xp(o.read());if(e.done)break;const{flags:r,data:a}=e.value;if(!(1&~r))throw new Gu("protocol error: received unsupported compressed output",Vu.Internal);if(!(2&~r)){i=!0;const e=Dp(a);if(e.error){const t=e.error;throw n.forEach((e,n)=>{t.metadata.append(n,e)}),t}e.metadata.forEach((e,n)=>t.set(n,e));continue}yield yield xp(u(a))}if("throwIfAborted"in r&&r.throwIfAborted(),!i)throw"missing EndStreamResponse"})}async function f(e){if(r.kind!=$u.ServerStreaming)throw"The fetch API does not support streaming request bodies";const t=await e[Symbol.asyncIterator]().next();if(1==t.done)throw"missing request message";return function(e,t){const n=new Uint8Array(t.length+5);n.set(t,5);const r=new DataView(n.buffer,n.byteOffset,n.byteLength);return r.setUint8(0,e),r.setUint32(1,t.length),n}(0,d(t.value))}return i=void 0===i?e.defaultTimeoutMs:i<=0?void 0:i,await function(e){const t=lp(e.next,e.interceptors),[n,r,o]=fp(e),i=Object.assign(Object.assign({},e.req),{message:pp(e.req.method.I,e.req.message),signal:n});let a=!1;return n.addEventListener("abort",function(){var t,n;const r=e.req.message[Symbol.asyncIterator]();a||null===(t=r.throw)||void 0===t||t.call(r,this.reason).catch(()=>{}),null===(n=r.return)||void 0===n||n.call(r).catch(()=>{})}),t(i).then(e=>Object.assign(Object.assign({},e),{message:{[Symbol.asyncIterator](){const t=e.message[Symbol.asyncIterator]();return{next:()=>t.next().then(e=>(1==e.done&&(a=!0,o()),e),r)}}}}),r)}({interceptors:e.interceptors,timeoutMs:i,signal:o,req:{stream:!0,service:t,method:r,url:gp(e.baseUrl,t,r),init:{method:"POST",credentials:null!==(l=e.credentials)&&void 0!==l?l:"same-origin",redirect:"error",mode:"cors"},header:Sp(r.kind,n,i,a,!1),contextValues:null!=c?c:op(),message:s},next:async t=>{var o;const i=null!==(o=e.fetch)&&void 0!==o?o:globalThis.fetch,a=await i(t.url,Object.assign(Object.assign({},t.init),{headers:t.header,signal:t.signal,body:await f(t.message)}));if(Tp(r.kind,n,a.status,a.headers),null===a.body)throw"missing response body";const s=new Headers;return Object.assign(Object.assign({},t),{header:a.headers,trailer:s,message:p(a.body,s,a.headers,t.signal)})}})}}}class Mp extends cd{constructor(e){super(),this.analyticsToken="",this.analyticsTokenFormat=Op.UNSPECIFIED,Fu.util.initPartial(e,this)}static fromBinary(e,t){return(new Mp).fromBinary(e,t)}static fromJson(e,t){return(new Mp).fromJson(e,t)}static fromJsonString(e,t){return(new Mp).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals(Mp,e,t)}}Mp.runtime=Fu,Mp.typeName="nike.clickstream.core.experimentation.v1.ExperimentActivated",Mp.fields=Fu.util.newFieldList(()=>[{no:1,name:"analytics_token",kind:"scalar",T:9},{no:2,name:"analytics_token_format",kind:"enum",T:Fu.getEnumType(Op)}]),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ADOBE_TARGET=1]="ADOBE_TARGET",e[e.NIKE_ODD=2]="NIKE_ODD"}(Op||(Op={})),Fu.util.setEnumType(Op,"nike.clickstream.core.experimentation.v1.ExperimentActivated.AnalyticsTokenFormat",[{no:0,name:"ANALYTICS_TOKEN_FORMAT_UNSPECIFIED"},{no:1,name:"ANALYTICS_TOKEN_FORMAT_ADOBE_TARGET"},{no:2,name:"ANALYTICS_TOKEN_FORMAT_NIKE_ODD"}]);class Up extends cd{constructor(e){super(),this.groupId="",this.segmentId="",this.isHoldout=!1,Fu.util.initPartial(e,this)}static fromBinary(e,t){return(new Up).fromBinary(e,t)}static fromJson(e,t){return(new Up).fromJson(e,t)}static fromJsonString(e,t){return(new Up).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals(Up,e,t)}}Up.runtime=Fu,Up.typeName="nike.clickstream.core.experimentation.v1.UniversalHoldout",Up.fields=Fu.util.newFieldList(()=>[{no:1,name:"group_id",kind:"scalar",T:9},{no:2,name:"segment_id",kind:"scalar",T:9},{no:3,name:"is_holdout",kind:"scalar",T:8}]);class Fp extends cd{constructor(e){super(),this.underlyingAction={case:void 0},Fu.util.initPartial(e,this)}static fromBinary(e,t){return(new Fp).fromBinary(e,t)}static fromJson(e,t){return(new Fp).fromJson(e,t)}static fromJsonString(e,t){return(new Fp).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals(Fp,e,t)}}Fp.runtime=Fu,Fp.typeName="nike.clickstream.event.experimentation.v1.Action",Fp.fields=Fu.util.newFieldList(()=>[{no:1,name:"experiment_activated",kind:"message",T:Mp,oneof:"underlying_action"},{no:2,name:"universal_holdout",kind:"message",T:Up,oneof:"underlying_action"}]);class jp extends cd{constructor(e){super(),this.deviceId="",this.anonymousId="",this.ecid="",this.app=_p.UNSPECIFIED,this.platform=Pp.UNSPECIFIED,Fu.util.initPartial(e,this)}static fromBinary(e,t){return(new jp).fromBinary(e,t)}static fromJson(e,t){return(new jp).fromJson(e,t)}static fromJsonString(e,t){return(new jp).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals(jp,e,t)}}jp.runtime=Fu,jp.typeName="nike.clickstream.event.experimentation.v1.Event",jp.fields=Fu.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"message",T:zu},{no:2,name:"device_id",kind:"scalar",T:9},{no:3,name:"anonymous_id",kind:"scalar",T:9},{no:4,name:"ecid",kind:"scalar",T:9},{no:5,name:"app",kind:"enum",T:Fu.getEnumType(_p)},{no:6,name:"platform",kind:"enum",T:Fu.getEnumType(Pp)},{no:7,name:"action",kind:"message",T:Fp}]),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.DOTCOM=1]="DOTCOM",e[e.NIKEAPP=2]="NIKEAPP"}(_p||(_p={})),Fu.util.setEnumType(_p,"nike.clickstream.event.experimentation.v1.Event.App",[{no:0,name:"APP_UNSPECIFIED"},{no:1,name:"APP_DOTCOM"},{no:2,name:"APP_NIKEAPP"}]),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.WEB=1]="WEB",e[e.IOS=2]="IOS",e[e.ANDROID=3]="ANDROID"}(Pp||(Pp={})),Fu.util.setEnumType(Pp,"nike.clickstream.event.experimentation.v1.Event.Platform",[{no:0,name:"PLATFORM_UNSPECIFIED"},{no:1,name:"PLATFORM_WEB"},{no:2,name:"PLATFORM_IOS"},{no:3,name:"PLATFORM_ANDROID"}]);class Bp extends cd{constructor(e){super(),this.event={case:void 0},Fu.util.initPartial(e,this)}static fromBinary(e,t){return(new Bp).fromBinary(e,t)}static fromJson(e,t){return(new Bp).fromJson(e,t)}static fromJsonString(e,t){return(new Bp).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals(Bp,e,t)}}Bp.runtime=Fu,Bp.typeName="nike.clickstream.service.experimentation.v1.TrackEventRequest",Bp.fields=Fu.util.newFieldList(()=>[{no:1,name:"event_v1",kind:"message",T:jp,oneof:"event"}]);class $p extends cd{constructor(e){super(),this.message="",this.eventId="",Fu.util.initPartial(e,this)}static fromBinary(e,t){return(new $p).fromBinary(e,t)}static fromJson(e,t){return(new $p).fromJson(e,t)}static fromJsonString(e,t){return(new $p).fromJsonString(e,t)}static equals(e,t){return Fu.util.equals($p,e,t)}}$p.runtime=Fu,$p.typeName="nike.clickstream.service.experimentation.v1.TrackEventResponse",$p.fields=Fu.util.newFieldList(()=>[{no:1,name:"message",kind:"scalar",T:9},{no:2,name:"event_id",kind:"scalar",T:9}]);const qp={typeName:"nike.clickstream.service.experimentation.v1.Service",methods:{trackEvent:{name:"TrackEvent",I:Bp,O:$p,kind:$u.Unary}}};async function Vp({debug:e}){const t=Lp({baseUrl:"https://experimentation.halfpipe.nike.com",fetch:async(e,t)=>{try{return await fetch(e,t)}catch(e){throw Bl(e,{errorMessage:"gRPC request failed"})}},useBinaryFormat:!e});return{v1:np(qp,t)}}function zp(e,t,n){const r={};return e&&(r.customerecid=[{id:e,authenticatedState:n?E:I,primary:!0}]),t&&(r.FPID=[{id:t,authenticatedState:I}]),r}const Jp=[100,500,1e3];function Hp(e){return null!==e&&"object"==typeof e&&"code"in e&&0===e.code}async function Gp(e){for(let t=0;t<Jp.length+1;t++)try{const n=await e();if(Hp(n)){if(t===Jp.length)throw Bl(new Error("Operation returned code 0 after all retry attempts"),{totalAttempts:t+1,retryDelays:Jp,source:"retryWithBackoff",responseCode:0});const e=Jp[t];P.warn(`Retry attempt ${t+1}/${Jp.length} after ${e}ms due to response code 0`,{attempt:t+1,delayMs:e,responseCode:0}),await new Promise(t=>setTimeout(t,e));continue}return n}catch(e){if(t===Jp.length)throw Bl(e,{totalAttempts:t+1,retryDelays:Jp,source:"retryWithBackoff"});const n=Jp[t];e instanceof Error&&P.warn(`Retry attempt ${t+1}/${Jp.length} after ${n}ms`,{error:e.message,attempt:t+1,delayMs:n}),await new Promise(e=>setTimeout(e,n))}throw new Error("Retry logic error")}class Xp{isDebugEnabled(){try{return"1"===localStorage?.getItem("dcac:debug")?.split("|")[0]}catch(e){return P.warn("isDebugEnabled",{error:e}),!1}}async grpcClient(){if(!this._client){const e=await Vp({debug:this.isDebugEnabled()});this._client=e.v1}return this._client}async sendAdobeAnalyticsEvent(e,t,n){const r=n?.locale||void 0,o=(e=>{const t="npe"===q();switch(e){case"ios":return t?"1BRDHl3vNC9xDs5XbzFXpGCaqP8s6iEv":"ZJixBZV8q5rHdUUcD3j9DAez1hgtC2rg";case"aos":return t?"h7cQSEWd5SAS3Ji6dDY0O1ekPyAwjcSE":"EK7Mwbi6j6pucouJ8hRlYuAeWUHFAGse";case"dotcom":return t?"POwa4r8vBBSw7xdQZ0dqGlNuyaT7Y7pZ":S;default:return S}})(t),i={analytics:e.analytics},a=e.responseTokens["experience.name"],s=e.responseTokens["activity.name"];await window.webShellClient.analytics.track("Experiment Activated",{"experience.name":a,"activity.name":s,abTest:i,...td(window,r)},{writeKey:o})}async trackExperimentActivate(e,t){try{const n=await this.grpcClient(),r={timestamp:zu.fromDate(new Date(Date.now()+100)),deviceId:t,app:_p.DOTCOM,platform:Pp.WEB,action:{underlyingAction:{case:"experimentActivated",value:{analyticsToken:e.analytics,analyticsTokenFormat:Op.ADOBE_TARGET}}}};await Gp(()=>n.trackEvent({event:{case:"eventV1",value:r}}))}catch(e){P.error("Track Event send error",e)}}async sendODDExperimentActivatedEvent(e,t,n){if(n.anonymousId&&n.anonymousId.length>32)return void P.warn("sendODDExperimentActivatedEvent skipped: invalid anonymousId",{anonymousId:n.anonymousId,anonymousIdLength:n.anonymousId.length});const r=await this.grpcClient(),o={timestamp:zu.fromDate(new Date(Date.now()+100)),deviceId:n.deviceId,anonymousId:n.anonymousId,app:_p.DOTCOM,platform:Pp.WEB,action:{underlyingAction:{case:"experimentActivated",value:{analyticsToken:`${e}:${t}`,analyticsTokenFormat:Op.NIKE_ODD}}}};await Gp(()=>r.trackEvent({event:{case:"eventV1",value:o}}))}async sendDisplayNotification(e,t,n,r,o,i){const{id:a,scope:s,scopeDetails:c}=e,l=zp(r,o,i);try{await t("sendEvent",{edgeConfigOverrides:{datastreamId:n},xdm:{eventType:"decisioning.propositionDisplay",_experience:{decisioning:{propositions:[{id:a,scope:s,scopeDetails:c}],propositionEventType:{display:1}}},identityMap:l}})}catch(t){P.error("Failed to send a displayEvent",{host:window.location.host,error:t,offer:e})}}async sendAnalyticsEvents(e,t,n,r,o,i,a,s,c){await this.sendDisplayNotification(e,t,n,r,o,i),await this.sendAdobeAnalyticsEvent(a,s,c),await this.trackExperimentActivate(a,o)}}class Wp{constructor(e){this.Promise=null,this.executor=e}async result(){return this.Promise||(this.Promise=this.executor()),this.Promise}reset(){this.Promise=null}}const Yp=(e,t,n)=>{let r={appCountry:t,appLanguage:n,browserWidth:window.innerWidth};return e.forEach(e=>{r={...r,...e.parameters}}),r},Kp=[];Date.now();const Qp=e=>{const{locationName:t,payloadItem:n,ecid:r}=e,o={locationName:t,deviceId:Gl("ni_d")||void 0,ecid:r,userPermission:Gl("ni_c")||void 0};return n?.meta&&(o.experienceName=n.meta["experience.name"],o.activityName=n.meta["activity.name"]),(e=>{if(e.locationName){const t=Kp.findIndex(t=>t.locationName===e.locationName);-1===t?Kp.push(e):Kp[t]={...Kp[t],...e}}return Kp})(o)};const Zp=()=>{const e=document.getElementById("experiment-data-toast");e&&e.remove()},ef=e=>{const t=document.getElementById("experiment-content-container");if(!t)return;const n=document.getElementById("experiment-modal-title");if(n){const t=e.filter(e=>e.activityName||e.experienceName).length,r=e.length;n.textContent=` Experiment Data (${r} location${1!==r?"s":""}, ${t} bucketed)`}const r=e.filter(e=>e.activityName||e.experienceName),o=e.filter(e=>!e.activityName&&!e.experienceName);t.innerHTML="";const i=function(e){if(!e)return null;try{const t=new URLSearchParams(e),n=t.get("page"),r=t.get("active");if(null===n||null===r)return null;if("0"!==r&&"1"!==r)return null;const o={page:n,status:r},i=t.get("tid"),a=t.get("vid");i?o.variant=i:a&&(o.variant=a);const s=t.get("tnta");return s&&(o.analyticsToken=s),o}catch(e){return null}}(Gl("at_lp_exp"));if(i){const e=document.createElement("div");e.style.cssText="\n      background-color: #fff3cd;\n      border: 2px solid #ffc107;\n      border-radius: 8px;\n      padding: 14px;\n      margin-bottom: 16px;\n    ";let n=`\n      <div style="margin-bottom: 12px;">\n        <strong style="color: #856404; font-size: 14px;"> Server-Side Experiment</strong>\n      </div>\n      <div style="margin-bottom: 8px;">\n        <strong>Page:</strong> \n        <span style="font-family: monospace; color: #333;">${i.page}</span>\n      </div>\n    `;i.variant&&(n+=`\n        <div style="margin-bottom: 8px;">\n          <strong>Variant:</strong> \n          <span style="font-family: monospace; color: #333;">${i.variant}</span>\n        </div>\n      `),n+=`\n      <div style="margin-bottom: 8px;">\n        <strong>Status:</strong> \n        <span style="color: ${"1"===i.status?"#28a745":"#6c757d"}; font-weight: 600;">\n          ${"1"===i.status?" In Experiment":" Not in Experiment"}\n        </span>\n      </div>\n    `,i.analyticsToken&&(n+=`\n        <div>\n          <strong>Analytics Token:</strong> \n          <div style="font-family: monospace; color: #333; word-break: break-all; margin-top: 4px; padding: 6px; background-color: #f8f9fa; border-radius: 4px; font-size: 11px;">\n            ${i.analyticsToken}\n          </div>\n        </div>\n      `),e.innerHTML=n,t.appendChild(e)}const a=e[0];if(e.length>0&&(a?.ecid||a?.deviceId||a?.userPermission)){const e=document.createElement("div");e.style.cssText="\n      background-color: #f0f8ff;\n      border: 2px solid #007bff;\n      border-radius: 8px;\n      padding: 14px;\n      margin-bottom: 16px;\n    ";let n="";a.deviceId&&(n+=`\n        <div style="margin-bottom: 8px;">\n          <strong>Device ID:</strong> \n          <span style="font-family: monospace; color: #333;">${a.deviceId}</span>\n        </div>\n      `),a.ecid&&(n+=`\n        <div style="margin-bottom: 8px;">\n          <strong>ECID:</strong> \n          <span style="font-family: monospace; color: #333;">${a.ecid}</span>\n        </div>\n      `),a.userPermission&&(n+=`\n        <div>\n          <strong>Permission:</strong> \n          <span style="color: #333;">${a.userPermission}</span>\n        </div>\n      `),e.innerHTML=n,t.appendChild(e)}if(r.forEach(e=>{const n=document.createElement("div");n.style.cssText="\n      background-color: #e8f4f8;\n      border: 1px solid #007bff;\n      border-radius: 6px;\n      padding: 12px;\n      margin-bottom: 10px;\n    ";const r=`\n      <div style="margin-bottom: 8px;">\n        <strong style="color: #007bff;"> Location:</strong> \n        <span>${e.locationName||"-"}</span>\n      </div>\n      <div style="margin-bottom: 8px;">\n        <strong style="color: #28a745;"> Experience:</strong> \n        <span>${e.experienceName||"-"}</span>\n      </div>\n      <div style="margin-bottom: 8px;">\n        <strong style="color: #6610f2;"> Activity:</strong> \n        <span>${e.activityName||"-"}</span>\n      </div>\n      <div>\n        <strong>Status:</strong> \n        <span style="color: #28a745; font-weight: 600;">\n           Bucketed\n        </span>\n      </div>\n    `;n.innerHTML=r,t.appendChild(n)}),o.length>0){const e=document.createElement("div");e.style.cssText="\n      background-color: #f9f9f9;\n      border: 1px solid #ddd;\n      border-radius: 6px;\n      padding: 12px;\n      margin-bottom: 10px;\n    ";const n=o.map(e=>e.locationName).join(", "),r=`\n      <div style="margin-bottom: 8px;">\n        <strong style="color: #007bff;"> Locations (${o.length}):</strong> \n        <div style="margin-top: 4px; padding-left: 10px; color: #555;">${n}</div>\n      </div>\n      <div style="margin-bottom: 8px;">\n        <strong style="color: #28a745;"> Experience:</strong> \n        <span>-</span>\n      </div>\n      <div style="margin-bottom: 8px;">\n        <strong style="color: #6610f2;"> Activity:</strong> \n        <span>-</span>\n      </div>\n      <div>\n        <strong>Status:</strong> \n        <span style="color: #6c757d; font-weight: 600;">\n           Not bucketed\n        </span>\n      </div>\n    `;e.innerHTML=r,t.appendChild(e)}if(0===e.length){const e=document.createElement("div");e.textContent="Loading experiment data...",e.style.cssText="\n      text-align: center;\n      color: #666;\n      padding: 20px;\n      font-style: italic;\n    ",t.appendChild(e)}},tf=(e,t)=>{if(!e)return void Zp();const n=()=>{if(!document.body)return void setTimeout(n,100);if(document.getElementById("experiment-data-toast"))return void ef(t);const e=document.createElement("div");e.id="experiment-data-toast",e.setAttribute("data-testid","experiment-data-toast"),e.style.cssText="\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    background-color: rgba(255, 255, 255, 0.98);\n    color: #333;\n    padding: 20px;\n    border-radius: 8px;\n    font-family: Arial, sans-serif;\n    font-size: 13px;\n    z-index: 10000;\n    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);\n    max-width: 90vw;\n    max-height: 90vh;\n    overflow: auto;\n    border: 1px solid #ddd;\n  ";const r=document.createElement("div");r.style.cssText="\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 15px;\n    padding-bottom: 10px;\n    border-bottom: 2px solid #007bff;\n  ";const o=document.createElement("h3");o.id="experiment-modal-title",o.textContent=" Experiment Data (Loading...)",o.style.cssText="\n    margin: 0;\n    font-size: 18px;\n    font-weight: 600;\n    color: #007bff;\n  ";const i=document.createElement("button");i.textContent="",i.style.cssText="\n    background: none;\n    border: none;\n    color: #666;\n    font-size: 20px;\n    cursor: pointer;\n    padding: 0;\n    margin-left: 15px;\n    line-height: 1;\n  ",i.title="Close",i.onclick=()=>{Zp()},r.appendChild(o),r.appendChild(i);const a=document.createElement("div");a.id="experiment-content-container",a.style.cssText="\n    max-height: 70vh;\n    overflow: auto;\n  ",e.appendChild(r),e.appendChild(a),document.body.appendChild(e),ef(t)};n()},nf=new Map,rf=async e=>{const t=nf.get(e.dbName);if(t)return t;try{const t=await ql({dbName:e.dbName,dbVersion:e.dbVersion},t=>{t.objectStoreNames.contains(e.storeName)||t.createObjectStore(e.storeName,{keyPath:e.keyPath})});return nf.set(e.dbName,t),t}catch(e){return void P.error("Failed to open IndexedDB",{error:e})}},of=async(e,t)=>{try{const n=await rf(t);n&&await n.update(t.storeName,e)}catch(e){P.error("Failed to write to IndexedDB cache",{error:e})}},af=async(e,t)=>{try{const n=await rf(t);if(n){return await n.get(t.storeName,e)||null}return null}catch(e){P.error("Failed to read from IndexedDB cache",{error:e})}return null},sf=async(e,t,n)=>{if("undefined"!=typeof indexedDB&&null!==indexedDB)try{const r={id:n,...{...e,cachedAt:Date.now()}};await of(r,t)}catch(e){P.error("Failed to write to IndexedDB cache",{error:e})}},cf=async e=>{const t={holdoutGroups:[]};try{const n=await af(e,k),r=(new Date).getTime(),o=n?r-n.lastUpdatedTimeStamp:1/0;if(!n||o>36e5){const n=await(async()=>{try{const e=await fetch("https://www.nike.com/static/experience/experimentation-eng/universal-holdout/config-web.json");return await e.json()}catch(e){P.error("[Holdout] Error fetching holdout config",e)}})();return n?(await of({id:e,lastUpdatedTimeStamp:r,configValue:n},k),n):t}return n?.configValue||t}catch(e){return P.error("[Holdout] Error getting holdout rules",e),t}};var lf,df;!function(e){e[e.DOTCOM=1]="DOTCOM"}(lf||(lf={})),function(e){e[e.WEB=1]="WEB"}(df||(df={}));let uf=null;const pf=(()=>{let e=null;return(t,n)=>(uf!==t&&(uf=t,e=null),e||(e=new Promise(e=>{try{cf(t).then(r=>{if(r.holdoutGroups.length){const o=jl(t),i=r.holdoutGroups.reduce((e,t)=>{if(e.isHoldout)return e;const n=t.holdoutGroupID;return t.segments.reduce((e,t)=>e.isHoldout?e:t.floor<=o&&o<=t.ceiling?{holdoutGroupID:n,isHoldout:t.holdout,segmentID:t.segmentID}:e,e)},{holdoutGroupID:null,isHoldout:!1,segmentID:null});return(async(e,t,n,r)=>{const o="1"===localStorage?.getItem("dcac:debug")?.split("|")[0]||!1,i=await Vp({debug:o}),a=n??{holdoutGroupID:null,segmentID:null,isHoldout:!1};setTimeout(async()=>{if(window?.webShellClient){const t=await ed(r);if(await id(t,r)){window.webShellClient.analytics&&await window.webShellClient.analytics.isInitialized();try{const t={timestamp:zu.fromDate(new Date(Date.now()+100)),deviceId:e,app:lf.DOTCOM,platform:df.WEB,action:{underlyingAction:{case:"universalHoldout",value:{groupId:a.holdoutGroupID??void 0,segmentId:a.segmentID??void 0,isHoldout:a.isHoldout}}}};await Gp(()=>i.v1.trackEvent({event:{case:"eventV1",value:t}}))}catch(e){P?.error("[Universal Holdout] Analytics events sending error",{error:e})}}}},100),P?.debug(`[UH] ${C}`,{UNIVERSAL_HOLDOUT_EVENT_NAME:C,bucket:t,deviceId:e,groupId:a.holdoutGroupID??"0",segmentId:a.segmentID??"0",disposition:a.isHoldout})})(t,o,i,n),e(i.isHoldout)}return e(!1)}).catch(n=>(P?.error(`Error in deviceHoldoutCheck function. DeviceID: ${t}`,n),e(!1)))}catch(n){return P?.error(`Error in deviceHoldoutCheck function. DeviceID: ${t}`,n),e(!1)}}),e))})(),ff=async(e,t)=>{const n=await(async e=>{const t=await cf(e),n=[];for(const e of t.holdoutGroups)if(e.exemptLocations)for(const t of Object.values(e.exemptLocations))n.push(...t);return n})(e);return n.some(e=>{try{if(!(e=>{if(e.length>500)return!1;const t=[/(\w+\+)+/,/(\w+\*)+/,/(\w+\{[0-9,]+\})+/,/(\(.*\+.*\))+\+/,/(\(.*\*.*\))+\*/,/(.*\+){2,}/,/(.*\*){2,}/,/\([^)]*\+[^)]*\)\*/,/\([^)]*\*[^)]*\)\+/];for(const n of t)if(n.test(e))return!1;let n=0,r=0;for(const t of e)"("===t?(n++,r=Math.max(r,n)):")"===t&&n--;return!(r>3)})(e))return!1;const n=String(e).substring(0,500);return new RegExp(`^${n}`).test(t)}catch{return!1}})},gf=async(e,t,n)=>{try{if(F())return!1;if(!await pf(e,n))return!1;if(n?.user?.isSwooshUser||await(async()=>{if(window?.webShellClient?.identity)return window.webShellClient.identity.getIsSwooshUser();return!1})())return!1;return!await ff(e,t)}catch(r){return P?.error("Error in isHoldout function:",{error:r,deviceId:e,locationName:t,contextData:n}),!1}};const mf="identMapSent",hf=99.99,yf=async(e,t,n,r)=>{try{const o=_("sendident");if("8ffe3efacb76e"===o)P.debug("Identity stitch event enabled via URL bypass parameter");else{const e=t?.user?.fpid;if(!e)return void P.debug("No fpid available for bucketing, skipping identity stitch event");const n=jl(e,"identity-stitch");if(n>hf)return void P.debug(`User bucket ${n} exceeds threshold 99.99, skipping identity stitch event`);P.debug(`User bucket ${n} is within eligible range (0-99.99)`)}if(!t?.user?.upmId)return void P.debug("User not logged in, skipping identity stitch event");if(!e)return void P.debug("Alloy not available, skipping identity stitch event");if(!r)return void P.debug("Datastream ID not available (country not mapped), skipping identity stitch event");if(!(()=>{try{return"undefined"!=typeof sessionStorage&&(sessionStorage.length,sessionStorage.getItem("__nike_optimization_storage_test__"),!0)}catch{return!1}})())return void P.debug("sessionStorage not accessible, skipping identity stitch event");if("true"===sessionStorage.getItem(mf))return void P.debug("Identity stitch event already sent this session");const i=await n.result();if(!i||"string"!=typeof i||""===i.trim())return void P.debug("ECID not available, skipping identity stitch event");const a=((e,t,n)=>({xdm:{eventType:"stitchEvent",identityMap:{ECID:[{id:e,authenticatedState:I,primary:!1}],UPMID:[{id:t,authenticatedState:E,primary:!0}]}},edgeConfigOverrides:{datastreamId:n}}))(i,t.user.upmId,r);await e("sendEvent",a);try{sessionStorage.setItem(mf,"true"),P.debug("Identity stitch event sent successfully")}catch(e){P.debug("Identity stitch event sent, but failed to set sessionStorage flag",e)}}catch(e){P.error("Failed to send identity stitch event",e)}},vf=(e,t,n)=>{const r=(e=>{if(!e)return null;for(const[t,n]of Object.entries(A))if(n.includes(e))return"npe"===q()?N[`${t}_NPE`]:N[t];return null})(t.user?.registeredCountry);return new Wp(async()=>{await yf(e,t,n,r)})};class wf extends Yl{constructor(e,t){super(e),this._overrideDatastreamId=null,this._overrideApptype="dotcom",this._analyticsWrapper=null,this._context=null,this._inflightCache=new Map,this._identityStitchQueue=null,this.overrideDatastreamIdByParam=()=>{const e=L().datastreamId;e&&(this._overrideDatastreamId=e||null,P.debug("Datastream ID overridden via debug config",{datastreamId:e}))},this.setConfig=e=>{void 0!==e.datastreamId&&(this._overrideDatastreamId=e.datastreamId),void 0!==e.apptype&&(this._overrideApptype=e.apptype)},this.getOverrideDatastreamId=()=>this._overrideDatastreamId,this.getOverrideApptype=()=>this._overrideApptype,this.getLocations=async(e,t=!1,n,r)=>{const o=performance.now(),i=e?.locations||[];if(!(e=>{let t=!1;return e.filter(e=>""!==e.name).length>0?t=!0:P.warn("Location must be provided to fetch activity details via Adobe Web SDK(AlloyJS)"),t})(i)){const e=performance.now()-o,t="early-return-invalid-locations";return P.info("OC_PERF_GET_LOCATIONS_PERFORMANCE",{duration:parseFloat(e.toFixed(2)),loadType:t}),{locations:[],error:"No Target activity location provided."}}let a,s;t&&(r=!1,P.debug("Deferred analytics is enabled. Bypassing cache.")),i.length>1&&(r=!1,P.debug("Caching supported for single location only. Bypassing cache."));const c=new Promise(e=>{s=e});if(r){const e=n?.locale||this._context?.locale||Jl();a=((e,t,n)=>{const r=Yp([e],t,n);return btoa(JSON.stringify({locationName:e.name,locationParameters:r}))})(i[0],e.country,e.language);const r=sessionStorage.getItem(a);if(r){this._fetchLocations(i,t,n,a,s);const e=performance.now()-o,c="cache";return P.info("OC_PERF_GET_LOCATIONS_PERFORMANCE",{duration:parseFloat(e.toFixed(2)),loadType:c}),JSON.parse(r)}if(this._inflightCache.has(a)){const e=this._inflightCache.get(a);try{const t=await e,n=performance.now()-o,r="inflight-cache";return P.info("OC_PERF_GET_LOCATIONS_PERFORMANCE",{duration:parseFloat(n.toFixed(2)),loadType:r}),t}catch(e){const t=performance.now()-o,n="inflight-cache-error";throw P.info("OC_PERF_GET_LOCATIONS_PERFORMANCE",{duration:parseFloat(t.toFixed(2)),loadType:n,errorMessage:e instanceof Error?e.message:String(e)}),e}}else this._inflightCache.set(a,c)}const l=await this._fetchLocations(i,t,n,a,s),d=performance.now()-o;return P.info("OC_PERF_GET_LOCATIONS_PERFORMANCE",{duration:parseFloat(d.toFixed(2)),loadType:"fetch"}),l},this.getECIDSyncQueue=new Wp(async()=>{try{if("function"==typeof this._alloy){const e=await this._alloy("getIdentity");if(e&&e?.identity?.ECID)return e.identity.ECID}else{if(!window.alloy||"function"!=typeof window.alloy)return P.warn("Alloy is not initialized, cannot fetch ECID"),null;{const e=await window.alloy("getIdentity");if(e&&e?.identity?.ECID)return e.identity.ECID}}}catch(e){return P.error("Failed to fetch ecid using Alloy getIdentity method",{error:"object"==typeof e&&null!==e?e:{message:String(e)},locations:null}),null}return null}),this._analyticsWrapper=t??new Xp,P.info("optimization client initialized")}async _fetchLocations(e,t,n,r,o){if(this._alloy||await sd(e||[],n||null),this._context?.status||(this._context=await Wl(n)),!0===this._context?.status){const i=await async function(e,t){if(F())return e;let n=[];const r=t?.user?.fpid||Gl("ni_d");if(r){const o=e.map(e=>e.name?gf(r,e.name,t):Promise.resolve(!1)),i=await Promise.all(o);n=e.filter((e,t)=>!i[t])}return n}(e,this._context);if(0===i.length){P.debug("User is part of holdout group.");const e={locations:[],error:"User is part of holdout group."};return r&&this._inflightCache.set(r,Promise.resolve(e)),e}try{const[e,a]=await Promise.all([ad(i,this._context),this.getECIDSyncQueue.result()]);if(!e){const e={locations:[],error:"No UGP permissions."};return r&&this._inflightCache.set(r,Promise.resolve(e)),e}if(!this._alloy&&(this._alloy=window.alloy,!this._alloy))return P.debug("Alloy is not loaded"),{locations:[],error:"Alloy is not loaded"};this.overrideDatastreamIdByParam(),this._identityStitchQueue||(this._identityStitchQueue=vf(this._alloy,this._context,this.getECIDSyncQueue)),this._identityStitchQueue.result().catch(()=>{});const{fpid:s,upmId:c}=this._context.user,l=void 0!==c,d=((e,t,n,r,o,i,a)=>{const s=(e=>{const t=[];return e.map(e=>{t.push(e.name)}),t})(e),c=Yp(e,o,i);return{renderDecisions:!0,edgeConfigOverrides:{datastreamId:a},decisionScopes:s,xdm:{eventType:"decisioning.propositionFetch",identityMap:zp(t,n,r)},data:{__adobe:{target:c}}}})(i,a,s,l,this._context.locale.country,this._context.locale.language,this._overrideDatastreamId),u=await this._alloy("sendEvent",d),p=((e,t,n,r,o,i,a,s,c,l,d)=>{const u=[];let p;const f="true"===_("showExperiments");return f&&tf(!0,Kp),n.forEach(n=>{const g={name:n.name};if(!e||0===e.length)return Qp({locationName:n.name,ecid:r}),f&&tf(!0,Kp),void(p=`No Target activity details found for location ${n.name}`);{const m=e.find(e=>n.name===e.scope);if(!m)return Qp({locationName:n.name,ecid:r}),f&&tf(!0,Kp),void(p=`No Target activity details match found for location ${n.name}`);if(Qp({locationName:m.scope,payloadItem:m.items[0],ecid:r}),g.analytics=m.scopeDetails?.characteristics?.analyticsToken||void 0,g.content=m.items[0]?.data?.content||void 0,g.responseTokens={"experience.name":m.items[0]?.meta?m.items[0].meta["experience.name"]:void 0,"activity.name":m.items[0]?.meta?m.items[0].meta["activity.name"]:void 0},g.experimentActivatedCallback=()=>{},g.analytics){const e=async()=>{try{return o&&await(s?.sendAnalyticsEvents(m,c,l,r,o,i,g,d,a)),g.experimentActivatedCallback=()=>{},!0}catch(e){return delete g.experimentActivatedCallback,P.error("Failed to send Analytics",{error:"object"==typeof e&&null!==e?e:{message:String(e)}}),!1}};t?g.experimentActivatedCallback=e:e()}u.push(g),f&&tf(!0,Kp)}}),u&&u.length>0?{locations:u,error:p}:{locations:[],error:p}})(u?.decisions,t,i,a,s,l,n||this._context||{upmId:void 0,loggedIn:!1},this._analyticsWrapper,this._alloy,this._overrideDatastreamId,this._overrideApptype);return p?.locations&&(((e,t,n)=>{n?.forEach(n=>{P.debug("target bucketing",{ecid:e,fpid:t,locationName:n.name,activityName:n.responseTokens?.["activity.name"]??"",experienceName:n.responseTokens?.["experience.name"]??""})})})(a,s,p?.locations),r&&o&&(o(p),sessionStorage.setItem(r,JSON.stringify(p)))),p}catch(e){P.error("Failed to find locations",{error:"object"==typeof e&&null!==e?e:{message:String(e)},locations:i.length?i:null});const t={locations:[],error:e?.message||"Failed to find locations"};return r&&o&&o(t),t}}return P.warn("isInitialized returned false",{location:e}),{locations:[],error:"Failed to generate context data."}}}const bf=new Wp(async()=>{try{const e=await fetch("https://www.nike.com/static/experience/experimentation-eng/odd/bellotti-ODD.json");if(!e.ok)return P.error("Failed to fetch ODD config data",{error:new Error(`HTTP error! status: ${e.status}`)}),null;return await e.json()}catch(e){return P.error("Failed to fetch ODD config data",{error:e}),null}}),Ef=(e,t,n,r,o)=>{if(e?.experiments?.length>0){const i=e.experiments.filter(e=>e.location===t);if(i.length>0){const e=i.reduce((e,t)=>t.priority>e.priority?t:e,i[0]),t=e.variants.filter(e=>n>=e.floor&&n<=e.ceiling);if(t.length>0){const n=t[0];return P.debug("ODD",{experimentName:e.name,variantName:n.name,deviceId:r,source:o}),n}}}return{error:"No experience Matched"}},If=async e=>{let t;if(!(e=>!(!e||"object"!=typeof e||!(e.location&&e.location.trim().length>0)))(e))return{error:"Invalid decisionRequest provided"};const n=await(async()=>{if("undefined"==typeof indexedDB||null===indexedDB)return{experiments:[]};try{const e=await af("oddConfig",T);if(e){const t=e,{id:n,...r}=t,{cachedAt:o,...i}=r;return Date.now()-o>6e4&&Promise.resolve().then(async()=>{bf.reset();const e=await bf.result();e&&sf(e,T,"oddConfig")}),i}return{experiments:[]}}catch(e){return P.error("Failed to read data from IndexedDB",{error:e}),{experiments:[]}}})(),r=Gl("ni_d");if(!r)return{error:"No device ID found"};const o=jl(r,e.location);if(n.experiments.length>0)return t=Ef(n,e.location,o,r,"cache"),t;{const n=await bf.result();if(!n)return{error:"No matching experience found"};t=Ef(n,e.location,o,r,"s3"),Promise.resolve().then(()=>sf(n,T,"oddConfig"))}return t??{error:"No matching experience found"}},Sf=["mkg-opt-client","esi-gridiron-src","esi-opt-client-src","esi-adobe-src"];function Cf(e,t){try{const n=document.getElementById(e);if(!n||"SCRIPT"!==n.tagName)return null;const r=n.src;if(!r)return null;const o=(t||performance.getEntriesByType("resource")).find(e=>{try{const t=new URL(r),n=new URL(e.name);return t.origin===n.origin&&t.pathname===n.pathname}catch{return e.name===r}});if(!o)return null;const i=o.domainLookupEnd-o.domainLookupStart,a=o.connectEnd-o.connectStart,s=o.responseStart-o.requestStart,c=o.responseEnd-o.responseStart,l=0===o.transferSize&&o.decodedBodySize>0;return{scriptId:e,scriptSrc:o.name,duration:o.duration,transferSize:o.transferSize||o.decodedBodySize||0,dnsTime:i,tcpTime:a,ttfb:s,downloadTime:c,cached:l}}catch(e){return null}}((e={})=>{try{const t=e.logger??b({version:"2.16.0",platform:"OPTIMIZATION_CLIENT"});window.webShellClient||(window.webShellClient={}),window.webShellClient.optimization||(window.webShellClient.optimization={}),!window.webShellClient.analytics&&window.analyticsClient&&(window.webShellClient.analytics=window.analyticsClient),window.webShellClient.optimization.logger=t;const n=new Xp,r=e.alloyInstance??window.alloy;e.alloyInstance&&!window.alloy&&(window.alloy=e.alloyInstance);const{getLocations:o,setConfig:i}=new wf(r,n);window.webShellClient.optimization.getLocations=o,window.webShellClient.optimization.configOverrides=i,window.webShellClient.optimization.isHoldout=gf,window.webShellClient.optimization.sendODDExperimentActivatedEvent=(e=>async(t,n)=>{try{const r=await Wl();if(!1===r.status)return{error:r.error??"Unknown error"};const o=r;return await ad([],o)?(await e.sendODDExperimentActivatedEvent(t,n,{deviceId:o.user.fpid??"",anonymousId:Gl("anonymousId")??void 0}),!0):{error:"No UGP permissions."}}catch(e){return P.error("Failed to send ODD experiment activated event",{error:e,host:window.location.host}),{error:e instanceof Error?e.message:String(e)}}})(n),window.webShellClient.optimization.getExperience=If,z({},window.webShellClient.optimization),e.queueSetHandler&&(e.queueSetHandler(o),P.info("Registered with web-shell queue via setHandler"));const a=()=>{!function(e){if("undefined"!=typeof performance&&performance.getEntriesByType)try{const t=performance.getEntriesByType("resource"),n=[];let r=0,o=0;for(const i of Sf){const a=Cf(i,t);a&&(n.push(a),e.info("OC_PERF_SCRIPT_LOAD_TIMING",{scriptName:a.scriptId,scriptSrc:a.scriptSrc,duration:Math.round(a.duration),transferSize:Math.round(a.transferSize),dnsTime:Math.round(a.dnsTime),tcpTime:Math.round(a.tcpTime),ttfb:Math.round(a.ttfb),downloadTime:Math.round(a.downloadTime),cached:a.cached}),r+=a.transferSize,a.cached&&o++)}if(n.length>0){const t=n.reduce((e,t)=>e+t.duration,0),i=Math.round(o/n.length*100);e.info("OC_PERF_EXPERIMENTATION_INIT",{totalDuration:Math.round(t),scriptsLoaded:n.length,totalBytes:Math.round(r),cacheHitRate:i})}}catch(e){}}(t)};"complete"===document.readyState?a():window.addEventListener("load",a,{once:!0}),P.info("Optimization client initialized",{version:"2.16.0",alloySource:e.alloyInstance?"npm":"window"})}catch(e){P.error("Error on Index",{error:"object"==typeof e&&null!==e?e:{message:String(e)}})}})({queueSetHandler:"undefined"!=typeof window?window.webShellClient?.optimization?.setHandler:void 0})})()})();